!function(p){p(document).on("rails_admin.dom_ready",function(t,e){var i,a,n,o,s,r,d,l,c,h,f;if((e=e||p("form")).length)return e.find("[data-color]").each(function(){var i;return p(i=this).ColorPicker({color:p(i).val(),onShow:function(t){return p(t).fadeIn(500),!1},onHide:function(t){return p(t).fadeOut(500),!1},onChange:function(t,e){p(i).val(e),p(i).css("backgroundColor","#"+e)}})}),p.fn.datetimepicker.defaults.icons={time:"fa fa-clock-o",date:"fa fa-calendar",up:"fa fa-chevron-up",down:"fa fa-chevron-down",previous:"fa fa-angle-double-left",next:"fa fa-angle-double-right",today:"fa fa-dot-circle-o",clear:"fa fa-trash",close:"fa fa-times"},e.find("[data-datetimepicker]").each(function(){var t;t=p(this).data("options"),p.extend(t,{locale:RailsAdmin.I18n.locale}),p(this).datetimepicker(t)}),e.find("[data-enumeration]").each(function(){p(this).is("[multiple]")?p(this).filteringMultiselect(p(this).data("options")):p(this).filteringSelect(p(this).data("options"))}),e.find("[data-fileupload]").each(function(){var t;(t=p(this).closest(".controls")).find(".btn-remove-image").on("click",function(){return p(this).siblings("[type=checkbox]").click(),t.find(".toggle").toggle("slow"),p(this).toggleClass("btn-danger btn-info"),!1})}),e.find("[data-fileupload]").change(function(){var t,e,i,a;(e=p("#"+(i=this).id).parent().children(".preview")).length||(e=p("#"+i.id).parent().prepend(p("<img />").addClass("preview").addClass("img-thumbnail")).find("img.preview")).parent().find("img:not(.preview)").hide(),t=p("#"+i.id).val().split(".").pop().toLowerCase(),i.files&&i.files[0]&&-1!==p.inArray(t,["gif","png","jpg","jpeg","bmp"])?((a=new FileReader).onload=function(t){e.attr("src",t.target.result)},a.readAsDataURL(i.files[0]),e.show()):e.hide()}),e.find("[data-multiple-fileupload]").each(function(){p(this).closest(".controls").find(".btn-remove-image").on("click",function(){return p(this).siblings("[type=checkbox]").click(),p(this).parent(".toggle").toggle("slow"),p(this).toggleClass("btn-danger btn-info"),!1}).end().sortable({items:".sortables"})}),e.find("[data-multiple-fileupload]").change(function(){var t,i,e,a,n,o,s,r;for(p("#"+(n=this).id).parent().children(".preview").remove(),r=[],e=0,o=(s=n.files).length;e<o;e++)t=(i=s[e]).name.split(".").pop().toLowerCase(),-1!==p.inArray(t,["gif","png","jpg","jpeg","bmp"])&&(a=p("<img />").addClass("preview").addClass("img-thumbnail"),r.push(function(e){var t;return(t=new FileReader).onload=function(t){e.attr("src",t.target.result)},t.readAsDataURL(i),p("#"+n.id).parent().append(p("<div></div>").addClass("preview").append(e))}(a)));return r}),e.find("[data-filteringmultiselect]").each(function(){p(this).filteringMultiselect(p(this).data("options")),p(this).parents("#modal").length?p(this).siblings(".btn").remove():p(this).parents(".control-group").first().remoteForm()}),e.find("[data-filteringselect]").each(function(){p(this).filteringSelect(p(this).data("options")),p(this).parents("#modal").length?p(this).siblings(".btn").remove():p(this).parents(".control-group").first().remoteForm()}),e.find("[data-nestedmany]").each(function(){var t,e,i,a;t=p(this).parents(".control-group").first(),e=t.find("> .controls > .nav"),i=t.find("> .tab-content"),a=t.find("> .controls > .btn-group > .toggler"),i.children(".fields:not(.tab-pane)").addClass("tab-pane").each(function(){p(this).attr("id","unique-id-"+(new Date).getTime()+Math.floor(1e5*Math.random())),e.append(p("<li></li>").append(p("<a></a>").attr("data-toggle","tab").attr("href","#"+this.id).text(p(this).children(".object-infos").data("object-label"))))}),0===e.find("> li.active").length&&e.find("> li > a[data-toggle='tab']:first").tab("show"),0===e.children().length?(e.hide(),i.hide(),a.addClass("disabled").removeClass("active").children("i").addClass("icon-chevron-right")):a.hasClass("active")?(e.show(),i.show(),a.children("i").addClass("icon-chevron-down")):(e.hide(),i.hide(),a.children("i").addClass("icon-chevron-right"))}),e.find("[data-nestedone]").each(function(){var t,e,i,a,n;t=p(this).parents(".control-group").first(),i=t.find("> .controls > .nav"),a=t.find("> .tab-content"),n=t.find("> .controls > .btn-group > .toggler"),a.children(".fields:not(.tab-pane)").addClass("tab-pane active").each(function(){t.find("> .controls .add_nested_fields").removeClass("add_nested_fields").text(p(this).children(".object-infos").data("object-label")),i.append(p("<li></li>").append(p("<a></a>").attr("data-toggle","tab").attr("href","#"+this.id).text(p(this).children(".object-infos").data("object-label"))))}),(e=i.find("> li > a[data-toggle='tab']:first")).tab("show"),t.find("> .controls > [data-target]:first").html('<i class="icon-white"></i> '+e.html()),i.hide(),0===i.children().length?(i.hide(),a.hide(),n.addClass("disabled").removeClass("active").children("i").addClass("icon-chevron-right")):n.hasClass("active")?(n.children("i").addClass("icon-chevron-down"),a.show()):(n.children("i").addClass("icon-chevron-right"),a.hide())}),e.find("[data-polymorphic]").each(function(){var t,i,a;t=(a=p(this)).parents(".control-group").first(),i=t.find("select").last(),a.data("urls"),a.on("change",function(){var t,e;e=a.val().toLowerCase(),t=p("#"+e+"-js-options").data("options"),i.data("options",t),i.filteringSelect("destroy"),i.filteringSelect(t)})}),l=function(){return e.find("[data-richtext=simplemde]").not(".simplemded").each(function(){var t;t=p(this).data("options").instance_config,new window.SimpleMDE(p.extend(!0,{element:document.getElementById(this.id),autosave:{uniqueId:this.id}},t)),p(this).addClass("simplemded")})},(i=e.find("[data-richtext=simplemde]").not(".simplemded")).length&&(window.SimpleMDE?l():(c=i.first().data("options"),p("head").append('<link href="'+c.css_location+'" rel="stylesheet" media="all" type="text/css">'),p.getScript(c.js_location,function(){return l()}))),s=function(){return e.find("[data-richtext=ckeditor]").not(".ckeditored").each(function(){var t;try{(t=window.CKEDITOR.instances[this.id])&&t.destroy(!0)}catch(e){}window.CKEDITOR.replace(this,p(this).data("options").options),p(this).addClass("ckeditored")})},(i=e.find("[data-richtext=ckeditor]").not(".ckeditored")).length&&(window.CKEDITOR?s():(c=i.first().data("options"),window.CKEDITOR_BASEPATH=c.base_location,p.getScript(c.jspath,function(){return s()}))),r=function(t){return t.each(function(t,e){var i;c=p(this).data("options"),i=this,p.getScript(c.locations.mode,function(){return c=p(e).data("options"),p("head").append('<link href="'+c.locations.theme+'" rel="stylesheet" media="all" type="text/css">'),CodeMirror.fromTextArea(i,c.options),p(i).addClass("codemirrored")})})},(a=e.find("[data-richtext=codemirror]").not(".codemirrored")).length&&(this.array=a,window.CodeMirror?r(this.array):(c=p(a[0]).data("options"),p("head").append('<link href="'+c.csspath+'" rel="stylesheet" media="all" type="text/css">'),p.getScript(c.jspath,(f=this,function(){return r(f.array)})))),o=function(t,e){return t.each(function(){p(this).addClass("bootstrap-wysihtml5ed"),p(this).closest(".controls").addClass("well"),p(this).wysihtml5(e)})},(a=e.find("[data-richtext=bootstrap-wysihtml5]").not(".bootstrap-wysihtml5ed")).length&&(this.array=a,c=p(a[0]).data("options"),n=p.parseJSON(c.config_options),window.wysihtml5?o(this.array,n):(p("head").append('<link href="'+c.csspath+'" rel="stylesheet" media="all" type="text/css">'),p.getScript(c.jspath,(h=this,function(){return o(h.array,n)})))),d=function(t){return t.each(function(){var t;c=p(this).data("options"),(n=p.parseJSON(c.config_options))?n.inlineMode||(n.inlineMode=!1):n={inlineMode:!1},t=n.imageUploadURL?n.imageUploadParams={authenticity_token:p("meta[name=csrf-token]").attr("content")}:void 0,p(this).addClass("froala-wysiwyged"),p(this).froalaEditor(n),t&&p(this).on("froalaEditor.image.error",function(t,e,i){alert("error uploading image: "+i.message)}).on("froalaEditor.image.removed",function(t,e,i){e.options.imageDeleteParams={src:i.attr("src"),authenticity_token:p("meta[name=csrf-token]").attr("content")},e.deleteImage(i)}).on("editable.imageDeleteSuccess",function(){}).on("editable.imageDeleteError",function(t,e,i){alert("error deleting image: "+i.message)})})},(a=e.find("[data-richtext=froala-wysiwyg]").not(".froala-wysiwyged")).length&&(c=p(a[0]).data("options"),p.isFunction(p.fn.editable)?d(a):(p("head").append('<link href="'+c.csspath+'" rel="stylesheet" media="all" type="text/css">'),p.getScript(c.jspath,function(){return d(a)}))),e.find("trix-editor").each(function(){if(!window.Trix)return c=p(this).data("options"),p("head").append('<link href="'+c.csspath+'" rel="stylesheet" media="all" type="text/css">'),p.getScript(c.jspath)})})}(jQuery);