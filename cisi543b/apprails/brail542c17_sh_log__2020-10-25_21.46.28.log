

Press ctrl-c now if you want to stop and edit settings in /tmp/_brvar1202_albe.txt

Sun Oct 25 21:46:28 EDT 2020
Press ENTER or wait 20 seconds...
Sun Oct 25 21:46:48 EDT 2020

### ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

# for mac osx install gnu-sed,  brew install gnu-sed
# alias gsed to sed..
# http://apple.stackexchange.com/questions/236177/using-alias-in-bash-script-in-osx

if [[ "$OSTYPE" == "linux-gnu" ]]; then
        echo linux
elif [[ "$OSTYPE" == "darwin"* ]]; then
        echo OSX
elif [[ "$OSTYPE" == "cygwin" ]]; then
        # POSIX compatibility layer and Linux environment emulation for Windows
        echo cygwin
elif [[ "$OSTYPE" == "msys" ]]; then
        # Lightweight shell and GNU utilities compiled for Windows (part of MinGW)
        echo msys
elif [[ "$OSTYPE" == "win32" ]]; then
        # I'm not sure this can happen.
        echo win
elif [[ "$OSTYPE" == "freebsd"* ]]; then
        echo freebsd
fi
+ [[ linux-gnu == \l\i\n\u\x\-\g\n\u ]]
+ echo linux
linux

# for OSX....

if [[ "$OSTYPE" == "darwin"* ]]; then
  echo Mac OSX
  alias sed=gsed
  shopt -s expand_aliases
fi
+ [[ linux-gnu == \d\a\r\w\i\n* ]]


### ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

# thor error in version 0.19.2

# See error listed in gemfile1.sh
# gem uninstall thor -v 0.19.2
# gem install thor -v 0.19.1



### start.... ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

pwd
+ pwd
/srv/test/brails-01
  source $sfil/new1.sh
+ source bashrail/new1.sh
#!/usr/bin/env bash
echo ~----------~----------Startingd $HOSTNAME, pwd: `pwd`, dlr0: "$0", bashsource0: "${BASH_SOURCE[0]}", $(date +"%Y-%m-%d_%H.%M.%S")
pwd
+++ pwd
date +"%Y-%m-%d_%H.%M.%S"
+++ date +%Y-%m-%d_%H.%M.%S
++ echo '~----------~----------Startingd' vamp398, pwd: /srv/test/brails-01, dlr0: bashrail/1mk.sh, bashsource0: bashrail/new1.sh, 2020-10-25_21.46.48
~----------~----------Startingd vamp398, pwd: /srv/test/brails-01, dlr0: bashrail/1mk.sh, bashsource0: bashrail/new1.sh, 2020-10-25_21.46.48



# new rails app  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
pwd
++ pwd
/srv/test/brails-01

# change for rails 5
# gem install rails -v 5.2.3 --no-ri --no-rdoc
gem install rails -v 5.2.4.4 --no-document
++ gem install rails -v 5.2.4.4 --no-document
Successfully installed rails-5.2.4.4
1 gem installed

ruby -v ; rails -v 
++ ruby -v
ruby 2.6.5p114 (2019-10-01 revision 67812) [x86_64-linux]
++ rails -v
Rails 5.2.4.4


if [  -d "$appn" ]; then
  # Control will enter here if DIRECTORY  exists.
  set +vx
  echo 'Error 8!  - app name folder already exists.'
  #seco=110 ; read -t $seco -p "Hit ENTER or wait $seco seconds"
  exit 8
fi
++ '[' -d brail542c17 ']'


# change for rails 5
# rails _4.2.7.1_ new $appn --skip-bundle
rails  _5.2.4.4_  new $appn --skip-bundle --no-document
++ rails _5.2.4.4_ new brail542c17 --skip-bundle --no-document
      create  
      create  README.md
      create  Rakefile
      create  .ruby-version
      create  config.ru
      create  .gitignore
      create  Gemfile
         run  git init from "."
Initialized empty Git repository in /srv/test/brails-01/brail542c17/.git/
      create  package.json
      create  app
      create  app/assets/config/manifest.js
      create  app/assets/javascripts/application.js
      create  app/assets/javascripts/cable.js
      create  app/assets/stylesheets/application.css
      create  app/channels/application_cable/channel.rb
      create  app/channels/application_cable/connection.rb
      create  app/controllers/application_controller.rb
      create  app/helpers/application_helper.rb
      create  app/jobs/application_job.rb
      create  app/mailers/application_mailer.rb
      create  app/models/application_record.rb
      create  app/views/layouts/application.html.erb
      create  app/views/layouts/mailer.html.erb
      create  app/views/layouts/mailer.text.erb
      create  app/assets/images/.keep
      create  app/assets/javascripts/channels
      create  app/assets/javascripts/channels/.keep
      create  app/controllers/concerns/.keep
      create  app/models/concerns/.keep
      create  bin
      create  bin/bundle
      create  bin/rails
      create  bin/rake
      create  bin/setup
      create  bin/update
      create  bin/yarn
      create  config
      create  config/routes.rb
      create  config/application.rb
      create  config/environment.rb
      create  config/cable.yml
      create  config/puma.rb
      create  config/spring.rb
      create  config/storage.yml
      create  config/environments
      create  config/environments/development.rb
      create  config/environments/production.rb
      create  config/environments/test.rb
      create  config/initializers
      create  config/initializers/application_controller_renderer.rb
      create  config/initializers/assets.rb
      create  config/initializers/backtrace_silencers.rb
      create  config/initializers/content_security_policy.rb
      create  config/initializers/cookies_serializer.rb
      create  config/initializers/cors.rb
      create  config/initializers/filter_parameter_logging.rb
      create  config/initializers/inflections.rb
      create  config/initializers/mime_types.rb
      create  config/initializers/new_framework_defaults_5_2.rb
      create  config/initializers/wrap_parameters.rb
      create  config/locales
      create  config/locales/en.yml
      create  config/master.key
      append  .gitignore
      create  config/boot.rb
      create  config/database.yml
      create  db
      create  db/seeds.rb
      create  lib
      create  lib/tasks
      create  lib/tasks/.keep
      create  lib/assets
      create  lib/assets/.keep
      create  log
      create  log/.keep
      create  public
      create  public/404.html
      create  public/422.html
      create  public/500.html
      create  public/apple-touch-icon-precomposed.png
      create  public/apple-touch-icon.png
      create  public/favicon.ico
      create  public/robots.txt
      create  tmp
      create  tmp/.keep
      create  tmp/pids
      create  tmp/pids/.keep
      create  tmp/cache
      create  tmp/cache/assets
      create  vendor
      create  vendor/.keep
      create  test/fixtures
      create  test/fixtures/.keep
      create  test/fixtures/files
      create  test/fixtures/files/.keep
      create  test/controllers
      create  test/controllers/.keep
      create  test/mailers
      create  test/mailers/.keep
      create  test/models
      create  test/models/.keep
      create  test/helpers
      create  test/helpers/.keep
      create  test/integration
      create  test/integration/.keep
      create  test/test_helper.rb
      create  test/system
      create  test/system/.keep
      create  test/application_system_test_case.rb
      create  storage
      create  storage/.keep
      create  tmp/storage
      create  tmp/storage/.keep
      remove  config/initializers/cors.rb
      remove  config/initializers/new_framework_defaults_5_2.rb


if [ ! -d "$appn" ]; then
  # Control will enter here if DIRECTORY doesn't exist.
  set +vx
  echo 'Error 9!  - app not created. folder doesn`t exist after attempting to create it.'
  #seco=110 ; read -t $seco -p "Hit ENTER or wait $seco seconds"
  exit 9
fi
++ '[' '!' -d brail542c17 ']'

cd $appn ; pwd
++ cd brail542c17
++ pwd
/srv/test/brails-01/brail542c17





rm -rf .git
++ rm -rf .git
git init
++ git init
Initialized empty Git repository in /srv/test/brails-01/brail542c17/.git/

echo '/config/puma.rb' >> .gitignore
++ echo /config/puma.rb
echo '/config/ldap.yml' >> .gitignore
++ echo /config/ldap.yml
echo '/config/database.yml' >> .gitignore
++ echo /config/database.yml
echo '/config/secrets.yml' >> .gitignore
++ echo /config/secrets.yml

git add -A # Add all files and commit them
++ git add -A
  git commit -m "New, Before any changes. Created using github.com/dgleba/bashrail."
++ git commit -m 'New, Before any changes. Created using github.com/dgleba/bashrail.'
[master (root-commit) 688bd0c] New, Before any changes. Created using github.com/dgleba/bashrail.
 76 files changed, 960 insertions(+)
 create mode 100644 .gitignore
 create mode 100644 .ruby-version
 create mode 100644 Gemfile
 create mode 100644 README.md
 create mode 100644 Rakefile
 create mode 100644 app/assets/config/manifest.js
 create mode 100644 app/assets/images/.keep
 create mode 100644 app/assets/javascripts/application.js
 create mode 100644 app/assets/javascripts/cable.js
 create mode 100644 app/assets/javascripts/channels/.keep
 create mode 100644 app/assets/stylesheets/application.css
 create mode 100644 app/channels/application_cable/channel.rb
 create mode 100644 app/channels/application_cable/connection.rb
 create mode 100644 app/controllers/application_controller.rb
 create mode 100644 app/controllers/concerns/.keep
 create mode 100644 app/helpers/application_helper.rb
 create mode 100644 app/jobs/application_job.rb
 create mode 100644 app/mailers/application_mailer.rb
 create mode 100644 app/models/application_record.rb
 create mode 100644 app/models/concerns/.keep
 create mode 100644 app/views/layouts/application.html.erb
 create mode 100644 app/views/layouts/mailer.html.erb
 create mode 100644 app/views/layouts/mailer.text.erb
 create mode 100755 bin/bundle
 create mode 100755 bin/rails
 create mode 100755 bin/rake
 create mode 100755 bin/setup
 create mode 100755 bin/update
 create mode 100755 bin/yarn
 create mode 100644 config.ru
 create mode 100644 config/application.rb
 create mode 100644 config/boot.rb
 create mode 100644 config/cable.yml
 create mode 100644 config/credentials.yml.enc
 create mode 100644 config/environment.rb
 create mode 100644 config/environments/development.rb
 create mode 100644 config/environments/production.rb
 create mode 100644 config/environments/test.rb
 create mode 100644 config/initializers/application_controller_renderer.rb
 create mode 100644 config/initializers/assets.rb
 create mode 100644 config/initializers/backtrace_silencers.rb
 create mode 100644 config/initializers/content_security_policy.rb
 create mode 100644 config/initializers/cookies_serializer.rb
 create mode 100644 config/initializers/filter_parameter_logging.rb
 create mode 100644 config/initializers/inflections.rb
 create mode 100644 config/initializers/mime_types.rb
 create mode 100644 config/initializers/wrap_parameters.rb
 create mode 100644 config/locales/en.yml
 create mode 100644 config/routes.rb
 create mode 100644 config/spring.rb
 create mode 100644 config/storage.yml
 create mode 100644 db/seeds.rb
 create mode 100644 lib/assets/.keep
 create mode 100644 lib/tasks/.keep
 create mode 100644 log/.keep
 create mode 100644 package.json
 create mode 100644 public/404.html
 create mode 100644 public/422.html
 create mode 100644 public/500.html
 create mode 100644 public/apple-touch-icon-precomposed.png
 create mode 100644 public/apple-touch-icon.png
 create mode 100644 public/favicon.ico
 create mode 100644 public/robots.txt
 create mode 100644 storage/.keep
 create mode 100644 test/application_system_test_case.rb
 create mode 100644 test/controllers/.keep
 create mode 100644 test/fixtures/.keep
 create mode 100644 test/fixtures/files/.keep
 create mode 100644 test/helpers/.keep
 create mode 100644 test/integration/.keep
 create mode 100644 test/mailers/.keep
 create mode 100644 test/models/.keep
 create mode 100644 test/system/.keep
 create mode 100644 test/test_helper.rb
 create mode 100644 tmp/.keep
 create mode 100644 vendor/.keep


  # everything after this is done from within the project folder $appn

  source $sfil2/gemfile1.sh
+ source ../bashrail/gemfile1.sh
#!/usr/bin/env bash
echo ~----------~----------Startingd $HOSTNAME, pwd: `pwd`, dlr0: "$0", bashsource0: "${BASH_SOURCE[0]}", $(date +"%Y-%m-%d_%H.%M.%S")
pwd
+++ pwd
date +"%Y-%m-%d_%H.%M.%S"
+++ date +%Y-%m-%d_%H.%M.%S
++ echo '~----------~----------Startingd' vamp398, pwd: /srv/test/brails-01/brail542c17, dlr0: bashrail/1mk.sh, bashsource0: ../bashrail/gemfile1.sh, 2020-10-25_21.46.52
~----------~----------Startingd vamp398, pwd: /srv/test/brails-01/brail542c17, dlr0: bashrail/1mk.sh, bashsource0: ../bashrail/gemfile1.sh, 2020-10-25_21.46.52

 
  
### gemfile.. ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
pwd
++ pwd
/srv/test/brails-01/brail542c17


echo "gem 'faker'" >> Gemfile
++ echo 'gem '\''faker'\'''
echo "gem 'populator'" >> Gemfile
++ echo 'gem '\''populator'\'''

# to fix error..
# http://stackoverflow.com/questions/40823566/i-get-this-errors-whenever-i-want-to-generate-a-new-controller
# ggl: rails new ruby thor-0.19.2   validate_default_type An option's default must match its type. (ArgumentError)
# rails _4.2.7.1_ new /2.3.0/lib/ruby/gems/2.3.0/gems/thor-0.19.2/lib/thor/parser/option.rb:130:in `validate_default_type!': An option's default must match its type. (ArgumentError)

echo "gem 'thor'">> Gemfile
++ echo 'gem '\''thor'\'''

echo "# " >> Gemfile
++ echo '# '


# gem uninstall thor -v 0.19.2
# gem install thor -v 0.19.1 
# bundle update thor  
  

#got error with # bundle show railties
# output ...
#   The dependency tzinfo-data (>= 0) will be unused by any of the platforms Bundler is installing for. Bundler is installing for ruby but the dependency is only for x86-mingw32, x86-mswin32, x64-mingw32, java. To add those platforms to the bundle, run `bundle lock --add-platform x86-mingw32 x86-mswin32 x64-mingw32 java`.
#   /home/albe/.rbenv/versions/2.6.5/lib/ruby/gems/2.6.0/gems/railties-5.2.4.4
#
bundle config disable_platform_warnings true
++ bundle config disable_platform_warnings true


bundle update
++ bundle update
Fetching gem metadata from https://rubygems.org/............
Fetching gem metadata from https://rubygems.org/.
Resolving dependencies....
Using rake 13.0.1
Using concurrent-ruby 1.1.7
Using i18n 1.8.5
Using minitest 5.14.2
Using thread_safe 0.3.6
Using tzinfo 1.2.7
Using activesupport 5.2.4.4
Using builder 3.2.4
Using erubi 1.9.0
Using mini_portile2 2.4.0
Using nokogiri 1.10.10
Using rails-dom-testing 2.0.3
Using crass 1.0.6
Using loofah 2.7.0
Using rails-html-sanitizer 1.3.0
Using actionview 5.2.4.4
Using rack 2.2.3
Using rack-test 1.1.0
Using actionpack 5.2.4.4
Using nio4r 2.5.4
Using websocket-extensions 0.1.5
Using websocket-driver 0.7.3
Using actioncable 5.2.4.4
Using globalid 0.4.2
Using activejob 5.2.4.4
Using mini_mime 1.0.2
Using mail 2.7.1
Using actionmailer 5.2.4.4
Using activemodel 5.2.4.4
Using arel 9.0.0
Using activerecord 5.2.4.4
Using mimemagic 0.3.5
Using marcel 0.3.3
Using activestorage 5.2.4.4
Using public_suffix 4.0.6
Using addressable 2.7.0
Using io-like 0.3.1
Using archive-zip 0.12.0
Using bindex 0.8.1
Using msgpack 1.3.3
Using bootsnap 1.4.8
Using bundler 1.17.2
Using byebug 11.1.3
Using regexp_parser 1.8.2
Using xpath 3.2.0
Using capybara 3.33.0
Using childprocess 3.0.0
Using chromedriver-helper 2.1.1
Using coffee-script-source 1.12.2
Using execjs 2.7.0
Using coffee-script 2.4.1
Using method_source 1.0.0
Using thor 1.0.1
Using railties 5.2.4.4
Using coffee-rails 4.2.2
Using faker 2.14.0
Using ffi 1.13.1
Using jbuilder 2.10.1
Using rb-fsevent 0.10.4
Using rb-inotify 0.10.1
Using ruby_dep 1.5.0
Using listen 3.1.5
Using populator 1.0.0
Using puma 3.12.6
Using sprockets 3.7.2
Using sprockets-rails 3.2.2
Using rails 5.2.4.4
Using rubyzip 2.3.0
Using sass-listen 4.0.0
Using sass 3.7.4
Using tilt 2.0.10
Using sass-rails 5.1.0
Using selenium-webdriver 3.142.7
Using spring 2.1.1
Using spring-watcher-listen 2.0.1
Using sqlite3 1.4.2
Using turbolinks-source 5.2.0
Using turbolinks 5.2.1
Using uglifier 4.2.0
Using web-console 3.7.0
Bundle updated!

sleep 1
++ sleep 1
git add -A # Add all files and commit them
++ git add -A
git commit -m "gemfile"
++ git commit -m gemfile
[master 92c137c] gemfile
 2 files changed, 226 insertions(+)
 create mode 100644 Gemfile.lock



  # source $sfil2/tableprefix1.sh  # optional
  source $sfil2/timezone1.sh  # optional
+ source ../bashrail/timezone1.sh
#!/usr/bin/env bash
echo ~----------~----------Startingd $HOSTNAME, pwd: `pwd`, dlr0: "$0", bashsource0: "${BASH_SOURCE[0]}", $(date +"%Y-%m-%d_%H.%M.%S")
pwd
+++ pwd
date +"%Y-%m-%d_%H.%M.%S"
+++ date +%Y-%m-%d_%H.%M.%S
++ echo '~----------~----------Startingd' vamp398, pwd: /srv/test/brails-01/brail542c17, dlr0: bashrail/1mk.sh, bashsource0: ../bashrail/timezone1.sh, 2020-10-25_21.46.55
~----------~----------Startingd vamp398, pwd: /srv/test/brails-01/brail542c17, dlr0: bashrail/1mk.sh, bashsource0: ../bashrail/timezone1.sh, 2020-10-25_21.46.55


###  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 # add table prefix and timezone
 
r1tmp="/tmp/_temprubyrunner_${USER}.rb"
++ r1tmp=/tmp/_temprubyrunner_albe.rb
#   add lines after line matching..
cat << 'HEREDOC' > $r1tmp
  replc = %Q{
    
    config.time_zone = 'Eastern Time (US & Canada)'
    }
  ARGF.each  { |line|  puts line ;  puts replc if line =~ /Rails::Application/ }
HEREDOC
++ cat
filetarg='config/application.rb'
++ filetarg=config/application.rb
ruby $r1tmp $filetarg > $filetarg.tmp && cp $filetarg.tmp $filetarg && rm $filetarg.tmp
++ ruby /tmp/_temprubyrunner_albe.rb config/application.rb
++ cp config/application.rb.tmp config/application.rb
++ rm config/application.rb.tmp



###  git. .. ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

git add -A # Add all files and commit them
++ git add -A
git commit -m "change application.rb timezone"
++ git commit -m 'change application.rb timezone'
[master 590365c] change application.rb timezone
 1 file changed, 4 insertions(+)
  
  

  source $sfil2/home1.sh  #
+ source ../bashrail/home1.sh
#!/usr/bin/env bash
echo ~----------~----------Startingd $HOSTNAME, pwd: `pwd`, dlr0: "$0", bashsource0: "${BASH_SOURCE[0]}", $(date +"%Y-%m-%d_%H.%M.%S")
pwd
+++ pwd
date +"%Y-%m-%d_%H.%M.%S"
+++ date +%Y-%m-%d_%H.%M.%S
++ echo '~----------~----------Startingd' vamp398, pwd: /srv/test/brails-01/brail542c17, dlr0: bashrail/1mk.sh, bashsource0: ../bashrail/home1.sh, 2020-10-25_21.46.55
~----------~----------Startingd vamp398, pwd: /srv/test/brails-01/brail542c17, dlr0: bashrail/1mk.sh, bashsource0: ../bashrail/home1.sh, 2020-10-25_21.46.55



### home page .. ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

rails g controller Home index about
++ rails g controller Home index about
      create  app/controllers/home_controller.rb
       route  get 'home/index'
get 'home/about'
      invoke  erb
      create    app/views/home
      create    app/views/home/index.html.erb
      create    app/views/home/about.html.erb
      invoke  test_unit
      create    test/controllers/home_controller_test.rb
      invoke  helper
      create    app/helpers/home_helper.rb
      invoke    test_unit
      invoke  assets
      invoke    coffee
      create      app/assets/javascripts/home.coffee
      invoke    scss
      create      app/assets/stylesheets/home.scss

#
# add line after match...  sed -i  '/CLIENTSCRIPT="foo"/a CLIENTSCRIPT2="hello"' file
# i think 0, means only do it for the first match..
#
pattern1='application.routes'
++ pattern1=application.routes
line1='  root "home#index"'
++ line1='  root "home#index"'
#line2='  about "home#about"'
sed -i "0,/$pattern1/a \ \n$line1\n\n" config/routes.rb
++ sed -i '0,/application.routes/a \ \n  root "home#index"\n\n' config/routes.rb



cat << 'HEREDOC' >> app/views/home/index.html.erb

<h3> 1.   </h3>
<%= link_to 'Products', products_path, class: "btn btn-primary", :style=>'color:#FFFFFF;' %>
<h3> 2.   </h3>

<%# This is a comment! %>
<%#  <%= link_to 'Rails admin', rails_admin.index_path('') %>

Use /radmin to access the rails admin tool if it is setup.

<h3> 3.   </h3>

<%# this not working.. = link_to(:url =>"http://#{request.host}/pfeatures", :text => 'Pfeatures list') %>
<%# = link_to(:url =>"http://localhost:3001/pfeatures", :text => "pfeatures list") %>

<%= link_to 'Pfeatures', pfeatures_path, class: "btn btn-primary", :style=>'color:#FFFFFF;' %>
<br>
<br>
<%= link_to 'Country of Origin list', country_of_origins_path, class: "btn btn-primary", :style=>'color:#FFFFFF;' %>
<p>This has attachments</p>
<br>
<br>
<%= link_to 'Product_features join table', product_features_path, class: "btn btn-primary", :style=>'color:#FFFFFF;' %>
<br>
<br>

<hr>
<%= Rails.env %>

HEREDOC
++ cat


git add -A # Add all files and commit them
++ git add -A
git commit -m "add home page"
++ git commit -m 'add home page'
[master c0f4a53] add home page
 8 files changed, 68 insertions(+)
 create mode 100644 app/assets/javascripts/home.coffee
 create mode 100644 app/assets/stylesheets/home.scss
 create mode 100644 app/controllers/home_controller.rb
 create mode 100644 app/helpers/home_helper.rb
 create mode 100644 app/views/home/about.html.erb
 create mode 100644 app/views/home/index.html.erb
 create mode 100644 test/controllers/home_controller_test.rb




  source $sfil2/bootstrap1.sh
+ source ../bashrail/bootstrap1.sh
#!/usr/bin/env bash
echo ~----------~----------Startingd $HOSTNAME, pwd: `pwd`, dlr0: "$0", bashsource0: "${BASH_SOURCE[0]}", $(date +"%Y-%m-%d_%H.%M.%S")
pwd
+++ pwd
date +"%Y-%m-%d_%H.%M.%S"
+++ date +%Y-%m-%d_%H.%M.%S
++ echo '~----------~----------Startingd' vamp398, pwd: /srv/test/brails-01/brail542c17, dlr0: bashrail/1mk.sh, bashsource0: ../bashrail/bootstrap1.sh, 2020-10-25_21.46.58
~----------~----------Startingd vamp398, pwd: /srv/test/brails-01/brail542c17, dlr0: bashrail/1mk.sh, bashsource0: ../bashrail/bootstrap1.sh, 2020-10-25_21.46.58





### setup bootstrap assets .. ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
pwd
++ pwd
/srv/test/brails-01/brail542c17

echo "# " >> Gemfile
++ echo '# '
note1='# https://github.com/twbs/bootstrap-sass'
++ note1='# https://github.com/twbs/bootstrap-sass'
echo "# $note1" >> Gemfile
++ echo '# # https://github.com/twbs/bootstrap-sass'
echo "# " >> Gemfile
++ echo '# '

gem1="gem 'simple_form'"
++ gem1='gem '\''simple_form'\'''
echo "$gem1" >> Gemfile
++ echo 'gem '\''simple_form'\'''
gem1="gem 'boostrap-sass'"
++ gem1='gem '\''boostrap-sass'\'''
echo "$gem1" >> Gemfile
++ echo 'gem '\''boostrap-sass'\'''

bundle
++ bundle
Fetching gem metadata from https://rubygems.org/............
Fetching gem metadata from https://rubygems.org/.
Resolving dependencies...
Using rake 13.0.1
Using concurrent-ruby 1.1.7
Using i18n 1.8.5
Using minitest 5.14.2
Using thread_safe 0.3.6
Using tzinfo 1.2.7
Using activesupport 5.2.4.4
Using builder 3.2.4
Using erubi 1.9.0
Using mini_portile2 2.4.0
Using nokogiri 1.10.10
Using rails-dom-testing 2.0.3
Using crass 1.0.6
Using loofah 2.7.0
Using rails-html-sanitizer 1.3.0
Using actionview 5.2.4.4
Using rack 2.2.3
Using rack-test 1.1.0
Using actionpack 5.2.4.4
Using nio4r 2.5.4
Using websocket-extensions 0.1.5
Using websocket-driver 0.7.3
Using actioncable 5.2.4.4
Using globalid 0.4.2
Using activejob 5.2.4.4
Using mini_mime 1.0.2
Using mail 2.7.1
Using actionmailer 5.2.4.4
Using activemodel 5.2.4.4
Using arel 9.0.0
Using activerecord 5.2.4.4
Using mimemagic 0.3.5
Using marcel 0.3.3
Using activestorage 5.2.4.4
Using public_suffix 4.0.6
Using addressable 2.7.0
Using io-like 0.3.1
Using archive-zip 0.12.0
Using execjs 2.7.0
Using autoprefixer-rails 10.0.1.0
Using bindex 0.8.1
Using ffi 1.13.1
Using sassc 2.4.0
Using bootstrap-sass 3.4.1
Using boostrap-sass 0.0.2
Using msgpack 1.3.3
Using bootsnap 1.4.8
Using bundler 1.17.2
Using byebug 11.1.3
Using regexp_parser 1.8.2
Using xpath 3.2.0
Using capybara 3.33.0
Using childprocess 3.0.0
Using chromedriver-helper 2.1.1
Using coffee-script-source 1.12.2
Using coffee-script 2.4.1
Using method_source 1.0.0
Using thor 1.0.1
Using railties 5.2.4.4
Using coffee-rails 4.2.2
Using faker 2.14.0
Using jbuilder 2.10.1
Using rb-fsevent 0.10.4
Using rb-inotify 0.10.1
Using ruby_dep 1.5.0
Using listen 3.1.5
Using populator 1.0.0
Using puma 3.12.6
Using sprockets 3.7.2
Using sprockets-rails 3.2.2
Using rails 5.2.4.4
Using rubyzip 2.3.0
Using sass-listen 4.0.0
Using sass 3.7.4
Using tilt 2.0.10
Using sass-rails 5.1.0
Using selenium-webdriver 3.142.7
Using simple_form 5.0.3
Using spring 2.1.1
Using spring-watcher-listen 2.0.1
Using sqlite3 1.4.2
Using turbolinks-source 5.2.0
Using turbolinks 5.2.1
Using uglifier 4.2.0
Using web-console 3.7.0
Bundle complete! 23 Gemfile dependencies, 85 gems now installed.
Use `bundle info [gemname]` to see where a bundled gem is installed.

# echo "gem 'bootstrap-sass', '~> 3.3.6'" >> Gemfile
 echo "gem 'bootstrap-sass'" >> Gemfile
++ echo 'gem '\''bootstrap-sass'\'''
# already there, no need to repeat.... echo "gem 'sass-rails'" >> Gemfile


#  css

#\\10.4.1.227\rt\srv\share\test\rail304x2\app\assets\stylesheets\application.css
mkdir -p backup
++ mkdir -p backup
file1='application.css'
++ file1=application.css
cp -a app/assets/stylesheets/$file1  backup/$file1$(date +"__%Y.%m.%d_%H.%M.%S").bak.txt
date +"__%Y.%m.%d_%H.%M.%S"
+++ date +__%Y.%m.%d_%H.%M.%S
++ cp -a app/assets/stylesheets/application.css backup/application.css__2020.10.25_21.47.00.bak.txt
mv app/assets/stylesheets/application.css app/assets/stylesheets/application.scss
++ mv app/assets/stylesheets/application.css app/assets/stylesheets/application.scss
file1='application.scss'
++ file1=application.scss
cp -a app/assets/stylesheets/$file1  backup/$file1$(date +"__%Y.%m.%d_%H.%M.%S").bak.txt
date +"__%Y.%m.%d_%H.%M.%S"
+++ date +__%Y.%m.%d_%H.%M.%S
++ cp -a app/assets/stylesheets/application.scss backup/application.scss__2020.10.25_21.47.00.bak.txt

echo  '@import "bootstrap-sprockets";'>> app/assets/stylesheets/application.scss
++ echo '@import "bootstrap-sprockets";'
echo  '@import "bootstrap";'>> app/assets/stylesheets/application.scss
++ echo '@import "bootstrap";'

# js

# already there.. '//= require jquery'
# \\10.4.1.227\rt\srv\share\test\rail304x2\app\assets\javascripts\application.js 
echo '//= require bootstrap-sprockets' >> app/assets/javascripts/application.js 
++ echo '//= require bootstrap-sprockets'




### install 1 .. ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

rails generate simple_form:install --bootstrap
++ rails generate simple_form:install --bootstrap
[Simple Form] Simple Form is not configured in the application and will use the default values. Use `rails generate simple_form:install` to generate the Simple Form configuration.
      create  config/initializers/simple_form.rb
      create  config/initializers/simple_form_bootstrap.rb
       exist  config/locales
      create  config/locales/simple_form.en.yml
      create  lib/templates/erb/scaffold/_form.html.erb
===============================================================================

  Be sure to have a copy of the Bootstrap stylesheet available on your
  application, you can get it on http://getbootstrap.com/.

  For usage examples and documentation, see:

    http://simple-form-bootstrap.plataformatec.com.br/

===============================================================================

bundle install
++ bundle install
Using rake 13.0.1
Using concurrent-ruby 1.1.7
Using i18n 1.8.5
Using minitest 5.14.2
Using thread_safe 0.3.6
Using tzinfo 1.2.7
Using activesupport 5.2.4.4
Using builder 3.2.4
Using erubi 1.9.0
Using mini_portile2 2.4.0
Using nokogiri 1.10.10
Using rails-dom-testing 2.0.3
Using crass 1.0.6
Using loofah 2.7.0
Using rails-html-sanitizer 1.3.0
Using actionview 5.2.4.4
Using rack 2.2.3
Using rack-test 1.1.0
Using actionpack 5.2.4.4
Using nio4r 2.5.4
Using websocket-extensions 0.1.5
Using websocket-driver 0.7.3
Using actioncable 5.2.4.4
Using globalid 0.4.2
Using activejob 5.2.4.4
Using mini_mime 1.0.2
Using mail 2.7.1
Using actionmailer 5.2.4.4
Using activemodel 5.2.4.4
Using arel 9.0.0
Using activerecord 5.2.4.4
Using mimemagic 0.3.5
Using marcel 0.3.3
Using activestorage 5.2.4.4
Using public_suffix 4.0.6
Using addressable 2.7.0
Using io-like 0.3.1
Using archive-zip 0.12.0
Using execjs 2.7.0
Using autoprefixer-rails 10.0.1.0
Using bindex 0.8.1
Using ffi 1.13.1
Using sassc 2.4.0
Using bootstrap-sass 3.4.1
Using boostrap-sass 0.0.2
Using msgpack 1.3.3
Using bootsnap 1.4.8
Using bundler 1.17.2
Using byebug 11.1.3
Using regexp_parser 1.8.2
Using xpath 3.2.0
Using capybara 3.33.0
Using childprocess 3.0.0
Using chromedriver-helper 2.1.1
Using coffee-script-source 1.12.2
Using coffee-script 2.4.1
Using method_source 1.0.0
Using thor 1.0.1
Using railties 5.2.4.4
Using coffee-rails 4.2.2
Using faker 2.14.0
Using jbuilder 2.10.1
Using rb-fsevent 0.10.4
Using rb-inotify 0.10.1
Using ruby_dep 1.5.0
Using listen 3.1.5
Using populator 1.0.0
Using puma 3.12.6
Using sprockets 3.7.2
Using sprockets-rails 3.2.2
Using rails 5.2.4.4
Using rubyzip 2.3.0
Using sass-listen 4.0.0
Using sass 3.7.4
Using tilt 2.0.10
Using sass-rails 5.1.0
Using selenium-webdriver 3.142.7
Using simple_form 5.0.3
Using spring 2.1.1
Using spring-watcher-listen 2.0.1
Using sqlite3 1.4.2
Using turbolinks-source 5.2.0
Using turbolinks 5.2.1
Using uglifier 4.2.0
Using web-console 3.7.0
Bundle complete! 24 Gemfile dependencies, 85 gems now installed.
Use `bundle info [gemname]` to see where a bundled gem is installed.

sleep 1
++ sleep 1
git add -A # Add all files and commit them
++ git add -A
git commit -m "install 1 - bootstrap1.sh"
++ git commit -m 'install 1 - bootstrap1.sh'
[master 7d4c6c2] install 1 - bootstrap1.sh
 10 files changed, 716 insertions(+)
 create mode 100644 app/assets/stylesheets/application.scss
 rename app/assets/stylesheets/application.css => backup/application.css__2020.10.25_21.47.00.bak.txt (100%)
 create mode 100644 backup/application.scss__2020.10.25_21.47.00.bak.txt
 create mode 100644 config/initializers/simple_form.rb
 create mode 100644 config/initializers/simple_form_bootstrap.rb
 create mode 100644 config/locales/simple_form.en.yml
 create mode 100644 lib/templates/erb/scaffold/_form.html.erb





### modify scaffold templates... ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

# Change index to boostrap styling..

# http://stackoverflow.com/questions/32384713/override-rails-scaffold-generator
# http://daniel.fone.net.nz/blog/2014/02/01/customising-scaffold-views-in-ruby-on-rails/

railt1="$(bundle show railties)"
bundle show railties
+++ bundle show railties
++ railt1=/home/albe/.rbenv/versions/2.6.5/lib/ruby/gems/2.6.0/gems/railties-5.2.4.4
echo "${railt1}"
++ echo /home/albe/.rbenv/versions/2.6.5/lib/ruby/gems/2.6.0/gems/railties-5.2.4.4
/home/albe/.rbenv/versions/2.6.5/lib/ruby/gems/2.6.0/gems/railties-5.2.4.4
path1='lib/rails/generators/erb/scaffold/templates'
++ path1=lib/rails/generators/erb/scaffold/templates
echo "${railt1}/${path1}"
++ echo /home/albe/.rbenv/versions/2.6.5/lib/ruby/gems/2.6.0/gems/railties-5.2.4.4/lib/rails/generators/erb/scaffold/templates
/home/albe/.rbenv/versions/2.6.5/lib/ruby/gems/2.6.0/gems/railties-5.2.4.4/lib/rails/generators/erb/scaffold/templates
# ls -la "${railt1}/${path1}"

mkdir -p lib/templates/erb/scaffold/
++ mkdir -p lib/templates/erb/scaffold/
rsync -auv "${sfil2}/lib/templates/erb/scaffold/" lib/templates/erb/scaffold/
++ rsync -auv ../bashrail/lib/templates/erb/scaffold/ lib/templates/erb/scaffold/
sending incremental file list
./
_form.html,bootstrap_form_for-1.erb
_form.html,railsform_for-1.erb
_form.html,railsform_for-2.erb
_form.html,simpleform-1.erb
edit.html.erb
index.html-with-separate-buttons.erb
index.html-with-separate-buttons_nodestroy.erb
index.html.erb
new.html.erb
show.html.erb

sent 12,574 bytes  received 209 bytes  25,566.00 bytes/sec
total size is 13,677  speedup is 1.07
rsync -auv "${railt1}/${path1}/" lib/templates/erb/scaffold/
++ rsync -auv /home/albe/.rbenv/versions/2.6.5/lib/ruby/gems/2.6.0/gems/railties-5.2.4.4/lib/rails/generators/erb/scaffold/templates/ lib/templates/erb/scaffold/
sending incremental file list
./
_form.html.erb.tt
edit.html.erb.tt
index.html.erb.tt
new.html.erb.tt
show.html.erb.tt

sent 3,194 bytes  received 114 bytes  6,616.00 bytes/sec
total size is 2,780  speedup is 0.84

# edit template index...
#
file1='index.html.erb'
++ file1=index.html.erb
path1='lib/templates/erb/scaffold/'
++ path1=lib/templates/erb/scaffold/
cp -a $path1$file1  $path1$file1$(date +"__%Y.%m.%d_%H.%M.%S").bak.txt
date +"__%Y.%m.%d_%H.%M.%S"
+++ date +__%Y.%m.%d_%H.%M.%S
++ cp -a lib/templates/erb/scaffold/index.html.erb lib/templates/erb/scaffold/index.html.erb__2020.10.25_21.47.03.bak.txt
#
#replace foo with bar once per line... #sed -i  -e 's/foo/bar/' filename
pattern1='<table>'
++ pattern1='<table>'
pattern2='<table class="table table-striped">'
++ pattern2='<table class="table table-striped">'
sed -i  -e "s/$pattern1/$pattern2/" $path1$file1
++ sed -i -e 's/<table>/<table class="table table-striped">/' lib/templates/erb/scaffold/index.html.erb




#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

# fix vertical-align on top row of index.  title, search, and pagination are not aligned vertically.

file1='dg_twitterbootstrap.scss'
++ file1=dg_twitterbootstrap.scss
cat << 'HEREDOC' > app/assets/stylesheets/$file1

//# app/assets/stylesheets/dg_twitterbootstrap.scss
//# eg: C:\var\share203\rail_jwtbr\app\assets\stylesheets\dg_twitterbootstrap.scss

// bootstrap components have different heights
// https://scotch.io/bar-talk/different-tricks-on-how-to-make-bootstrap-columns-all-the-same-height
//
// usage: on top row of index page for example.. <row class="row is-table-row" >
//
@media only screen and (min-width : 768px) {
  .is-table-row {
    display: table;
  }
  .is-table-row [class*="col-"] {
    float: none;
    display: table-cell;
    vertical-align: middle;
  }
}

.is-table-row .box {
  background: none;
  position: static;
}
.is-table-row [class*="col-"] {
  background: #fff;
}

HEREDOC
++ cat



#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
function blockcomment211() {
: <<'BLOCKCOMMENT'



BLOCKCOMMENT
}
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~



sleep 1
++ sleep 1
git add -A # Add all files and commit them
++ git add -A
git commit -m "copy and modify scaffold templates - bootstrap1.sh"
++ git commit -m 'copy and modify scaffold templates - bootstrap1.sh'
[master 3bbac64] copy and modify scaffold templates - bootstrap1.sh
 17 files changed, 533 insertions(+)
 create mode 100644 app/assets/stylesheets/dg_twitterbootstrap.scss
 create mode 100644 lib/templates/erb/scaffold/_form.html,bootstrap_form_for-1.erb
 create mode 100644 lib/templates/erb/scaffold/_form.html,railsform_for-1.erb
 create mode 100644 lib/templates/erb/scaffold/_form.html,railsform_for-2.erb
 create mode 100644 lib/templates/erb/scaffold/_form.html,simpleform-1.erb
 create mode 100644 lib/templates/erb/scaffold/_form.html.erb.tt
 create mode 100644 lib/templates/erb/scaffold/edit.html.erb
 create mode 100644 lib/templates/erb/scaffold/edit.html.erb.tt
 create mode 100644 lib/templates/erb/scaffold/index.html-with-separate-buttons.erb
 create mode 100755 lib/templates/erb/scaffold/index.html-with-separate-buttons_nodestroy.erb
 create mode 100755 lib/templates/erb/scaffold/index.html.erb
 create mode 100644 lib/templates/erb/scaffold/index.html.erb.tt
 create mode 100755 lib/templates/erb/scaffold/index.html.erb__2020.10.25_21.47.03.bak.txt
 create mode 100644 lib/templates/erb/scaffold/new.html.erb
 create mode 100644 lib/templates/erb/scaffold/new.html.erb.tt
 create mode 100644 lib/templates/erb/scaffold/show.html.erb
 create mode 100644 lib/templates/erb/scaffold/show.html.erb.tt


  source $sfil2/applayout1.sh  # requires home1.sh
+ source ../bashrail/applayout1.sh
#!/usr/bin/env bash

echo ~----------~----------Startingd $HOSTNAME, pwd: `pwd`, dlr0: "$0", bashsource0: "${BASH_SOURCE[0]}", $(date +"%Y-%m-%d_%H.%M.%S")
pwd
+++ pwd
date +"%Y-%m-%d_%H.%M.%S"
+++ date +%Y-%m-%d_%H.%M.%S
++ echo '~----------~----------Startingd' vamp398, pwd: /srv/test/brails-01/brail542c17, dlr0: bashrail/1mk.sh, bashsource0: ../bashrail/applayout1.sh, 2020-10-25_21.47.04
~----------~----------Startingd vamp398, pwd: /srv/test/brails-01/brail542c17, dlr0: bashrail/1mk.sh, bashsource0: ../bashrail/applayout1.sh, 2020-10-25_21.47.04
  
 
### create new application.html.erb layout with disabled turbolinks .. ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


# comment out line with BBB ..  sed -i  '/![^#]/ s/\(^.*BBB.*$\)/#\ \1/' file
# noworky.. sed -i  '/![^#]/ s/\(^.*turbolinks.*$\)/#\ \1/' Gemfile
sed -i  -e '/turbolinks/ s/^#*/#/'  Gemfile
++ sed -i -e '/turbolinks/ s/^#*/#/' Gemfile


file1='application.js'
++ file1=application.js
cp -a app/assets/javascripts/$file1  backup/$file1$(date +"__%Y.%m.%d_%H.%M.%S").bak.txt
date +"__%Y.%m.%d_%H.%M.%S"
+++ date +__%Y.%m.%d_%H.%M.%S
++ cp -a app/assets/javascripts/application.js backup/application.js__2020.10.25_21.47.04.bak.txt
# delete line containing..
sed -i  '/turbolinks/d' app/assets/javascripts/$file1
++ sed -i /turbolinks/d app/assets/javascripts/application.js
 
 
# originally... 
  # <%= stylesheet_link_tag    'application', media: 'all', 'data-turbolinks-track' => true %>
  # <%= javascript_include_tag 'application', 'data-turbolinks-track' => true %>
 
# now using the heredoc below this stanza...
file2='application.html.erb'
++ file2=application.html.erb
cp -a app/views/layouts/$file2  backup/$file2$(date +"__%Y.%m.%d_%H.%M.%S").bak.txt
date +"__%Y.%m.%d_%H.%M.%S"
+++ date +__%Y.%m.%d_%H.%M.%S
++ cp -a app/views/layouts/application.html.erb backup/application.html.erb__2020.10.25_21.47.04.bak.txt
#remove turbolinks reference from $file2
patrn=", 'data-turbolinks-track' => true"
++ patrn=', '\''data-turbolinks-track'\'' => true'
sed -i  "s/$patrn/ /" app/views/layouts/$file2
++ sed -i 's/, '\''data-turbolinks-track'\'' => true/ /' app/views/layouts/application.html.erb
 
 
 
file2='application.html.erb'
++ file2=application.html.erb
cp -a app/assets/javascripts/$file1  backup/$file1$(date +"__%Y.%m.%d_%H.%M.%S").bak.txt
date +"__%Y.%m.%d_%H.%M.%S"
+++ date +__%Y.%m.%d_%H.%M.%S
++ cp -a app/assets/javascripts/application.js backup/application.js__2020.10.25_21.47.04.bak.txt
#
cat << 'HEREDOC' > app/views/layouts/$file2
<!DOCTYPE html >
<html>
  <head>
    <meta charset="utf-8">
      <meta content="IE=edge" http-equiv="X-UA-Compatible">
        <meta content="width=device-width, initial-scale=1" name="viewport">
          <title><%= Rails.application.class.parent_name %></title>
          <%= stylesheet_link_tag    'application', media: 'all' %>
          <%= javascript_include_tag 'application' %>
          <%= csrf_meta_tags %>
        </meta>
      </meta>
    </meta>
  </head>
  <body class="<%= controller.controller_name %>">
    <nav class="navbar navbar-inverse navbar-static-top" role="navigation">
      <div class="container-fluid">
        <div class="navbar-header">
          <button aria-controls="navbar" aria-expanded="false" class="navbar-toggle collapsed" data-target="#navbar" data-toggle="collapse" type="button">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <%= link_to 'Home', root_path, class: 'navbar-brand' %>
        </div>

        <div class="collapse navbar-collapse" id="navbar">
          <ul class="nav navbar-nav">
            <li>
              <!-- <%#  = link_to 'Products', products_path %> -->
            </li>
          </ul>

          <ul class="nav navbar-nav navbar-right">
            <%# views/devise/menu/_login_items.html.erb %>
            <% if user_signed_in? %>
                <li>
                  <%= link_to "Administer", rails_admin.dashboard_path, :class => "btn btn-secondary " %>
                </li>
               <li>
                  <%= link_to('Logout', destroy_user_session_path, :method => :delete) %>
                </li>
                <li class="dropdown">
                  <a class="dropdown-toggle" data-toggle="dropdown" href="#"><%= current_user.email %>,<%= current_user.name %>
                  <span class="caret"></span></a>
                  <ul class="dropdown-menu">
                    <li><a href="#">This item to be used later</a></li>
                    <li> <%#= link_to 'Users', users_path %> </li>
                    <li> <%= link_to "Edit profile", edit_user_registration_path %> </li>
                    <li><%= link_to('Logout', destroy_user_session_path, :method => :delete) %></li>
                  </ul>
                </li>
            <% else %>
                <li>
                  <%= link_to('Login', new_user_session_path)  %>
                </li>
            <% end %>
          </ul>
        </div>
      </div>
    </nav>

    <div class="container-fluid">
      <% flash.each do |type, msg| %>
        <div class="alert alert-<%= type == 'alert' ? 'danger' : 'success' %> alert-dismissable" role="alert">
          <button class="close"> .. </button>
          <%= msg if msg.is_a?(String) %>
        </div>
      <% end %>
      <%= yield %>
    </div>

  </body>
</html>
HEREDOC
++ cat


  
###  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


# Copy files over..


path1='config/locales/en.yml'
++ path1=config/locales/en.yml
cp -a  $sfil2/$path1 $path1
++ cp -a ../bashrail/config/locales/en.yml config/locales/en.yml



###  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

sleep 1
++ sleep 1
git add -A # Add all files and commit them
++ git add -A
git commit -m "app layout with disabled turbolinks"
++ git commit -m 'app layout with disabled turbolinks'
[master 93e6ac4] app layout with disabled turbolinks
 6 files changed, 127 insertions(+), 50 deletions(-)
 rewrite app/views/layouts/application.html.erb (86%)
 copy app/views/layouts/application.html.erb => backup/application.html.erb__2020.10.25_21.47.04.bak.txt (100%)
 create mode 100644 backup/application.js__2020.10.25_21.47.04.bak.txt
 rewrite config/locales/en.yml (99%)




  source $sfil2/paginate1.sh  # optional, but you may need to edit to overcome some errors since it may include some code that depends on other features.
+ source ../bashrail/paginate1.sh
#!/usr/bin/env bash
echo ~----------~----------Startingd $HOSTNAME, pwd: `pwd`, dlr0: "$0", bashsource0: "${BASH_SOURCE[0]}", $(date +"%Y-%m-%d_%H.%M.%S")
pwd
+++ pwd
date +"%Y-%m-%d_%H.%M.%S"
+++ date +%Y-%m-%d_%H.%M.%S
++ echo '~----------~----------Startingd' vamp398, pwd: /srv/test/brails-01/brail542c17, dlr0: bashrail/1mk.sh, bashsource0: ../bashrail/paginate1.sh, 2020-10-25_21.47.05
~----------~----------Startingd vamp398, pwd: /srv/test/brails-01/brail542c17, dlr0: bashrail/1mk.sh, bashsource0: ../bashrail/paginate1.sh, 2020-10-25_21.47.05


###  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 
 # read settings..
 
read  appn  sfil  sfil2  mpwd  parm0</tmp/"_brvar1202_${USER}".txt
++ read appn sfil sfil2 mpwd parm0
echo $appn $sfil $sfil2 $mpwd $parm0
++ echo brail542c17 bashrail ../bashrail /srv/test/brails-01 bashrail/1mk.sh /home/albe
brail542c17 bashrail ../bashrail /srv/test/brails-01 bashrail/1mk.sh /home/albe
 
 timeout1=5 ; read -t "${timeout1}" -p "Press ENTER or wait $timeout1 seconds..." || true ;  echo ;
++ timeout1=5
++ read -t 5 -p 'Press ENTER or wait 5 seconds...'
Press ENTER or wait 5 seconds...++ true
++ echo



 
###  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


# kaminari pagainate, with ransack search  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
pwd
++ pwd
/srv/test/brails-01/brail542c17

# https://www.anthonycandaele.com/blog/2015/08/04/adding-pagination-to-your-rails-app-with-kaminari

# http://www.softwaremaniacs.net/2014/01/replacing-scaffoldcontroller-generator.html

# example form generator template..
# http://daniel.fone.net.nz/blog/2014/02/01/customising-scaffold-views-in-ruby-on-rails/


echo "gem 'kaminari'" >> Gemfile
++ echo 'gem '\''kaminari'\'''
echo "gem 'ransack'" >> Gemfile
++ echo 'gem '\''ransack'\'''
echo "gem 'bootstrap-kaminari-views'" >> Gemfile
++ echo 'gem '\''bootstrap-kaminari-views'\'''
bundle update
++ bundle update
Fetching gem metadata from https://rubygems.org/............
Fetching gem metadata from https://rubygems.org/.
Resolving dependencies......
Using rake 13.0.1
Using concurrent-ruby 1.1.7
Using i18n 1.8.5
Using minitest 5.14.2
Using thread_safe 0.3.6
Using tzinfo 1.2.7
Using activesupport 5.2.4.4
Using builder 3.2.4
Using erubi 1.9.0
Using mini_portile2 2.4.0
Using nokogiri 1.10.10
Using rails-dom-testing 2.0.3
Using crass 1.0.6
Using loofah 2.7.0
Using rails-html-sanitizer 1.3.0
Using actionview 5.2.4.4
Using rack 2.2.3
Using rack-test 1.1.0
Using actionpack 5.2.4.4
Using nio4r 2.5.4
Using websocket-extensions 0.1.5
Using websocket-driver 0.7.3
Using actioncable 5.2.4.4
Using globalid 0.4.2
Using activejob 5.2.4.4
Using mini_mime 1.0.2
Using mail 2.7.1
Using actionmailer 5.2.4.4
Using activemodel 5.2.4.4
Using arel 9.0.0
Using activerecord 5.2.4.4
Using mimemagic 0.3.5
Using marcel 0.3.3
Using activestorage 5.2.4.4
Using public_suffix 4.0.6
Using addressable 2.7.0
Using io-like 0.3.1
Using archive-zip 0.12.0
Using execjs 2.7.0
Using autoprefixer-rails 10.0.1.0
Using bindex 0.8.1
Using ffi 1.13.1
Using sassc 2.4.0
Using bootstrap-sass 3.4.1
Using boostrap-sass 0.0.2
Using msgpack 1.3.3
Using bootsnap 1.4.8
Using kaminari-core 1.2.1
Using kaminari-actionview 1.2.1
Using kaminari-activerecord 1.2.1
Using kaminari 1.2.1
Using bundler 1.17.2
Using method_source 1.0.0
Using thor 1.0.1
Using railties 5.2.4.4
Using sprockets 3.7.2
Using sprockets-rails 3.2.2
Using rails 5.2.4.4
Using bootstrap-kaminari-views 0.0.5
Using byebug 11.1.3
Using regexp_parser 1.8.2
Using xpath 3.2.0
Using capybara 3.33.0
Using childprocess 3.0.0
Using chromedriver-helper 2.1.1
Using coffee-script-source 1.12.2
Using coffee-script 2.4.1
Using coffee-rails 4.2.2
Using faker 2.14.0
Using jbuilder 2.10.1
Using rb-fsevent 0.10.4
Using rb-inotify 0.10.1
Using ruby_dep 1.5.0
Using listen 3.1.5
Using polyamorous 2.3.2
Using populator 1.0.0
Using puma 3.12.6
Using ransack 2.3.2
Using rubyzip 2.3.0
Using sass-listen 4.0.0
Using sass 3.7.4
Using tilt 2.0.10
Using sass-rails 5.1.0
Using selenium-webdriver 3.142.7
Using simple_form 5.0.3
Using spring 2.1.1
Using spring-watcher-listen 2.0.1
Using sqlite3 1.4.2
Using uglifier 4.2.0
Using web-console 3.7.0
Bundle updated!
bundle
++ bundle
Using rake 13.0.1
Using concurrent-ruby 1.1.7
Using i18n 1.8.5
Using minitest 5.14.2
Using thread_safe 0.3.6
Using tzinfo 1.2.7
Using activesupport 5.2.4.4
Using builder 3.2.4
Using erubi 1.9.0
Using mini_portile2 2.4.0
Using nokogiri 1.10.10
Using rails-dom-testing 2.0.3
Using crass 1.0.6
Using loofah 2.7.0
Using rails-html-sanitizer 1.3.0
Using actionview 5.2.4.4
Using rack 2.2.3
Using rack-test 1.1.0
Using actionpack 5.2.4.4
Using nio4r 2.5.4
Using websocket-extensions 0.1.5
Using websocket-driver 0.7.3
Using actioncable 5.2.4.4
Using globalid 0.4.2
Using activejob 5.2.4.4
Using mini_mime 1.0.2
Using mail 2.7.1
Using actionmailer 5.2.4.4
Using activemodel 5.2.4.4
Using arel 9.0.0
Using activerecord 5.2.4.4
Using mimemagic 0.3.5
Using marcel 0.3.3
Using activestorage 5.2.4.4
Using public_suffix 4.0.6
Using addressable 2.7.0
Using io-like 0.3.1
Using archive-zip 0.12.0
Using execjs 2.7.0
Using autoprefixer-rails 10.0.1.0
Using bindex 0.8.1
Using ffi 1.13.1
Using sassc 2.4.0
Using bootstrap-sass 3.4.1
Using boostrap-sass 0.0.2
Using msgpack 1.3.3
Using bootsnap 1.4.8
Using kaminari-core 1.2.1
Using kaminari-actionview 1.2.1
Using kaminari-activerecord 1.2.1
Using kaminari 1.2.1
Using bundler 1.17.2
Using method_source 1.0.0
Using thor 1.0.1
Using railties 5.2.4.4
Using sprockets 3.7.2
Using sprockets-rails 3.2.2
Using rails 5.2.4.4
Using bootstrap-kaminari-views 0.0.5
Using byebug 11.1.3
Using regexp_parser 1.8.2
Using xpath 3.2.0
Using capybara 3.33.0
Using childprocess 3.0.0
Using chromedriver-helper 2.1.1
Using coffee-script-source 1.12.2
Using coffee-script 2.4.1
Using coffee-rails 4.2.2
Using faker 2.14.0
Using jbuilder 2.10.1
Using rb-fsevent 0.10.4
Using rb-inotify 0.10.1
Using ruby_dep 1.5.0
Using listen 3.1.5
Using polyamorous 2.3.2
Using populator 1.0.0
Using puma 3.12.6
Using ransack 2.3.2
Using rubyzip 2.3.0
Using sass-listen 4.0.0
Using sass 3.7.4
Using tilt 2.0.10
Using sass-rails 5.1.0
Using selenium-webdriver 3.142.7
Using simple_form 5.0.3
Using spring 2.1.1
Using spring-watcher-listen 2.0.1
Using sqlite3 1.4.2
Using uglifier 4.2.0
Using web-console 3.7.0
Bundle complete! 26 Gemfile dependencies, 90 gems now installed.
Use `bundle info [gemname]` to see where a bundled gem is installed.



# I will just Just copy them from bashrail instead. see below...

  railt1="$(bundle show railties)"  # to get original controller generator...
bundle show railties
+++ bundle show railties
++ railt1=/home/albe/.rbenv/versions/2.6.5/lib/ruby/gems/2.6.0/gems/railties-5.2.4.4
  echo "${railt1}"
++ echo /home/albe/.rbenv/versions/2.6.5/lib/ruby/gems/2.6.0/gems/railties-5.2.4.4
/home/albe/.rbenv/versions/2.6.5/lib/ruby/gems/2.6.0/gems/railties-5.2.4.4
  path1='lib/rails/generators/rails/scaffold_controller/templates' # to get original controller generator...
++ path1=lib/rails/generators/rails/scaffold_controller/templates
  echo "${railt1}/${path1}"
++ echo /home/albe/.rbenv/versions/2.6.5/lib/ruby/gems/2.6.0/gems/railties-5.2.4.4/lib/rails/generators/rails/scaffold_controller/templates
/home/albe/.rbenv/versions/2.6.5/lib/ruby/gems/2.6.0/gems/railties-5.2.4.4/lib/rails/generators/rails/scaffold_controller/templates
  ls -la "${railt1}/${path1}"
++ ls -la /home/albe/.rbenv/versions/2.6.5/lib/ruby/gems/2.6.0/gems/railties-5.2.4.4/lib/rails/generators/rails/scaffold_controller/templates
total 16
drwxrwxr-x 2 albe albe 4096 Oct 25 20:56 .
drwxrwxr-x 3 albe albe 4096 Oct 25 20:56 ..
-rw-r--r-- 1 albe albe 1883 Oct 25 20:56 api_controller.rb.tt
-rw-r--r-- 1 albe albe 1979 Oct 25 20:56 controller.rb.tt

  path2='lib/templates/rails/scaffold_controller/orig_default'
++ path2=lib/templates/rails/scaffold_controller/orig_default
  # mkdir -p $path2
  # rsync -auv "${railt1}/${path1}/" $path2
 

# ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

# notes..

# before..
# def index
  # @<%= plural_table_name %> = <%= orm_class.all(class_name) %>
#
# after..
#   from railt251b or c..
# insert_into_file 'lib/templates/rails/scaffold_controller/controller.rb', after: /def index\n/ do
  # <<-'RUBY'
  # i think this should be .. <%= singular_table_name %>
    # @q = @<%= plural_table_name %>.search params[:q]
    # @<%= plural_table_name %> = @q.result.page(params[:page])
  # RUBY
# end
#
# ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


# Copy this controller template over..

path1='lib/templates/rails/scaffold_controller'
++ path1=lib/templates/rails/scaffold_controller
rm -rf $path1/
++ rm -rf lib/templates/rails/scaffold_controller/
mkdir -p $path1
++ mkdir -p lib/templates/rails/scaffold_controller
# rsync.. -a - rltpgoD  preserve almost all. -u update don't copy older source files.
rsync -av  $sfil2/$path1/ $path1/
++ rsync -av ../bashrail/lib/templates/rails/scaffold_controller/ lib/templates/rails/scaffold_controller/
sending incremental file list
./
controller.rb
controller__beforerail263controller.rb
origbak/
origbak/controller.rb

sent 7,662 bytes  received 88 bytes  15,500.00 bytes/sec
total size is 7,317  speedup is 0.94


rails generate 'kaminari:config'
++ rails generate kaminari:config
      create  config/initializers/kaminari_config.rb
rails g kaminari:config
++ rails g kaminari:config
   identical  config/initializers/kaminari_config.rb


# Copy scaffold templates over..

path1='lib/templates/erb/scaffold'
++ path1=lib/templates/erb/scaffold
mkdir -p $path1/
++ mkdir -p lib/templates/erb/scaffold/
rm -r $path1/
++ rm -r lib/templates/erb/scaffold/
# rsync.. -a - rltpgoD  preserve almost all. -u update don't copy older source files.
rsync -av --ignore-times  $sfil2/$path1/ $path1/
++ rsync -av --ignore-times ../bashrail/lib/templates/erb/scaffold/ lib/templates/erb/scaffold/
sending incremental file list
created directory lib/templates/erb/scaffold
./
_form.html,bootstrap_form_for-1.erb
_form.html,railsform_for-1.erb
_form.html,railsform_for-2.erb
_form.html,simpleform-1.erb
_form.html.erb
edit.html.erb
index.html-with-separate-buttons.erb
index.html-with-separate-buttons_nodestroy.erb
index.html.erb
new.html.erb
show.html.erb

sent 14,545 bytes  received 277 bytes  29,644.00 bytes/sec
total size is 13,677  speedup is 0.92


# set per_page..

# Title:  . replace line containing pattern with a whole new line of text...
# remove line containing  'global]'  and replace the line completely with the new text...
# eg: sudo sed -i  's/.*global].*/[global]\n\nunix extensions = no/g' /etc/samba/smb.conf 
file1='config/initializers/kaminari_config.rb'
++ file1=config/initializers/kaminari_config.rb
pattern='config.default_per_page'
++ pattern=config.default_per_page
repl='  config.default_per_page = 5'
++ repl='  config.default_per_page = 5'
sed -i  "s/.*$pattern.*/$repl/g" $file1
++ sed -i 's/.*config.default_per_page.*/  config.default_per_page = 5/g' config/initializers/kaminari_config.rb


###  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


# copy app helpers..

# I don't think this works the same in osx as in linux..
# cp -a $sfil2/app/helpers/ app/
# try this..  http://jondavidjohn.com/linux-vs-osx-the-cp-command/ ...
cp -a $sfil2/app/helpers app/
++ cp -a ../bashrail/app/helpers app/



###  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


# I didn't do this yet...

# config/locales/en.yml
  # views:
    # pagination:
      # previous: "&lt; Previous"
      # next: "Next &gt;"
      # truncate: "..."
      


git add -A # Add all files and commit them
++ git add -A
  git commit -m "Kaminari Ransack"
++ git commit -m 'Kaminari Ransack'
[master dde473a] Kaminari Ransack
 15 files changed, 366 insertions(+), 170 deletions(-)
 create mode 100644 app/helpers/jwt_wrapper.rb
 create mode 100644 config/initializers/kaminari_config.rb
 rewrite lib/templates/erb/scaffold/_form.html.erb (93%)
 delete mode 100644 lib/templates/erb/scaffold/_form.html.erb.tt
 delete mode 100644 lib/templates/erb/scaffold/edit.html.erb.tt
 delete mode 100644 lib/templates/erb/scaffold/index.html.erb.tt
 delete mode 100755 lib/templates/erb/scaffold/index.html.erb__2020.10.25_21.47.03.bak.txt
 delete mode 100644 lib/templates/erb/scaffold/new.html.erb.tt
 delete mode 100644 lib/templates/erb/scaffold/show.html.erb.tt
 create mode 100644 lib/templates/rails/scaffold_controller/controller.rb
 create mode 100644 lib/templates/rails/scaffold_controller/controller__beforerail263controller.rb
 create mode 100644 lib/templates/rails/scaffold_controller/origbak/controller.rb

  


  # use only devisetokenauth1.sh  or devisejwt.sh   NOT both..


  source $sfil2/devise1.sh   # optional, but will modify home page, so.. some edits to overcome missing items may be necessary
+ source ../bashrail/devise1.sh
#!/usr/bin/env bash
echo ~----------~----------Startingd $HOSTNAME, pwd: `pwd`, dlr0: "$0", bashsource0: "${BASH_SOURCE[0]}", $(date +"%Y-%m-%d_%H.%M.%S")
pwd
+++ pwd
date +"%Y-%m-%d_%H.%M.%S"
+++ date +%Y-%m-%d_%H.%M.%S
++ echo '~----------~----------Startingd' vamp398, pwd: /srv/test/brails-01/brail542c17, dlr0: bashrail/1mk.sh, bashsource0: ../bashrail/devise1.sh, 2020-10-25_21.47.16
~----------~----------Startingd vamp398, pwd: /srv/test/brails-01/brail542c17, dlr0: bashrail/1mk.sh, bashsource0: ../bashrail/devise1.sh, 2020-10-25_21.47.16

 
### add devise .. ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 
 
echo 'gem "devise"' >> Gemfile
++ echo 'gem "devise"'

#echo 'gem "devise_ldap_authenticatable", :git => "git://github.com/cschiewek/devise_ldap_authenticatable.git"' >> Gemfile

bundle
++ bundle
Fetching gem metadata from https://rubygems.org/............
Fetching gem metadata from https://rubygems.org/.
Resolving dependencies...
Using rake 13.0.1
Using concurrent-ruby 1.1.7
Using i18n 1.8.5
Using minitest 5.14.2
Using thread_safe 0.3.6
Using tzinfo 1.2.7
Using activesupport 5.2.4.4
Using builder 3.2.4
Using erubi 1.9.0
Using mini_portile2 2.4.0
Using nokogiri 1.10.10
Using rails-dom-testing 2.0.3
Using crass 1.0.6
Using loofah 2.7.0
Using rails-html-sanitizer 1.3.0
Using actionview 5.2.4.4
Using rack 2.2.3
Using rack-test 1.1.0
Using actionpack 5.2.4.4
Using nio4r 2.5.4
Using websocket-extensions 0.1.5
Using websocket-driver 0.7.3
Using actioncable 5.2.4.4
Using globalid 0.4.2
Using activejob 5.2.4.4
Using mini_mime 1.0.2
Using mail 2.7.1
Using actionmailer 5.2.4.4
Using activemodel 5.2.4.4
Using arel 9.0.0
Using activerecord 5.2.4.4
Using mimemagic 0.3.5
Using marcel 0.3.3
Using activestorage 5.2.4.4
Using public_suffix 4.0.6
Using addressable 2.7.0
Using io-like 0.3.1
Using archive-zip 0.12.0
Using execjs 2.7.0
Using autoprefixer-rails 10.0.1.0
Using bcrypt 3.1.16
Using bindex 0.8.1
Using ffi 1.13.1
Using sassc 2.4.0
Using bootstrap-sass 3.4.1
Using boostrap-sass 0.0.2
Using msgpack 1.3.3
Using bootsnap 1.4.8
Using kaminari-core 1.2.1
Using kaminari-actionview 1.2.1
Using kaminari-activerecord 1.2.1
Using kaminari 1.2.1
Using bundler 1.17.2
Using method_source 1.0.0
Using thor 1.0.1
Using railties 5.2.4.4
Using sprockets 3.7.2
Using sprockets-rails 3.2.2
Using rails 5.2.4.4
Using bootstrap-kaminari-views 0.0.5
Using byebug 11.1.3
Using regexp_parser 1.8.2
Using xpath 3.2.0
Using capybara 3.33.0
Using childprocess 3.0.0
Using chromedriver-helper 2.1.1
Using coffee-script-source 1.12.2
Using coffee-script 2.4.1
Using coffee-rails 4.2.2
Using orm_adapter 0.5.0
Using responders 3.0.1
Using warden 1.2.9
Using devise 4.7.3
Using faker 2.14.0
Using jbuilder 2.10.1
Using rb-fsevent 0.10.4
Using rb-inotify 0.10.1
Using ruby_dep 1.5.0
Using listen 3.1.5
Using polyamorous 2.3.2
Using populator 1.0.0
Using puma 3.12.6
Using ransack 2.3.2
Using rubyzip 2.3.0
Using sass-listen 4.0.0
Using sass 3.7.4
Using tilt 2.0.10
Using sass-rails 5.1.0
Using selenium-webdriver 3.142.7
Using simple_form 5.0.3
Using spring 2.1.1
Using spring-watcher-listen 2.0.1
Using sqlite3 1.4.2
Using uglifier 4.2.0
Using web-console 3.7.0
Bundle complete! 27 Gemfile dependencies, 95 gems now installed.
Use `bundle info [gemname]` to see where a bundled gem is installed.

git add -A # Add all files and commit them
++ git add -A
git commit -m "add devise start"
++ git commit -m 'add devise start'
[master 610e52c] add devise start
 2 files changed, 15 insertions(+)

# Create user and roles tables..

# rails g scaffold Role name description active_status:integer sort:integer
# rails g scaffold User name role:belongs_to 
# rake db:migrate

rails generate devise:install
++ rails generate devise:install
      create  config/initializers/devise.rb
      create  config/locales/devise.en.yml
===============================================================================

Depending on your application's configuration some manual setup may be required:

  1. Ensure you have defined default url options in your environments files. Here
     is an example of default_url_options appropriate for a development environment
     in config/environments/development.rb:

       config.action_mailer.default_url_options = { host: 'localhost', port: 3000 }

     In production, :host should be set to the actual host of your application.

     * Required for all applications. *

  2. Ensure you have defined root_url to *something* in your config/routes.rb.
     For example:

       root to: "home#index"
     
     * Not required for API-only Applications *

  3. Ensure you have flash messages in app/views/layouts/application.html.erb.
     For example:

       <p class="notice"><%= notice %></p>
       <p class="alert"><%= alert %></p>

     * Not required for API-only Applications *

  4. You can copy Devise views (for customization) to your app by running:

       rails g devise:views
       
     * Not required *

===============================================================================

git add -A # Add all files and commit them
++ git add -A
git commit -m "add devise 1a"
++ git commit -m 'add devise 1a'
[master a3a9f1d] add devise 1a
 2 files changed, 376 insertions(+)
 create mode 100644 config/initializers/devise.rb
 create mode 100644 config/locales/devise.en.yml
 
rails generate devise user
++ rails generate devise user
      invoke  active_record
      create    db/migrate/20201026014721_devise_create_users.rb
      create    app/models/user.rb
      invoke    test_unit
      create      test/models/user_test.rb
      create      test/fixtures/users.yml
      insert    app/models/user.rb
       route  devise_for :users

git add -A # Add all files and commit them
++ git add -A
git commit -m "add devise 1b"
++ git commit -m 'add devise 1b'
[master b7446ee] add devise 1b
 5 files changed, 69 insertions(+)
 create mode 100644 app/models/user.rb
 create mode 100644 db/migrate/20201026014721_devise_create_users.rb
 create mode 100644 test/fixtures/users.yml
 create mode 100644 test/models/user_test.rb
  
# copy ability and user model..
mkdir -p  backup/app/models
++ mkdir -p backup/app/models
cp -a app/models/ backup/app/
++ cp -a app/models/ backup/app/
cp -a $sfil2/app/models/user.rb app/models/
++ cp -a ../bashrail/app/models/user.rb app/models/

cp -a $sfil2/db/migrate/30170101010101_add_devise2_to_users.rb db/migrate/
++ cp -a ../bashrail/db/migrate/30170101010101_add_devise2_to_users.rb db/migrate/


git add -A # Add all files and commit them
++ git add -A
git commit -m "add devise 1c"
++ git commit -m 'add devise 1c'
[master 23cb66b] add devise 1c
 5 files changed, 96 insertions(+), 4 deletions(-)
 mode change 100644 => 100755 app/models/user.rb
 create mode 100644 backup/app/models/application_record.rb
 create mode 100644 backup/app/models/concerns/.keep
 create mode 100644 backup/app/models/user.rb
 create mode 100755 db/migrate/30170101010101_add_devise2_to_users.rb
  

rake db:migrate
++ rake db:migrate
== 20201026014721 DeviseCreateUsers: migrating ================================
-- create_table(:users)
   -> 0.0008s
-- add_index(:users, :email, {:unique=>true})
   -> 0.0011s
-- add_index(:users, :reset_password_token, {:unique=>true})
   -> 0.0008s
== 20201026014721 DeviseCreateUsers: migrated (0.0029s) =======================

== 30170101010101 AddDevise2ToUsers: migrating ================================
-- change_table(:users, {})
   -> 0.0065s
-- add_index(:users, :confirmation_token, {:unique=>true})
   -> 0.0021s
-- add_index(:users, :unlock_token, {:unique=>true})
   -> 0.0020s
== 30170101010101 AddDevise2ToUsers: migrated (0.0109s) =======================


#rails g devise_ldap_authenticatable:install


rails generate devise:views 
++ rails generate devise:views
      invoke  Devise::Generators::SharedViewsGenerator
      create    app/views/devise/shared
      create    app/views/devise/shared/_error_messages.html.erb
      create    app/views/devise/shared/_links.html.erb
      invoke  simple_form_for
      create    app/views/devise/confirmations
      create    app/views/devise/confirmations/new.html.erb
      create    app/views/devise/passwords
      create    app/views/devise/passwords/edit.html.erb
      create    app/views/devise/passwords/new.html.erb
      create    app/views/devise/registrations
      create    app/views/devise/registrations/edit.html.erb
      create    app/views/devise/registrations/new.html.erb
      create    app/views/devise/sessions
      create    app/views/devise/sessions/new.html.erb
      create    app/views/devise/unlocks
      create    app/views/devise/unlocks/new.html.erb
      invoke  erb
      create    app/views/devise/mailer
      create    app/views/devise/mailer/confirmation_instructions.html.erb
      create    app/views/devise/mailer/email_changed.html.erb
      create    app/views/devise/mailer/password_change.html.erb
      create    app/views/devise/mailer/reset_password_instructions.html.erb
      create    app/views/devise/mailer/unlock_instructions.html.erb

###  devise-bootstrap-views. .. ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

# https://github.com/hisea/devise-bootstrap-views
# echo 'gem "devise-bootstrap-views"' >> Gemfile
# bundle

### edit stylesheet for devise-bootstrap-views. 
 
#ruby $sfil2/devise2thor.rb gsub2 a

# for devise-bootstrap-views..
# rails g devise:views:locale en



###  git. .. ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

git add -A # Add all files and commit them
++ git add -A
git commit -m "add devise 1d"
++ git commit -m 'add devise 1d'
[master 6adbc1f] add devise 1d
 15 files changed, 270 insertions(+)
 create mode 100644 app/views/devise/confirmations/new.html.erb
 create mode 100644 app/views/devise/mailer/confirmation_instructions.html.erb
 create mode 100644 app/views/devise/mailer/email_changed.html.erb
 create mode 100644 app/views/devise/mailer/password_change.html.erb
 create mode 100644 app/views/devise/mailer/reset_password_instructions.html.erb
 create mode 100644 app/views/devise/mailer/unlock_instructions.html.erb
 create mode 100644 app/views/devise/passwords/edit.html.erb
 create mode 100644 app/views/devise/passwords/new.html.erb
 create mode 100644 app/views/devise/registrations/edit.html.erb
 create mode 100644 app/views/devise/registrations/new.html.erb
 create mode 100644 app/views/devise/sessions/new.html.erb
 create mode 100644 app/views/devise/shared/_error_messages.html.erb
 create mode 100644 app/views/devise/shared/_links.html.erb
 create mode 100644 app/views/devise/unlocks/new.html.erb
 create mode 100644 db/schema.rb
  
  
 
# add auth requirement in controller..  
#     sed -i  '/CLIENTSCRIPT="foo"/a CLIENTSCRIPT2="hello"' file  # add line after pattern
#sed -i  "/ApplicationController/a  before_filter :authenticate_user!" app/controllers/application_controller.rb
sed -i  "/ApplicationController/a  before_action :authenticate_user!" lib/templates/rails/scaffold_controller/controller.rb
++ sed -i '/ApplicationController/a  before_action :authenticate_user!' lib/templates/rails/scaffold_controller/controller.rb


 
### edit devise config .. ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
   
ruby $sfil2/devise2thor.rb gsub1 a
++ ruby ../bashrail/devise2thor.rb gsub1 a
        gsub  config/initializers/devise.rb
        gsub  config/initializers/devise.rb
../bashrail
gsub1
  
  
###  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

# uncomment key


# config.secret_key

# uncomment line containing pattern...
#
filetarg='config/initializers/devise.rb'
++ filetarg=config/initializers/devise.rb
r1tmp="/tmp/_temprubyrunner_${USER}.rb"
++ r1tmp=/tmp/_temprubyrunner_albe.rb
cat << 'HEREDOC' > $r1tmp
  repl2 = %Q{
  notused here
  }
  ARGF.each do |line|
    line.sub!('#','') if line =~ /config\.secret_key/
    puts line
  end
HEREDOC
++ cat
ruby $r1tmp $filetarg > $filetarg.tmp
++ ruby /tmp/_temprubyrunner_albe.rb config/initializers/devise.rb
cp $filetarg.tmp $filetarg; rm $filetarg.tmp
++ cp config/initializers/devise.rb.tmp config/initializers/devise.rb
++ rm config/initializers/devise.rb.tmp



###  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


### edit seeds .. ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
   
source $sfil2/seeds1.sh 
++ source ../bashrail/seeds1.sh
#!/usr/bin/env bash
echo ~----------~----------Startingd $HOSTNAME, pwd: `pwd`, dlr0: "$0", bashsource0: "${BASH_SOURCE[0]}", $(date +"%Y-%m-%d_%H.%M.%S")
pwd
++++ pwd
date +"%Y-%m-%d_%H.%M.%S"
++++ date +%Y-%m-%d_%H.%M.%S
+++ echo '~----------~----------Startingd' vamp398, pwd: /srv/test/brails-01/brail542c17, dlr0: bashrail/1mk.sh, bashsource0: ../bashrail/seeds1.sh, 2020-10-25_21.47.24
~----------~----------Startingd vamp398, pwd: /srv/test/brails-01/brail542c17, dlr0: bashrail/1mk.sh, bashsource0: ../bashrail/seeds1.sh, 2020-10-25_21.47.24


### edit seeds .. ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
   
  
cat << 'HEREDOC' >> db/seeds.rb

 r1 = Role.create({name: "lr_minimal", description: "Can't do much"})
 r2 = Role.create({name: "lr_future1", description: ""})
 r3 = Role.create({name: "lr_readonly", description: ""})
 r4 = Role.create({name: "lr_future2", description: ""})
 r5 = Role.create({name: "lr_create", description: ""})
 r6 = Role.create({name: "lr_future3", description: ""})
 r7 = Role.create({name: "lr_regular", description: "Can edit data, readonly lookup tables"})
 r8 = Role.create({name: "lr_future4", description: ""})
 r9 = Role.create({name: "lr_supervisor", description: "Can edit lookup tables"})
r10 = Role.create({name: "lr_future5", description: ""})
r11 = Role.create({name: "lr_delete", description: ""})
r12 = Role.create({name: "lr_future6", description: ""})
r13 = Role.create({name: "lr_vip", description: ""})
r14 = Role.create({name: "lr_future7", description: ""})
r15 = Role.create({name: "lr_special1", description: ""})
r16 = Role.create({name: "lr_seller", description: ""})
r17 = Role.create({name: "lr_future8", description: ""})
r18 = Role.create({name: "lr_admin", description: "Can perform any CRUD operation on any resource"})
 

User.create! email: 'a@e', name: "admin", password: 'a', password_confirmation: 'a', role_id: r18.id
User.create! email: 'a', name: "admin", password: 'a', password_confirmation: 'a', role_id: r18.id
u1 = User.create({name: "reg", email: "r", password: "a", password_confirmation: "a", role_id: r7.id})

HEREDOC
+++ cat
  
 
 
 
###  ~~~~~~~~~ .. ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 
# add logout link to home page..

ruby $sfil2/devise2thor.rb gsub3 a
++ ruby ../bashrail/devise2thor.rb gsub3 a
     prepend  app/views/home/index.html.erb
 

 
# Add Name to user
rails g migration AddNameToUser name
++ rails g migration AddNameToUser name
      invoke  active_record
      create    db/migrate/30170101010102_add_name_to_user.rb
   
   
###  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

# copy ability and user model..
cp -a $sfil2/config/environments/development.rb config/environments/
++ cp -a ../bashrail/config/environments/development.rb config/environments/



# edit the login page to show how to login..

# sftp://10.4.1.228/srv/share/test/brails/brail484b46/app/views/devise/sessions/new.html.erb

# after 
# <h2>Log in</h2>

# <br> <div> Username (enter into the email box below) = a ,  Password = a </div> <br>



###  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

   
git add -A # Add all files and commit them
++ git add -A
git commit -m "add devise 2"
++ git commit -m 'add devise 2'
[master 4a9e4d4] add devise 2
 6 files changed, 72 insertions(+), 12 deletions(-)
 mode change 100644 => 100755 config/environments/development.rb
 create mode 100644 db/migrate/30170101010102_add_name_to_user.rb
  


  source $sfil2/devisejwt.sh   # optional. requires devise1.sh
+ source ../bashrail/devisejwt.sh
#!/usr/bin/env bash
echo ~----------~----------Startingd $HOSTNAME, pwd: `pwd`, dlr0: "$0", bashsource0: "${BASH_SOURCE[0]}", $(date +"%Y-%m-%d_%H.%M.%S")
pwd
+++ pwd
date +"%Y-%m-%d_%H.%M.%S"
+++ date +%Y-%m-%d_%H.%M.%S
++ echo '~----------~----------Startingd' vamp398, pwd: /srv/test/brails-01/brail542c17, dlr0: bashrail/1mk.sh, bashsource0: ../bashrail/devisejwt.sh, 2020-10-25_21.47.25
~----------~----------Startingd vamp398, pwd: /srv/test/brails-01/brail542c17, dlr0: bashrail/1mk.sh, bashsource0: ../bashrail/devisejwt.sh, 2020-10-25_21.47.25


###  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


###  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

# read settings..

read  appn  sfil  sfil2  mpwd  parm0</tmp/"_brvar1202_${USER}".txt
++ read appn sfil sfil2 mpwd parm0
echo $appn $sfil $sfil2 $mpwd $parm0
++ echo brail542c17 bashrail ../bashrail /srv/test/brails-01 bashrail/1mk.sh /home/albe
brail542c17 bashrail ../bashrail /srv/test/brails-01 bashrail/1mk.sh /home/albe

# timeout1=5 ; read -t "${timeout1}" -p "Press ENTER or wait $timeout1 seconds..." || true ;  echo ;


###  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


echo "gem 'jwt'" >> Gemfile
++ echo 'gem '\''jwt'\'''
echo "gem 'rack-cors'" >> Gemfile
++ echo 'gem '\''rack-cors'\'''

bundle
++ bundle
Fetching gem metadata from https://rubygems.org/............
Fetching gem metadata from https://rubygems.org/.
Resolving dependencies...
Using rake 13.0.1
Using concurrent-ruby 1.1.7
Using i18n 1.8.5
Using minitest 5.14.2
Using thread_safe 0.3.6
Using tzinfo 1.2.7
Using activesupport 5.2.4.4
Using builder 3.2.4
Using erubi 1.9.0
Using mini_portile2 2.4.0
Using nokogiri 1.10.10
Using rails-dom-testing 2.0.3
Using crass 1.0.6
Using loofah 2.7.0
Using rails-html-sanitizer 1.3.0
Using actionview 5.2.4.4
Using rack 2.2.3
Using rack-test 1.1.0
Using actionpack 5.2.4.4
Using nio4r 2.5.4
Using websocket-extensions 0.1.5
Using websocket-driver 0.7.3
Using actioncable 5.2.4.4
Using globalid 0.4.2
Using activejob 5.2.4.4
Using mini_mime 1.0.2
Using mail 2.7.1
Using actionmailer 5.2.4.4
Using activemodel 5.2.4.4
Using arel 9.0.0
Using activerecord 5.2.4.4
Using mimemagic 0.3.5
Using marcel 0.3.3
Using activestorage 5.2.4.4
Using public_suffix 4.0.6
Using addressable 2.7.0
Using io-like 0.3.1
Using archive-zip 0.12.0
Using execjs 2.7.0
Using autoprefixer-rails 10.0.1.0
Using bcrypt 3.1.16
Using bindex 0.8.1
Using ffi 1.13.1
Using sassc 2.4.0
Using bootstrap-sass 3.4.1
Using boostrap-sass 0.0.2
Using msgpack 1.3.3
Using bootsnap 1.4.8
Using kaminari-core 1.2.1
Using kaminari-actionview 1.2.1
Using kaminari-activerecord 1.2.1
Using kaminari 1.2.1
Using bundler 1.17.2
Using method_source 1.0.0
Using thor 1.0.1
Using railties 5.2.4.4
Using sprockets 3.7.2
Using sprockets-rails 3.2.2
Using rails 5.2.4.4
Using bootstrap-kaminari-views 0.0.5
Using byebug 11.1.3
Using regexp_parser 1.8.2
Using xpath 3.2.0
Using capybara 3.33.0
Using childprocess 3.0.0
Using chromedriver-helper 2.1.1
Using coffee-script-source 1.12.2
Using coffee-script 2.4.1
Using coffee-rails 4.2.2
Using orm_adapter 0.5.0
Using responders 3.0.1
Using warden 1.2.9
Using devise 4.7.3
Using faker 2.14.0
Using jbuilder 2.10.1
Using jwt 2.2.2
Using rb-fsevent 0.10.4
Using rb-inotify 0.10.1
Using ruby_dep 1.5.0
Using listen 3.1.5
Using polyamorous 2.3.2
Using populator 1.0.0
Using puma 3.12.6
Using rack-cors 1.1.1
Using ransack 2.3.2
Using rubyzip 2.3.0
Using sass-listen 4.0.0
Using sass 3.7.4
Using tilt 2.0.10
Using sass-rails 5.1.0
Using selenium-webdriver 3.142.7
Using simple_form 5.0.3
Using spring 2.1.1
Using spring-watcher-listen 2.0.1
Using sqlite3 1.4.2
Using uglifier 4.2.0
Using web-console 3.7.0
Bundle complete! 29 Gemfile dependencies, 97 gems now installed.
Use `bundle info [gemname]` to see where a bundled gem is installed.


git add -A # Add all files and commit them
++ git add -A
git commit -m "jwt1"
++ git commit -m jwt1
[master 41e7bbe] jwt1
 2 files changed, 7 insertions(+)



###  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~



# add new lines of text after patrn...

filetarg='config/initializers/devise.rb'
++ filetarg=config/initializers/devise.rb
r1tmp="/tmp/_temprubyrunner_${USER}.rb"
++ r1tmp=/tmp/_temprubyrunner_albe.rb
cat << 'HEREDOC' > $r1tmp
  repl2 = %Q{

  config.warden do |manager|
   # Registering your new Strategy
   manager.strategies.add(:jwt, Devise::Strategies::JsonWebToken)
   # Adding the new JWT Strategy to the top of Warden's list,
   # Scoped by what Devise would scope (typically :user)
   manager.default_strategies(scope: :user).unshift :jwt
  end
  
  }
  ARGF.each do |line|
    puts line
    puts repl2 if line =~ /Devise\.setup/
  end
HEREDOC
++ cat
ruby $r1tmp $filetarg > $filetarg.tmp
++ ruby /tmp/_temprubyrunner_albe.rb config/initializers/devise.rb
cp $filetarg.tmp $filetarg; rm $filetarg.tmp
++ cp config/initializers/devise.rb.tmp config/initializers/devise.rb
++ rm config/initializers/devise.rb.tmp



###  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


# Copy files over..


path1='config/initializers/core/extensions/devise/strategies'
++ path1=config/initializers/core/extensions/devise/strategies
mkdir -p $path1/
++ mkdir -p config/initializers/core/extensions/devise/strategies/
rm -r $path1/
++ rm -r config/initializers/core/extensions/devise/strategies/
# rsync.. -a - rltpgoD  preserve almost all. -u update don't copy older source files.
rsync -av --ignore-times  $sfil2/$path1/ $path1/
++ rsync -av --ignore-times ../bashrail/config/initializers/core/extensions/devise/strategies/ config/initializers/core/extensions/devise/strategies/
sending incremental file list
created directory config/initializers/core/extensions/devise/strategies
./
json_web_token.rb

sent 862 bytes  received 114 bytes  1,952.00 bytes/sec
total size is 725  speedup is 0.74


# copy secrets.yml

# first, backup secrets..
mkdir -p backup
++ mkdir -p backup
file1='secrets.yml'
++ file1=secrets.yml
if [ -f  config/$file1 ] ; then 
  cp -a config/$file1  backup/$file1$(date +"__%Y.%m.%d_%H.%M.%S").bak.txt
fi  
++ '[' -f config/secrets.yml ']'
#
path1='config/secrets.yml'
++ path1=config/secrets.yml
cp -a  $sfil2/$path1 $path1
++ cp -a ../bashrail/config/secrets.yml config/secrets.yml



###  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

# edit secrets.yml rather than copying it like the next commented out stanza would..



# add new lines of text after patrn...

filetarg='config/secrets.yml'
++ filetarg=config/secrets.yml
r1tmp="/tmp/_temprubyrunner_${USER}.rb"
++ r1tmp=/tmp/_temprubyrunner_albe.rb
cat << 'HEREDOC' > $r1tmp
  repl2 = %Q{
  # jwt token auth
  # Add somewhere to your secrets yml
  # "config/secrets.yml"
  jwt_secret: '38af0483c50d39ebd0b58ea81a3fc366c199q5c4da5bsuperrandomkey'
  jwt_expiration_hours: 18
  }
  ARGF.each do |line|
    puts line
    puts repl2 if line =~ /development\:/
  end
HEREDOC
++ cat
ruby $r1tmp $filetarg > $filetarg.tmp
++ ruby /tmp/_temprubyrunner_albe.rb config/secrets.yml
cp $filetarg.tmp $filetarg; rm $filetarg.tmp
++ cp config/secrets.yml.tmp config/secrets.yml
++ rm config/secrets.yml.tmp

sleep 1
++ sleep 1

# add new lines of text after patrn...

filetarg='config/secrets.yml'
++ filetarg=config/secrets.yml
r1tmp="/tmp/_temprubyrunner_${USER}.rb"
++ r1tmp=/tmp/_temprubyrunner_albe.rb
cat << 'HEREDOC' > $r1tmp
  repl2 = %Q{
  # jwt token auth
  # Add somewhere to your secrets yml
  # "config/secrets.yml"
  jwt_secret: '62d2f8f20c9852a2da46b9332c8ec62ba95d82509a7c758evenmoresuperrandomkey'
  jwt_expiration_hours: 18
  }
  ARGF.each do |line|
    puts line
    puts repl2 if line =~ /production\:/
  end
HEREDOC
++ cat
ruby $r1tmp $filetarg > $filetarg.tmp
++ ruby /tmp/_temprubyrunner_albe.rb config/secrets.yml
cp $filetarg.tmp $filetarg; rm $filetarg.tmp
++ cp config/secrets.yml.tmp config/secrets.yml
++ rm config/secrets.yml.tmp




###  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
function blockcomment21() {
: <<'BLOCKCOMMENT'



# careful with this one.. You may want to edit manually to preserve it's contents..

# copy secrets.yml

# first, backup secrets..
mkdir -p backup
file1='secrets.yml'
cp -a config/$file1  backup/$file1$(date +"__%Y.%m.%d_%H.%M.%S").bak.txt

path1='config'
mkdir -p $path1/
#  rm -r $path1/
# rsync.. -a - rltpgoD  preserve almost all. -u update don't copy older source files.
rsync -av --ignore-times  $sfil2/$path1/ $path1/

BLOCKCOMMENT
}
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~



###  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


# add to home index..

cat << 'HEREDOC' >> app/views/home/index.html.erb

<br><br><br>
<hr>

JWT
<br>
# The example below is how to make a curl HTTP request with the proper authentication headers.
<br>
# Be sure to actually use a working route and not "http://localhost:3001/products.json"
<br>
<br>

<% if user_signed_in? %>
  curl -i -X  GET --header 'Authorization: Bearer <%= JWTWrapper.encode({ user_id: current_user.id }) %>' 'http://localhost:3001/products.json'
<% end %>

<br><br>
<hr>

HEREDOC
++ cat


### ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




# add new lines of text after patrn...
#
filetarg='app/controllers/application_controller.rb'
++ filetarg=app/controllers/application_controller.rb
r1tmp="/tmp/_temprubyrunner_${USER}.rb"
++ r1tmp=/tmp/_temprubyrunner_albe.rb
cat << 'HEREDOC' > $r1tmp
  repl2 = %Q{
  # Be sure to enable JSON.
  respond_to :html, :json
  }
  ARGF.each do |line|
    puts line
    puts repl2 if line =~ /before_action/
  end
HEREDOC
++ cat
ruby $r1tmp $filetarg > $filetarg.tmp
++ ruby /tmp/_temprubyrunner_albe.rb app/controllers/application_controller.rb
cp $filetarg.tmp $filetarg; rm $filetarg.tmp
++ cp app/controllers/application_controller.rb.tmp app/controllers/application_controller.rb
++ rm app/controllers/application_controller.rb.tmp

sleep 1
++ sleep 1



# csrf handling  cors..


# comment out line if matches patrn and insert repl2 before that line...

filetarg='app/controllers/application_controller.rb'
++ filetarg=app/controllers/application_controller.rb
r1tmp="/tmp/_temprubyrunner_${USER}.rb"
++ r1tmp=/tmp/_temprubyrunner_albe.rb
cat << 'HEREDOC' > $r1tmp
  repl2 = %Q{
  protect_from_forgery with: :null_session
  }
  ARGF.each do |line|
    if line =~ /protect_from_forgery with/ then
      puts repl2
      print '  #'
      puts line
      
    else
      puts line
    end
  end
HEREDOC
++ cat
ruby $r1tmp $filetarg > $filetarg.tmp
++ ruby /tmp/_temprubyrunner_albe.rb app/controllers/application_controller.rb
cp $filetarg.tmp $filetarg; rm $filetarg.tmp
++ cp app/controllers/application_controller.rb.tmp app/controllers/application_controller.rb
++ rm app/controllers/application_controller.rb.tmp


# If patrn `forgery` not found, then add it..

pattern1='protect_from_forgery'
++ pattern1=protect_from_forgery
filetarg='app/controllers/application_controller.rb'
++ filetarg=app/controllers/application_controller.rb
if ! grep -q "${pattern1}" $filetarg ; then 
  (
  # add new lines of text after patrn...
  #
  filetarg='app/controllers/application_controller.rb'
  r1tmp="/tmp/_temprubyrunner_${USER}.rb"
  cat <<-'HEREDOC' > $r1tmp
    patrn='class ApplicationController'
    repl2 = %Q{
    protect_from_forgery with: :null_session
    }
    ARGF.each do |line|
      puts line
      puts repl2 if line =~ /#{Regexp.escape(patrn)}/
   end
HEREDOC
    ruby $r1tmp $filetarg > $filetarg.tmp ; cat $filetarg.tmp ; cp $filetarg.tmp $filetarg; rm $filetarg.tmp
  )
else
  echo L.272 else  
fi
++ grep -q protect_from_forgery app/controllers/application_controller.rb
++ filetarg=app/controllers/application_controller.rb
++ r1tmp=/tmp/_temprubyrunner_albe.rb
++ cat
++ ruby /tmp/_temprubyrunner_albe.rb app/controllers/application_controller.rb
++ cat app/controllers/application_controller.rb.tmp
class ApplicationController < ActionController::Base

    protect_from_forgery with: :null_session
    
end
++ cp app/controllers/application_controller.rb.tmp app/controllers/application_controller.rb
++ rm app/controllers/application_controller.rb.tmp


  
### ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

git add -A # Add all files and commit them
++ git add -A
git commit -m "jwt token auth2"
++ git commit -m 'jwt token auth2'
[master 07e1f38] jwt token auth2
 4 files changed, 62 insertions(+)
 create mode 100644 config/initializers/core/extensions/devise/strategies/json_web_token.rb


### ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


# copy devise controllers

path1='app/controllers/users'
++ path1=app/controllers/users
mkdir -p $path1/
++ mkdir -p app/controllers/users/
rm -r $path1/
++ rm -r app/controllers/users/
# rsync.. -a - rltpgoD  preserve almost all. -u update don't copy older source files.
rsync -av --ignore-times  $sfil2/$path1/ $path1/
++ rsync -av --ignore-times ../bashrail/app/controllers/users/ app/controllers/users/
sending incremental file list
created directory app/controllers/users
./
registrations_controller.rb
sessions_controller.rb

sent 3,739 bytes  received 101 bytes  7,680.00 bytes/sec
total size is 3,516  speedup is 0.92


### ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

# sub  lines of text  when matching patrn...

filetarg='config/routes.rb'
++ filetarg=config/routes.rb
cat << 'HEREDOC' > $r1tmp
  repl2 = %Q{
  devise_for :users, controllers: { sessions: 'users/sessions' }
  }
  ARGF.each do |line|
    if line =~ /devise_for/ then
      puts repl2
    else
      puts line
    end
  end
HEREDOC
++ cat
r1tmp="/tmp/_temprubyrunner_${USER}.rb"
++ r1tmp=/tmp/_temprubyrunner_albe.rb
ruby $r1tmp $filetarg > $filetarg.tmp
++ ruby /tmp/_temprubyrunner_albe.rb config/routes.rb
cp $filetarg.tmp $filetarg; rm $filetarg.tmp
++ cp config/routes.rb.tmp config/routes.rb
++ rm config/routes.rb.tmp



### ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

git add -A # Add all files and commit them
++ git add -A
git commit -m "jwt token auth 3"
++ git commit -m 'jwt token auth 3'
[master 027b0f3] jwt token auth 3
 3 files changed, 142 insertions(+), 1 deletion(-)
 create mode 100644 app/controllers/users/registrations_controller.rb
 create mode 100644 app/controllers/users/sessions_controller.rb


### ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


# add rack-cors logic.

# If patrn `x` not found, then add it..

pattern1='config.middleware.insert'
++ pattern1=config.middleware.insert
filetarg='config/application.rb'
++ filetarg=config/application.rb
if ! grep -q "${pattern1}" $filetarg ; then 
  (
  # add new lines of text after patrn...
  #
  filetarg='config/application.rb'
  r1tmp="/tmp/_temprubyrunner_${USER}.rb"
  cat <<-'HEREDOC' > $r1tmp
    patrn='class Application'
    repl2 = %Q{
    config.middleware.insert_before 0, Rack::Cors do
      allow do
        origins '*'
        resource '*', headers: :any, methods: [:get, :post, :options]
      end
    end
    }
    ARGF.each do |line|
      puts line
      puts repl2 if line =~ /#{Regexp.escape(patrn)}/
   end
HEREDOC
    ruby $r1tmp $filetarg > $filetarg.tmp ; cat $filetarg.tmp ; cp $filetarg.tmp $filetarg; rm $filetarg.tmp
  )
else
  echo L.358 was already there  
fi
++ grep -q config.middleware.insert config/application.rb
++ filetarg=config/application.rb
++ r1tmp=/tmp/_temprubyrunner_albe.rb
++ cat
++ ruby /tmp/_temprubyrunner_albe.rb config/application.rb
++ cat config/application.rb.tmp
require_relative 'boot'

require 'rails/all'

# Require the gems listed in Gemfile, including any gems
# you've limited to :test, :development, or :production.
Bundler.require(*Rails.groups)

module Brail542c17
  class Application < Rails::Application

    config.middleware.insert_before 0, Rack::Cors do
      allow do
        origins '*'
        resource '*', headers: :any, methods: [:get, :post, :options]
      end
    end
    

    
    config.time_zone = 'Eastern Time (US & Canada)'
    
    # Initialize configuration defaults for originally generated Rails version.
    config.load_defaults 5.2

    # Settings in config/environments/* take precedence over those specified here.
    # Application configuration can go into files in config/initializers
    # -- all .rb files in that directory are automatically loaded after loading
    # the framework and any gems in your application.
  end
end
++ cp config/application.rb.tmp config/application.rb
++ rm config/application.rb.tmp

# or
  # source $sfil2/devisetokenauth1.sh   # optional


  source $sfil2/cancan1.sh   # optional, but ..  may require some further edits.
+ source ../bashrail/cancan1.sh
#!/usr/bin/env bash
echo ~----------~----------Startingd $HOSTNAME, pwd: `pwd`, dlr0: "$0", bashsource0: "${BASH_SOURCE[0]}", $(date +"%Y-%m-%d_%H.%M.%S")
pwd
+++ pwd
date +"%Y-%m-%d_%H.%M.%S"
+++ date +%Y-%m-%d_%H.%M.%S
++ echo '~----------~----------Startingd' vamp398, pwd: /srv/test/brails-01/brail542c17, dlr0: bashrail/1mk.sh, bashsource0: ../bashrail/cancan1.sh, 2020-10-25_21.47.30
~----------~----------Startingd vamp398, pwd: /srv/test/brails-01/brail542c17, dlr0: bashrail/1mk.sh, bashsource0: ../bashrail/cancan1.sh, 2020-10-25_21.47.30


###  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 # read settings..

read  appn  sfil  sfil2  mpwd  parm0</tmp/"_brvar1202_${USER}".txt
++ read appn sfil sfil2 mpwd parm0
echo $appn $sfil $sfil2 $mpwd $parm0
++ echo brail542c17 bashrail ../bashrail /srv/test/brails-01 bashrail/1mk.sh /home/albe
brail542c17 bashrail ../bashrail /srv/test/brails-01 bashrail/1mk.sh /home/albe

# timeout1=15 ; read -t "${timeout1}" -p "Press ENTER or wait $timeout1 seconds..."  || true;  echo ;


###  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


echo 'gem "cancancan"' >> Gemfile
++ echo 'gem "cancancan"'

bundle
++ bundle
Fetching gem metadata from https://rubygems.org/............
Fetching gem metadata from https://rubygems.org/.
Resolving dependencies...
Using rake 13.0.1
Using concurrent-ruby 1.1.7
Using i18n 1.8.5
Using minitest 5.14.2
Using thread_safe 0.3.6
Using tzinfo 1.2.7
Using activesupport 5.2.4.4
Using builder 3.2.4
Using erubi 1.9.0
Using mini_portile2 2.4.0
Using nokogiri 1.10.10
Using rails-dom-testing 2.0.3
Using crass 1.0.6
Using loofah 2.7.0
Using rails-html-sanitizer 1.3.0
Using actionview 5.2.4.4
Using rack 2.2.3
Using rack-test 1.1.0
Using actionpack 5.2.4.4
Using nio4r 2.5.4
Using websocket-extensions 0.1.5
Using websocket-driver 0.7.3
Using actioncable 5.2.4.4
Using globalid 0.4.2
Using activejob 5.2.4.4
Using mini_mime 1.0.2
Using mail 2.7.1
Using actionmailer 5.2.4.4
Using activemodel 5.2.4.4
Using arel 9.0.0
Using activerecord 5.2.4.4
Using mimemagic 0.3.5
Using marcel 0.3.3
Using activestorage 5.2.4.4
Using public_suffix 4.0.6
Using addressable 2.7.0
Using io-like 0.3.1
Using archive-zip 0.12.0
Using execjs 2.7.0
Using autoprefixer-rails 10.0.1.0
Using bcrypt 3.1.16
Using bindex 0.8.1
Using ffi 1.13.1
Using sassc 2.4.0
Using bootstrap-sass 3.4.1
Using boostrap-sass 0.0.2
Using msgpack 1.3.3
Using bootsnap 1.4.8
Using kaminari-core 1.2.1
Using kaminari-actionview 1.2.1
Using kaminari-activerecord 1.2.1
Using kaminari 1.2.1
Using bundler 1.17.2
Using method_source 1.0.0
Using thor 1.0.1
Using railties 5.2.4.4
Using sprockets 3.7.2
Using sprockets-rails 3.2.2
Using rails 5.2.4.4
Using bootstrap-kaminari-views 0.0.5
Using byebug 11.1.3
Using cancancan 3.1.0
Using regexp_parser 1.8.2
Using xpath 3.2.0
Using capybara 3.33.0
Using childprocess 3.0.0
Using chromedriver-helper 2.1.1
Using coffee-script-source 1.12.2
Using coffee-script 2.4.1
Using coffee-rails 4.2.2
Using orm_adapter 0.5.0
Using responders 3.0.1
Using warden 1.2.9
Using devise 4.7.3
Using faker 2.14.0
Using jbuilder 2.10.1
Using jwt 2.2.2
Using rb-fsevent 0.10.4
Using rb-inotify 0.10.1
Using ruby_dep 1.5.0
Using listen 3.1.5
Using polyamorous 2.3.2
Using populator 1.0.0
Using puma 3.12.6
Using rack-cors 1.1.1
Using ransack 2.3.2
Using rubyzip 2.3.0
Using sass-listen 4.0.0
Using sass 3.7.4
Using tilt 2.0.10
Using sass-rails 5.1.0
Using selenium-webdriver 3.142.7
Using simple_form 5.0.3
Using spring 2.1.1
Using spring-watcher-listen 2.0.1
Using sqlite3 1.4.2
Using uglifier 4.2.0
Using web-console 3.7.0
Bundle complete! 30 Gemfile dependencies, 98 gems now installed.
Use `bundle info [gemname]` to see where a bundled gem is installed.

###  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

# note .. roles table was created with users table in devise1.rb.

###  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


rails g cancan:ability
++ rails g cancan:ability
      create  app/models/ability.rb



###  git. .. ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

git add -A # Add all files and commit them
++ git add -A
git commit -m "add cancan 1"
++ git commit -m 'add cancan 1'
[master f092445] add cancan 1
 4 files changed, 45 insertions(+)
 create mode 100644 app/models/ability.rb



###  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

# modify scaffold controller and users and roles controllers


# sub , add new lines of text after patrn...

r1tmp="/tmp/_temprubyrunner_${USER}.rb"
++ r1tmp=/tmp/_temprubyrunner_albe.rb
cat << 'HEREDOC' > $r1tmp
  repl2 = %Q{
  #cancancan
  load_and_authorize_resource}
  ARGF.each do |line|
    puts line
    puts repl2 if line =~ /before_action/
  end
HEREDOC
++ cat
filetarg='lib/templates/rails/scaffold_controller/controller.rb'
++ filetarg=lib/templates/rails/scaffold_controller/controller.rb
ruby $r1tmp $filetarg > $filetarg.tmp
++ ruby /tmp/_temprubyrunner_albe.rb lib/templates/rails/scaffold_controller/controller.rb
cp $filetarg.tmp $filetarg; rm $filetarg.tmp
++ cp lib/templates/rails/scaffold_controller/controller.rb.tmp lib/templates/rails/scaffold_controller/controller.rb
++ rm lib/templates/rails/scaffold_controller/controller.rb.tmp




###  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 # add to appl..contro..rb

r1tmp="/tmp/_temprubyrunner_${USER}.rb"
++ r1tmp=/tmp/_temprubyrunner_albe.rb
cat << 'HEREDOC' > $r1tmp
  repl2 = %Q{

  rescue_from CanCan::AccessDenied do |exception|
    respond_to do |format|
      format.json { head :forbidden }
      format.html { redirect_to request.referrer, :alert => exception.message }
    end
  end

  }
  ARGF.each do |line|
    puts line
    puts repl2 if line =~ /class ApplicationController/
  end
HEREDOC
++ cat
filetarg='app/controllers/application_controller.rb'
++ filetarg=app/controllers/application_controller.rb
ruby $r1tmp $filetarg > $filetarg.tmp
++ ruby /tmp/_temprubyrunner_albe.rb app/controllers/application_controller.rb
cp $filetarg.tmp $filetarg; rm $filetarg.tmp
++ cp app/controllers/application_controller.rb.tmp app/controllers/application_controller.rb
++ rm app/controllers/application_controller.rb.tmp


# Another exmple.
#
  # rescue_from CanCan::AccessDenied do |exception|
  #   respond_to do |format|
  #     format.json { head :forbidden }
  #     format.html { redirect_to main_app.root_url, :alert => exception.message }
  #   end
  # end



###  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 # add to users_controller

r1tmp="/tmp/_temprubyrunner_${USER}.rb"
++ r1tmp=/tmp/_temprubyrunner_albe.rb
cat << 'HEREDOC' > $r1tmp
  repl2 = %Q{
  #cancancan
  load_and_authorize_resource}
  ARGF.each  { |line|  puts line ;  puts repl2 if line =~ /before_action/ }
HEREDOC
++ cat
filetarg='app/controllers/users_controller.rb'
++ filetarg=app/controllers/users_controller.rb
if [ -f $filetarg ] ; then
  ruby $r1tmp $filetarg > $filetarg.tmp ; cp $filetarg.tmp $filetarg ; rm $filetarg.tmp
else
  echo 'skipping, file doesnt exist.'
fi
++ '[' -f app/controllers/users_controller.rb ']'
++ echo 'skipping, file doesnt exist.'
skipping, file doesnt exist.



###  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 # add to roles_controller

# r1tmp="/tmp/_temprubyrunner_${USER}.rb"
# cat << 'HEREDOC' > $r1tmp
  # repl2 = %Q{
  # #cancancan
  # load_and_authorize_resource}
  # ARGF.each  { |line|  puts line ;  puts repl2 if line =~ /before_action/ }
# HEREDOC
# filetarg='app/controllers/roles_controller.rb'
# ruby $r1tmp $filetarg > $filetarg.tmp && cp $filetarg.tmp $filetarg && rm $filetarg.tmp


# add roles.

rails g scaffold Role name description active_status:integer sort:integer
++ rails g scaffold Role name description active_status:integer sort:integer
      invoke  active_record
      create    db/migrate/30170101010103_create_roles.rb
      create    app/models/role.rb
      invoke    test_unit
      create      test/models/role_test.rb
      create      test/fixtures/roles.yml
      invoke  resource_route
       route    resources :roles
      invoke  scaffold_controller
      create    app/controllers/roles_controller.rb
      invoke    erb
      create      app/views/roles
      create      app/views/roles/index.html.erb
      create      app/views/roles/edit.html.erb
      create      app/views/roles/show.html.erb
      create      app/views/roles/new.html.erb
      create      app/views/roles/_form.html.erb
      invoke    test_unit
      create      test/controllers/roles_controller_test.rb
      create      test/system/roles_test.rb
      invoke    helper
      create      app/helpers/roles_helper.rb
      invoke      test_unit
      invoke    jbuilder
      create      app/views/roles/index.json.jbuilder
      create      app/views/roles/show.json.jbuilder
      create      app/views/roles/_role.json.jbuilder
      invoke  assets
      invoke    coffee
      create      app/assets/javascripts/roles.coffee
      invoke    scss
      create      app/assets/stylesheets/roles.scss
      invoke  scss
      create    app/assets/stylesheets/scaffolds.scss

# Add role to user.

rails g migration AddRoleToUser role:references
++ rails g migration AddRoleToUser role:references
      invoke  active_record
      create    db/migrate/30170101010104_add_role_to_user.rb



rake db:migrate
++ rake db:migrate
== 30170101010102 AddNameToUser: migrating ====================================
-- add_column(:users, :name, :string)
   -> 0.0005s
== 30170101010102 AddNameToUser: migrated (0.0006s) ===========================

== 30170101010103 CreateRoles: migrating ======================================
-- create_table(:roles)
   -> 0.0020s
== 30170101010103 CreateRoles: migrated (0.0021s) =============================

== 30170101010104 AddRoleToUser: migrating ====================================
-- add_reference(:users, :role, {:foreign_key=>true})
   -> 0.0046s
== 30170101010104 AddRoleToUser: migrated (0.0047s) ===========================



###  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


# copy ability and user model..
mkdir -p  backup/app/models
++ mkdir -p backup/app/models
cp -a app/models/ backup/app/
++ cp -a app/models/ backup/app/
cp -a $sfil2/app/models/ app/
++ cp -a ../bashrail/app/models/ app/

# timeout1=15 ; read -t "${timeout1}" -p "Press ENTER or wait $timeout1 seconds..."  || true;  echo ;




###  git. .. ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

git add -A # Add all files and commit them
++ git add -A
git commit -m "add cancan 2"
++ git commit -m 'add cancan 2'
[master 19d550e] add cancan 2
 28 files changed, 588 insertions(+), 39 deletions(-)
 create mode 100644 app/assets/javascripts/roles.coffee
 create mode 100644 app/assets/stylesheets/roles.scss
 create mode 100644 app/assets/stylesheets/scaffolds.scss
 create mode 100644 app/controllers/roles_controller.rb
 create mode 100644 app/helpers/roles_helper.rb
 rewrite app/models/ability.rb (91%)
 create mode 100644 app/models/role.rb
 create mode 100644 app/views/roles/_form.html.erb
 create mode 100644 app/views/roles/_role.json.jbuilder
 create mode 100644 app/views/roles/edit.html.erb
 create mode 100644 app/views/roles/index.html.erb
 create mode 100644 app/views/roles/index.json.jbuilder
 create mode 100644 app/views/roles/new.html.erb
 create mode 100644 app/views/roles/show.html.erb
 create mode 100644 app/views/roles/show.json.jbuilder
 copy {app => backup/app}/models/ability.rb (100%)
 create mode 100644 backup/app/models/role.rb
 mode change 100644 => 100755 backup/app/models/user.rb
 create mode 100644 db/migrate/30170101010103_create_roles.rb
 create mode 100644 db/migrate/30170101010104_add_role_to_user.rb
 create mode 100644 test/controllers/roles_controller_test.rb
 create mode 100644 test/fixtures/roles.yml
 create mode 100644 test/models/role_test.rb
 create mode 100644 test/system/roles_test.rb



  source $sfil2/admin1.sh  # optional
+ source ../bashrail/admin1.sh
#!/usr/bin/env bash
echo ~----------~----------Startingd $HOSTNAME, pwd: `pwd`, dlr0: "$0", bashsource0: "${BASH_SOURCE[0]}", $(date +"%Y-%m-%d_%H.%M.%S")
pwd
+++ pwd
date +"%Y-%m-%d_%H.%M.%S"
+++ date +%Y-%m-%d_%H.%M.%S
++ echo '~----------~----------Startingd' vamp398, pwd: /srv/test/brails-01/brail542c17, dlr0: bashrail/1mk.sh, bashsource0: ../bashrail/admin1.sh, 2020-10-25_21.47.38
~----------~----------Startingd vamp398, pwd: /srv/test/brails-01/brail542c17, dlr0: bashrail/1mk.sh, bashsource0: ../bashrail/admin1.sh, 2020-10-25_21.47.38

    
### admin1 .. ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

#echo "gem 'rails_admin', :git =>  'https://github.com/dgleba/rails_admin.git'" >> Gemfile
# 2017-05-21 got error with git repo. Missing template rails_admin/main/dashboard, rails_admin/application/dashboard with...
#   changed to v 1.1.1...
echo "gem 'rails_admin'" >> Gemfile
++ echo 'gem '\''rails_admin'\'''

# 
bundle update
++ bundle update
Fetching gem metadata from https://rubygems.org/..........
Fetching gem metadata from https://rubygems.org/.
Resolving dependencies.........
Using rake 13.0.1
Using concurrent-ruby 1.1.7
Using i18n 1.8.5
Using minitest 5.14.2
Using thread_safe 0.3.6
Using tzinfo 1.2.7
Using activesupport 5.2.4.4
Using builder 3.2.4
Using erubi 1.9.0
Using mini_portile2 2.4.0
Using nokogiri 1.10.10
Using rails-dom-testing 2.0.3
Using crass 1.0.6
Using loofah 2.7.0
Using rails-html-sanitizer 1.3.0
Using actionview 5.2.4.4
Using rack 2.2.3
Using rack-test 1.1.0
Using actionpack 5.2.4.4
Using nio4r 2.5.4
Using websocket-extensions 0.1.5
Using websocket-driver 0.7.3
Using actioncable 5.2.4.4
Using globalid 0.4.2
Using activejob 5.2.4.4
Using mini_mime 1.0.2
Using mail 2.7.1
Using actionmailer 5.2.4.4
Using activemodel 5.2.4.4
Using activemodel-serializers-xml 1.0.2
Using arel 9.0.0
Using activerecord 5.2.4.4
Using mimemagic 0.3.5
Using marcel 0.3.3
Using activestorage 5.2.4.4
Using public_suffix 4.0.6
Using addressable 2.7.0
Using io-like 0.3.1
Using archive-zip 0.12.0
Using execjs 2.7.0
Using autoprefixer-rails 10.0.1.0
Using bcrypt 3.1.16
Using bindex 0.8.1
Using ffi 1.13.1
Using sassc 2.4.0
Using bootstrap-sass 3.4.1
Using boostrap-sass 0.0.2
Using msgpack 1.3.3
Using bootsnap 1.4.8
Using kaminari-core 1.2.1
Using kaminari-actionview 1.2.1
Using kaminari-activerecord 1.2.1
Using kaminari 1.2.1
Using bundler 1.17.2
Using method_source 1.0.0
Using thor 1.0.1
Using railties 5.2.4.4
Using sprockets 3.7.2
Using sprockets-rails 3.2.2
Using rails 5.2.4.4
Using bootstrap-kaminari-views 0.0.5
Using byebug 11.1.3
Using cancancan 3.1.0
Using regexp_parser 1.8.2
Using xpath 3.2.0
Using capybara 3.33.0
Using childprocess 3.0.0
Using chromedriver-helper 2.1.1
Using coffee-script-source 1.12.2
Using coffee-script 2.4.1
Using coffee-rails 4.2.2
Using orm_adapter 0.5.0
Using responders 3.0.1
Using warden 1.2.9
Using devise 4.7.3
Using faker 2.14.0
Using temple 0.8.2
Using tilt 2.0.10
Using haml 5.2.0
Using jbuilder 2.10.1
Using jquery-rails 4.4.0
Using jquery-ui-rails 6.0.1
Using jwt 2.2.2
Using rb-fsevent 0.10.4
Using rb-inotify 0.10.1
Using ruby_dep 1.5.0
Using listen 3.1.5
Using nested_form 0.3.2
Using polyamorous 2.3.2
Using populator 1.0.0
Using puma 3.12.6
Using rack-cors 1.1.1
Using rack-pjax 1.1.0
Using remotipart 1.4.4
Using sassc-rails 2.1.2
Using rails_admin 2.0.2
Using ransack 2.3.2
Using rubyzip 2.3.0
Using sass-listen 4.0.0
Using sass 3.7.4
Using sass-rails 5.1.0
Using selenium-webdriver 3.142.7
Using simple_form 5.0.3
Using spring 2.1.1
Using spring-watcher-listen 2.0.1
Using sqlite3 1.4.2
Using uglifier 4.2.0
Using web-console 3.7.0
Bundle updated!

# gem1="gem 'activeadmin', github: 'activeadmin'"
# echo "$gem1" >> Gemfile

#echo "gem 'administrate'" >> Gemfile
#echo "gem 'bourbon'" >> Gemfile

bundle update
++ bundle update
Fetching gem metadata from https://rubygems.org/..........
Fetching gem metadata from https://rubygems.org/.
Resolving dependencies.......
Using rake 13.0.1
Using concurrent-ruby 1.1.7
Using i18n 1.8.5
Using minitest 5.14.2
Using thread_safe 0.3.6
Using tzinfo 1.2.7
Using activesupport 5.2.4.4
Using builder 3.2.4
Using erubi 1.9.0
Using mini_portile2 2.4.0
Using nokogiri 1.10.10
Using rails-dom-testing 2.0.3
Using crass 1.0.6
Using loofah 2.7.0
Using rails-html-sanitizer 1.3.0
Using actionview 5.2.4.4
Using rack 2.2.3
Using rack-test 1.1.0
Using actionpack 5.2.4.4
Using nio4r 2.5.4
Using websocket-extensions 0.1.5
Using websocket-driver 0.7.3
Using actioncable 5.2.4.4
Using globalid 0.4.2
Using activejob 5.2.4.4
Using mini_mime 1.0.2
Using mail 2.7.1
Using actionmailer 5.2.4.4
Using activemodel 5.2.4.4
Using activemodel-serializers-xml 1.0.2
Using arel 9.0.0
Using activerecord 5.2.4.4
Using mimemagic 0.3.5
Using marcel 0.3.3
Using activestorage 5.2.4.4
Using public_suffix 4.0.6
Using addressable 2.7.0
Using io-like 0.3.1
Using archive-zip 0.12.0
Using execjs 2.7.0
Using autoprefixer-rails 10.0.1.0
Using bcrypt 3.1.16
Using bindex 0.8.1
Using ffi 1.13.1
Using sassc 2.4.0
Using bootstrap-sass 3.4.1
Using boostrap-sass 0.0.2
Using msgpack 1.3.3
Using bootsnap 1.4.8
Using kaminari-core 1.2.1
Using kaminari-actionview 1.2.1
Using kaminari-activerecord 1.2.1
Using kaminari 1.2.1
Using bundler 1.17.2
Using method_source 1.0.0
Using thor 1.0.1
Using railties 5.2.4.4
Using sprockets 3.7.2
Using sprockets-rails 3.2.2
Using rails 5.2.4.4
Using bootstrap-kaminari-views 0.0.5
Using byebug 11.1.3
Using cancancan 3.1.0
Using regexp_parser 1.8.2
Using xpath 3.2.0
Using capybara 3.33.0
Using childprocess 3.0.0
Using chromedriver-helper 2.1.1
Using coffee-script-source 1.12.2
Using coffee-script 2.4.1
Using coffee-rails 4.2.2
Using orm_adapter 0.5.0
Using responders 3.0.1
Using warden 1.2.9
Using devise 4.7.3
Using faker 2.14.0
Using temple 0.8.2
Using tilt 2.0.10
Using haml 5.2.0
Using jbuilder 2.10.1
Using jquery-rails 4.4.0
Using jquery-ui-rails 6.0.1
Using jwt 2.2.2
Using rb-fsevent 0.10.4
Using rb-inotify 0.10.1
Using ruby_dep 1.5.0
Using listen 3.1.5
Using nested_form 0.3.2
Using polyamorous 2.3.2
Using populator 1.0.0
Using puma 3.12.6
Using rack-cors 1.1.1
Using rack-pjax 1.1.0
Using remotipart 1.4.4
Using sassc-rails 2.1.2
Using rails_admin 2.0.2
Using ransack 2.3.2
Using rubyzip 2.3.0
Using sass-listen 4.0.0
Using sass 3.7.4
Using sass-rails 5.1.0
Using selenium-webdriver 3.142.7
Using simple_form 5.0.3
Using spring 2.1.1
Using spring-watcher-listen 2.0.1
Using sqlite3 1.4.2
Using uglifier 4.2.0
Using web-console 3.7.0
Bundle updated!

# active admin..

# rails g active_admin:install --skip-users
# rake db:migrate
# rake db:seed
# rails generate active_admin:resource Product
# rails destroy active_admin:resource Products



# administrate by thoughtbot

#rails generate administrate:install


# error..
# /Users/dg/.rbenv/versions/2.3.0/lib/ruby/gems/2.3.0/gems/railties-4.2.7.1/lib/rails/generators/named_base.rb:102:in
#  `block in class_name': undefined method `camelize' for nil:NilClass (NoMethodError)
#
# named_base.rb`block in class_name': undefined method `camelize' for nil:NilClass (NoMethodError)
#
#  ans..  must add administrate after data is added.
  
git add -A # Add all files and commit them
++ git add -A
git commit -m "install  admin1"
++ git commit -m 'install  admin1'
[master e62c4c8] install  admin1
 2 files changed, 39 insertions(+)
  

  
     
   
### admin2 .. ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 
# rails_admin..


# + expect
# spawn rails g rails_admin:install
# couldn't execute "rails g rails_admin:install": no such file or directory
    # while executing
# "spawn "rails g rails_admin:install""
# ---
# question for ..   rails g rails_admin:install
#   ?  Where do you want to mount rails_admin? Press <enter> for [admin] > 
#
# prog='rails g rails_admin:install'
# expect <<EOF
# spawn "$prog"
# expect "[admin] >"
# send "radmin\n"
# expect eof
# exit
# EOF


# works..
 printf 'radmin\n' | rails g rails_admin:install
++ printf 'radmin\n'
++ rails g rails_admin:install
           ?  Where do you want to mount rails_admin? Press <enter> for [admin] [K>
> radmin
       route  mount RailsAdmin::Engine => '/radmin', as: 'rails_admin'
      create  config/initializers/rails_admin.rb



sleep 1
++ sleep 1
git add -A # Add all files and commit them
++ git add -A
git commit -m "install  admin"
++ git commit -m 'install  admin'
[master 8859ac1] install  admin
 2 files changed, 42 insertions(+)
 create mode 100644 config/initializers/rails_admin.rb
  
 
# _____________  custom layout for rails_admin list


# https://github.com/sferik/rails_admin/wiki/Horizontally-scrolling-table-with-frozen-columns-in-list-view


mkdir -p app/assets/javascripts/rails_admin/custom
++ mkdir -p app/assets/javascripts/rails_admin/custom

# $ not working...  single quote the heredoc label to prevent and expansion...

cat << 'HEREDOC' > app/assets/javascripts/rails_admin/custom/ui.js
$(document).on('rails_admin.dom_ready', function(){
  var $table = $('#bulk_form').find('table');
  var table = $table[0];

  // Abort if there's nothing to do. Don't repeat ourselves, either.
  if (!table || $table.hasClass('js-horiz-scroll')) { return; }

  // Add our indicator class. Also some enhancements.
  $table.addClass('js-horiz-scroll table-hover');

  ////
  // Make the table horizontally scrollable.
  // Inspiration from bootstrap's table-responsive.
  ////
  var tableWrapper = document.createElement('DIV');
  //tableWrapper.className = 'table-responsive';
  //tableWrapper.style.width = '100%';
  tableWrapper.style.overflowX = 'auto';
  tableWrapper.style.marginBottom = table.style.marginBottom;
  table.style.marginBottom = '0';
  //tableWrapper.style.overflowY = 'hidden';
  table.parentElement.insertBefore(tableWrapper, table);
  tableWrapper.appendChild(table);
  $table.find('th.last,td.last').each(function(index, td){
    var tr = td.parentElement;
    tr.insertBefore(td, tr.children[1]);
  });

  ////
  // Freeze the left columns.
  // Inspiration from http://stackoverflow.com/questions/1312236/how-do-i-create-an-html-table-with-fixed-frozen-left-column-and-scrollable-body
  ////
  var $trs = $table.find('tr');
  var $headerTr = $trs.first();
  var $headerTds = $headerTr.children('th,td');
  var i, $td, pos;
  var offsets = [];
  var widths = [];
  for (i = 0; i < 3; i++) {
    $td = $($headerTds[i]);
    pos = $td.position();
    offsets.push(pos.left);
    widths.push($td.outerWidth());
  }
  $trs.each(function(index, tr){
    for (i = 0; i < 3; i++) {
      tr.children[i].style.position = 'absolute';
      tr.children[i].style.left = offsets[i]+'px';
      tr.children[i].style.width = widths[i]+'px';
    }
  });
  $td = $($headerTds[2]);
  var margin = $td.position().left + $td.outerWidth() - $(tableWrapper).position().left;
  tableWrapper.style.marginLeft = margin+'px';
  tableWrapper.style.borderLeft = '1px solid black';

  // Bottom-align the headers.
  var trHeight = $headerTr.height();
  for (i = 0; i < 3; i++) {
    $td = $($headerTr[0].children[i]);
    $td.css('padding-top', (trHeight - $td.height() - 4)+'px');
  }

  // Remove main browser window's horizontal scrollbar.
  $('body').css('overflow-x', 'hidden');
});
HEREDOC
++ cat


  
# bump version to get custom layout to load...
#  
# remove line containing  '[global]'  and replace the line completely with the new text...
#      sed -i  's/.*global].*/[global]\n\nunix extensions = no/g' /etc/samba/smb.conf 
patrn1='Rails.application.config.assets.version'
++ patrn1=Rails.application.config.assets.version
# patrn1='version'
patrn2='Rails.application.config.assets.version = \"1.2\"'
++ patrn2='Rails.application.config.assets.version = \"1.2\"'
# patrn2='Railsxxxxx'
sed -i  -e "s/.*$patrn1.*/$patrn2/" config/initializers/assets.rb
++ sed -i -e 's/.*Rails.application.config.assets.version.*/Rails.application.config.assets.version = \"1.2\"/' config/initializers/assets.rb

# add configs... 
#   sed -i  '/CLIENTSCRIPT/a \ \ CLIENTSCRIPT2' file  # add line after pattern - include leading spaces like so - escape them.. '\ '  
patrn='RailsAdmin.config'
++ patrn=RailsAdmin.config
addln='\ \ config.total_columns_width = 9999999'
++ addln='\ \ config.total_columns_width = 9999999'
sed -i  "/$patrn/a$addln" config/initializers/rails_admin.rb
++ sed -i '/RailsAdmin.config/a\ \ config.total_columns_width = 9999999' config/initializers/rails_admin.rb



# Change this line.. config.authorize_with :cancan
#
# replace whole complete entire line if line matches patrn using ruby...
#
filetarg='config/initializers/rails_admin.rb'
++ filetarg=config/initializers/rails_admin.rb
cat $filetarg
++ cat config/initializers/rails_admin.rb
RailsAdmin.config do |config|
  config.total_columns_width = 9999999

  ### Popular gems integration

  ## == Devise ==
  # config.authenticate_with do
  #   warden.authenticate! scope: :user
  # end
  # config.current_user_method(&:current_user)

  ## == CancanCan ==
  # config.authorize_with :cancancan

  ## == Pundit ==
  # config.authorize_with :pundit

  ## == PaperTrail ==
  # config.audit_with :paper_trail, 'User', 'PaperTrail::Version' # PaperTrail >= 3.0.0

  ### More at https://github.com/sferik/rails_admin/wiki/Base-configuration

  ## == Gravatar integration ==
  ## To disable Gravatar integration in Navigation Bar set to false
  # config.show_gravatar = true

  config.actions do
    dashboard                     # mandatory
    index                         # mandatory
    new
    export
    bulk_delete
    show
    edit
    delete
    show_in_app

    ## With an audit adapter, you can add:
    # history_index
    # history_show
  end
end
r1tmp="/tmp/_temprubyrunner_${USER}.rb"
++ r1tmp=/tmp/_temprubyrunner_albe.rb
cat << 'HEREDOC' > $r1tmp
patrn='config.authorize_with :cancan'
  repl2 = %Q{   config.authorize_with :cancancan  }
  ARGF.each do |line|
    if line =~ /#{Regexp.escape(patrn)}/
      puts repl2 
    else  
      puts line
    end
  end
HEREDOC
++ cat
ruby $r1tmp $filetarg > $filetarg.tmp
++ ruby /tmp/_temprubyrunner_albe.rb config/initializers/rails_admin.rb
cat $filetarg.tmp
++ cat config/initializers/rails_admin.rb.tmp
RailsAdmin.config do |config|
  config.total_columns_width = 9999999

  ### Popular gems integration

  ## == Devise ==
  # config.authenticate_with do
  #   warden.authenticate! scope: :user
  # end
  # config.current_user_method(&:current_user)

  ## == CancanCan ==
   config.authorize_with :cancancan  

  ## == Pundit ==
  # config.authorize_with :pundit

  ## == PaperTrail ==
  # config.audit_with :paper_trail, 'User', 'PaperTrail::Version' # PaperTrail >= 3.0.0

  ### More at https://github.com/sferik/rails_admin/wiki/Base-configuration

  ## == Gravatar integration ==
  ## To disable Gravatar integration in Navigation Bar set to false
  # config.show_gravatar = true

  config.actions do
    dashboard                     # mandatory
    index                         # mandatory
    new
    export
    bulk_delete
    show
    edit
    delete
    show_in_app

    ## With an audit adapter, you can add:
    # history_index
    # history_show
  end
end
cp $filetarg.tmp $filetarg; rm $filetarg.tmp
++ cp config/initializers/rails_admin.rb.tmp config/initializers/rails_admin.rb
++ rm config/initializers/rails_admin.rb.tmp


sleep 1
++ sleep 1
git add -A # Add all files and commit them
++ git add -A
git commit -m "configure customized  admin"
++ git commit -m 'configure customized  admin'
[master ad5992f] configure customized  admin
 3 files changed, 69 insertions(+), 2 deletions(-)
 create mode 100644 app/assets/javascripts/rails_admin/custom/ui.js
  

  #source ../bashrail/admin-ra-materialtheme.sh
  # or
  source $sfil2/admin-ra-materialtheme.sh
+ source ../bashrail/admin-ra-materialtheme.sh
#!/usr/bin/env bash
echo ~----------~----------Startingd $HOSTNAME, pwd: `pwd`, dlr0: "$0", bashsource0: "${BASH_SOURCE[0]}", $(date +"%Y-%m-%d_%H.%M.%S")
pwd
+++ pwd
date +"%Y-%m-%d_%H.%M.%S"
+++ date +%Y-%m-%d_%H.%M.%S
++ echo '~----------~----------Startingd' vamp398, pwd: /srv/test/brails-01/brail542c17, dlr0: bashrail/1mk.sh, bashsource0: ../bashrail/admin-ra-materialtheme.sh, 2020-10-25_21.47.48
~----------~----------Startingd vamp398, pwd: /srv/test/brails-01/brail542c17, dlr0: bashrail/1mk.sh, bashsource0: ../bashrail/admin-ra-materialtheme.sh, 2020-10-25_21.47.48


#cd ;
 # set -e will exit on first error. so set -vxe..
date ; set +vx  ; set -vx ; # echo off, then echo on
++ date
Sun Oct 25 21:47:48 EDT 2020
++ set +vx

# this
#   add rails_admin  material theme 
#

#  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


# usage:
# if appn = rail281j then..
# input files will be in var/share203/rail281file folder.
# cd /home/albe/share203
#       rail347a4mksh/rail347a4-mk.sh
# The output will be that it creates  var/share203/rail281j/*
#
#   rail347a4mksh/rail347a6-mk.sh


#  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


     
  
### gemfile.. ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

echo "# " >> Gemfile
++ echo '# '

# gem1="gem 'simple_form'"
# echo "$gem1" >> Gemfile

# rails_admin must already be installed..
# echo "gem 'rails_admin'" >> Gemfile
# or
# echo "gem 'rails_admin', :git =>  'https://github.com/dgleba/rails_admin.git'" >> Gemfile

echo "gem 'rails_admin_material'" >> Gemfile
++ echo 'gem '\''rails_admin_material'\'''
echo "gem 'rails_admin_mydash'" >> Gemfile
++ echo 'gem '\''rails_admin_mydash'\'''


echo "# " >> Gemfile
++ echo '# '

bundle
++ bundle
Fetching gem metadata from https://rubygems.org/..........
Fetching gem metadata from https://rubygems.org/.
Resolving dependencies...
Using rake 13.0.1
Using concurrent-ruby 1.1.7
Using i18n 1.8.5
Using minitest 5.14.2
Using thread_safe 0.3.6
Using tzinfo 1.2.7
Using activesupport 5.2.4.4
Using builder 3.2.4
Using erubi 1.9.0
Using mini_portile2 2.4.0
Using nokogiri 1.10.10
Using rails-dom-testing 2.0.3
Using crass 1.0.6
Using loofah 2.7.0
Using rails-html-sanitizer 1.3.0
Using actionview 5.2.4.4
Using rack 2.2.3
Using rack-test 1.1.0
Using actionpack 5.2.4.4
Using nio4r 2.5.4
Using websocket-extensions 0.1.5
Using websocket-driver 0.7.3
Using actioncable 5.2.4.4
Using globalid 0.4.2
Using activejob 5.2.4.4
Using mini_mime 1.0.2
Using mail 2.7.1
Using actionmailer 5.2.4.4
Using activemodel 5.2.4.4
Using activemodel-serializers-xml 1.0.2
Using arel 9.0.0
Using activerecord 5.2.4.4
Using mimemagic 0.3.5
Using marcel 0.3.3
Using activestorage 5.2.4.4
Using public_suffix 4.0.6
Using addressable 2.7.0
Using io-like 0.3.1
Using archive-zip 0.12.0
Using execjs 2.7.0
Using autoprefixer-rails 10.0.1.0
Using bcrypt 3.1.16
Using bindex 0.8.1
Using ffi 1.13.1
Using sassc 2.4.0
Using bootstrap-sass 3.4.1
Using boostrap-sass 0.0.2
Using msgpack 1.3.3
Using bootsnap 1.4.8
Using kaminari-core 1.2.1
Using kaminari-actionview 1.2.1
Using kaminari-activerecord 1.2.1
Using kaminari 1.2.1
Using bundler 1.17.2
Using method_source 1.0.0
Using thor 1.0.1
Using railties 5.2.4.4
Using sprockets 3.7.2
Using sprockets-rails 3.2.2
Using rails 5.2.4.4
Using bootstrap-kaminari-views 0.0.5
Using byebug 11.1.3
Using cancancan 3.1.0
Using regexp_parser 1.8.2
Using xpath 3.2.0
Using capybara 3.33.0
Using childprocess 3.0.0
Using chromedriver-helper 2.1.1
Using coffee-script-source 1.12.2
Using coffee-script 2.4.1
Using coffee-rails 4.2.2
Using orm_adapter 0.5.0
Using responders 3.0.1
Using warden 1.2.9
Using devise 4.7.3
Using faker 2.14.0
Using temple 0.8.2
Using tilt 2.0.10
Using haml 5.2.0
Using jbuilder 2.10.1
Using jquery-rails 4.4.0
Using jquery-ui-rails 6.0.1
Using jwt 2.2.2
Using rb-fsevent 0.10.4
Using rb-inotify 0.10.1
Using ruby_dep 1.5.0
Using listen 3.1.5
Using nested_form 0.3.2
Using polyamorous 2.3.2
Using populator 1.0.0
Using puma 3.12.6
Using rack-cors 1.1.1
Using rack-pjax 1.1.0
Using remotipart 1.4.4
Using sassc-rails 2.1.2
Using rails_admin 2.0.2
Using rails_admin_material 0.2.1
Using rails_admin_mydash 0.1.8
Using ransack 2.3.2
Using rubyzip 2.3.0
Using sass-listen 4.0.0
Using sass 3.7.4
Using sass-rails 5.1.0
Using selenium-webdriver 3.142.7
Using simple_form 5.0.3
Using spring 2.1.1
Using spring-watcher-listen 2.0.1
Using sqlite3 1.4.2
Using uglifier 4.2.0
Using web-console 3.7.0
Bundle complete! 33 Gemfile dependencies, 110 gems now installed.
Use `bundle info [gemname]` to see where a bundled gem is installed.

sleep 2
++ sleep 2
git add -A # Add all files and commit them
++ git add -A
git commit -m "gemfile for rails_admin material theme"
++ git commit -m 'gemfile for rails_admin material theme'
[master f820abb] gemfile for rails_admin material theme
 2 files changed, 9 insertions(+)


#  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

    
# material theme..

 
#
# add line after match...  sed -i '/CLIENTSCRIPT="foo"/a CLIENTSCRIPT2="hello"' file
# i think 0, means only do it for the first match..
#
pattern1='Bundler.require'
++ pattern1=Bundler.require
line1="  ENV['RAILS_ADMIN_THEME'] = 'material'"
++ line1='  ENV['\''RAILS_ADMIN_THEME'\''] = '\''material'\'''
# replace the entire line matching pattern1...
# sed  -i "0,/$pattern1/a \ \n$line1\n\n" config/application.rb 
sed  -i "/$pattern1/a \ \n$line1\n\n" config/application.rb 
++ sed -i '/Bundler.require/a \ \n  ENV['\''RAILS_ADMIN_THEME'\''] = '\''material'\''\n\n' config/application.rb
 
 
mkdir -p app/assets/javascripts/rails_admin/custom
++ mkdir -p app/assets/javascripts/rails_admin/custom
#
# add text to beginning of file..
sed -i '1i//= require rails_admin/themes/material/ui.js' app/assets/javascripts/rails_admin/custom/ui.js
++ sed -i '1i//= require rails_admin/themes/material/ui.js' app/assets/javascripts/rails_admin/custom/ui.js
# echo '//= require rails_admin/themes/material/ui.js' >> app/assets/javascripts/rails_admin/custom/ui.js
   

# bump version to get custom layout to load...
#  
# remove line containing  '[global]'  and replace the line completely with the new text...
#      sed -i  's/.*global].*/[global]\n\nunix extensions = no/g' /etc/samba/smb.conf 
patrn1='Rails.application.config.assets.version'
++ patrn1=Rails.application.config.assets.version
# patrn1='version'
patrn2='Rails.application.config.assets.version = \"1.3\"'
++ patrn2='Rails.application.config.assets.version = \"1.3\"'
# patrn2='Railsxxxxx'
sed -i  -e "s/.*$patrn1.*/$patrn2/" config/initializers/assets.rb
++ sed -i -e 's/.*Rails.application.config.assets.version.*/Rails.application.config.assets.version = \"1.3\"/' config/initializers/assets.rb


#  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
   

#  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

function notusedcomments() {
: <<'BLOCKCOMMENT1'


  
  
BLOCKCOMMENT1
} 

#  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




  source $sfil2/ldap1.sh
+ source ../bashrail/ldap1.sh
#!/usr/bin/env bash
echo ~----------~----------Startingd $HOSTNAME, pwd: `pwd`, dlr0: "$0", bashsource0: "${BASH_SOURCE[0]}", $(date +"%Y-%m-%d_%H.%M.%S")
pwd
+++ pwd
date +"%Y-%m-%d_%H.%M.%S"
+++ date +%Y-%m-%d_%H.%M.%S
++ echo '~----------~----------Startingd' vamp398, pwd: /srv/test/brails-01/brail542c17, dlr0: bashrail/1mk.sh, bashsource0: ../bashrail/ldap1.sh, 2020-10-25_21.47.53
~----------~----------Startingd vamp398, pwd: /srv/test/brails-01/brail542c17, dlr0: bashrail/1mk.sh, bashsource0: ../bashrail/ldap1.sh, 2020-10-25_21.47.53


###  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

# read settings..

read  appn  sfil  sfil2  mpwd  parm0</tmp/"_brvar1202_${USER}".txt
++ read appn sfil sfil2 mpwd parm0
echo $appn $sfil $sfil2 $mpwd $parm0
++ echo brail542c17 bashrail ../bashrail /srv/test/brails-01 bashrail/1mk.sh /home/albe
brail542c17 bashrail ../bashrail /srv/test/brails-01 bashrail/1mk.sh /home/albe

# timeout1=5 ; read -t "${timeout1}" -p "Press ENTER or wait $timeout1 seconds..." || true ;  echo ;


###  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


echo 'gem "devise_ldap_authenticatable", :git => "git://github.com/cschiewek/devise_ldap_authenticatable.git" , ref: "HEAD"' >> Gemfile
++ echo 'gem "devise_ldap_authenticatable", :git => "git://github.com/cschiewek/devise_ldap_authenticatable.git" , ref: "HEAD"'

bundle
++ bundle
The git source `git://github.com/cschiewek/devise_ldap_authenticatable.git` uses the `git` protocol, which transmits data without encryption. Disable this warning with `bundle config git.allow_insecure true`, or switch to the `https` protocol to keep your data secure.
Fetching git://github.com/cschiewek/devise_ldap_authenticatable.git
Fetching gem metadata from https://rubygems.org/..........
Fetching gem metadata from https://rubygems.org/.
Resolving dependencies...
Using rake 13.0.1
Using concurrent-ruby 1.1.7
Using i18n 1.8.5
Using minitest 5.14.2
Using thread_safe 0.3.6
Using tzinfo 1.2.7
Using activesupport 5.2.4.4
Using builder 3.2.4
Using erubi 1.9.0
Using mini_portile2 2.4.0
Using nokogiri 1.10.10
Using rails-dom-testing 2.0.3
Using crass 1.0.6
Using loofah 2.7.0
Using rails-html-sanitizer 1.3.0
Using actionview 5.2.4.4
Using rack 2.2.3
Using rack-test 1.1.0
Using actionpack 5.2.4.4
Using nio4r 2.5.4
Using websocket-extensions 0.1.5
Using websocket-driver 0.7.3
Using actioncable 5.2.4.4
Using globalid 0.4.2
Using activejob 5.2.4.4
Using mini_mime 1.0.2
Using mail 2.7.1
Using actionmailer 5.2.4.4
Using activemodel 5.2.4.4
Using activemodel-serializers-xml 1.0.2
Using arel 9.0.0
Using activerecord 5.2.4.4
Using mimemagic 0.3.5
Using marcel 0.3.3
Using activestorage 5.2.4.4
Using public_suffix 4.0.6
Using addressable 2.7.0
Using io-like 0.3.1
Using archive-zip 0.12.0
Using execjs 2.7.0
Using autoprefixer-rails 10.0.1.0
Using bcrypt 3.1.16
Using bindex 0.8.1
Using ffi 1.13.1
Using sassc 2.4.0
Using bootstrap-sass 3.4.1
Using boostrap-sass 0.0.2
Using msgpack 1.3.3
Using bootsnap 1.4.8
Using kaminari-core 1.2.1
Using kaminari-actionview 1.2.1
Using kaminari-activerecord 1.2.1
Using kaminari 1.2.1
Using bundler 1.17.2
Using method_source 1.0.0
Using thor 1.0.1
Using railties 5.2.4.4
Using sprockets 3.7.2
Using sprockets-rails 3.2.2
Using rails 5.2.4.4
Using bootstrap-kaminari-views 0.0.5
Using byebug 11.1.3
Using cancancan 3.1.0
Using regexp_parser 1.8.2
Using xpath 3.2.0
Using capybara 3.33.0
Using childprocess 3.0.0
Using chromedriver-helper 2.1.1
Using coffee-script-source 1.12.2
Using coffee-script 2.4.1
Using coffee-rails 4.2.2
Using orm_adapter 0.5.0
Using responders 3.0.1
Using warden 1.2.9
Using devise 4.7.3
Using net-ldap 0.16.3
Using devise_ldap_authenticatable 0.8.7 from git://github.com/cschiewek/devise_ldap_authenticatable.git (at HEAD@6ef2131)
Using faker 2.14.0
Using temple 0.8.2
Using tilt 2.0.10
Using haml 5.2.0
Using jbuilder 2.10.1
Using jquery-rails 4.4.0
Using jquery-ui-rails 6.0.1
Using jwt 2.2.2
Using rb-fsevent 0.10.4
Using rb-inotify 0.10.1
Using ruby_dep 1.5.0
Using listen 3.1.5
Using nested_form 0.3.2
Using polyamorous 2.3.2
Using populator 1.0.0
Using puma 3.12.6
Using rack-cors 1.1.1
Using rack-pjax 1.1.0
Using remotipart 1.4.4
Using sassc-rails 2.1.2
Using rails_admin 2.0.2
Using rails_admin_material 0.2.1
Using rails_admin_mydash 0.1.8
Using ransack 2.3.2
Using rubyzip 2.3.0
Using sass-listen 4.0.0
Using sass 3.7.4
Using sass-rails 5.1.0
Using selenium-webdriver 3.142.7
Using simple_form 5.0.3
Using spring 2.1.1
Using spring-watcher-listen 2.0.1
Using sqlite3 1.4.2
Using uglifier 4.2.0
Using web-console 3.7.0
Bundle complete! 34 Gemfile dependencies, 112 gems now installed.
Use `bundle info [gemname]` to see where a bundled gem is installed.


git add -A # Add all files and commit them
++ git add -A
git commit -m "ldap - 1 - before rails g devise_ldap_authenticatable:install"
++ git commit -m 'ldap - 1 - before rails g devise_ldap_authenticatable:install'
[master e67f7bb] ldap - 1 - before rails g devise_ldap_authenticatable:install
 5 files changed, 18 insertions(+), 1 deletion(-)



###  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

rails g devise_ldap_authenticatable:install
++ rails g devise_ldap_authenticatable:install
      create  config/ldap.yml
      insert  config/initializers/devise.rb
        gsub  app/models/user.rb
      insert  app/controllers/application_controller.rb

# copy  user model..
mkdir -p  backup/app/models
++ mkdir -p backup/app/models
# cp -a app/models/ backup/app/
cp -a $sfil2/app/models/user.rb app/models/
++ cp -a ../bashrail/app/models/user.rb app/models/

git status
++ git status
On branch master
Changes not staged for commit:
  (use "git add <file>..." to update what will be committed)
  (use "git checkout -- <file>..." to discard changes in working directory)

	modified:   app/controllers/application_controller.rb
	modified:   config/initializers/devise.rb

no changes added to commit (use "git add" and/or "git commit -a")
# git diff
git add .
++ git add .
git commit -m "after rails g devise_ldap_authenticatable:install"
++ git commit -m 'after rails g devise_ldap_authenticatable:install'
[master 1acb843] after rails g devise_ldap_authenticatable:install
 2 files changed, 15 insertions(+)




###  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

# not working..

# # add new lines of text after patrn...
# #
# filetarg='app/models/user.rb'
# r1tmp="/tmp/_temprubyrunner_${USER}.rb"
# cat << 'HEREDOC' > $r1tmp
  # repl2 = %Q{
  # devise :database_authenticatable, :registerable,
  # }
  # ARGF.each do |line|
    # puts line
    # puts repl2 if line =~ /confirmable/
  # end
# HEREDOC
# ruby $r1tmp $filetarg > $filetarg.tmp
# cp $filetarg.tmp $filetarg; rm $filetarg.tmp




# not working..

# # comment line containing pattern...
# #
# filetarg='app/models/user.rb'
# r1tmp="/tmp/_temprubyrunner_${USER}.rb"
# cat << 'HEREDOC' > $r1tmp
  # repl2 = %Q{
  # notused
  # }
  # ARGF.each do |line|
    # if line =~ /ldap_authenticatable/
      # puts "  ##{line}"
    # else
      # puts line
    # end
  # end
# HEREDOC
# ruby $r1tmp $filetarg > $filetarg.tmp
# cp $filetarg.tmp $filetarg; rm $filetarg.tmp





#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

function offline21() {
: <<'BLOCKCOMMENT'


I am getting this error.

Just make the changes manually for now.
Have to copy my ldap.yml into place anyway..


albe@v206x20161030220807:~/share203/dg/brail347a11papertrail$ irb
irb(main):001:0>   repl2 = <<-RBHEREDOC
irb(main):002:0"   config.ldap_create_user = true
irb(main):003:0"   config.ldap_auth_username_builder = Proc.new() {|attribute, login, ldap| "#{login}@stackpole.ca"}
irb(main):004:0"   RBHEREDOC
NameError: undefined local variable or method `login' for main:Object
	from (irb):3
	from /home/albe/.rbenv/versions/2.3.0/bin/irb:11:in `<main>'
irb(main):005:0>


BLOCKCOMMENT
}

### ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
### ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


# add new lines of text after patrn...

filetarg='config/initializers/devise.rb'
++ filetarg=config/initializers/devise.rb
r1tmp="/tmp/_temprubyrunner_${USER}.rb"
++ r1tmp=/tmp/_temprubyrunner_albe.rb
cat << 'HEREDOC' > $r1tmp
  repl2 = %q[

  config.ldap_create_user = true
  config.ldap_auth_username_builder = Proc.new() {|attribute, login, ldap| "#{login}@stackpole.ca"}
  ]
  ARGF.each do |line|
    puts line
    puts repl2 if line =~ /config.ldap_ad_group_check/
  end
HEREDOC
++ cat
ruby $r1tmp $filetarg > $filetarg.tmp
++ ruby /tmp/_temprubyrunner_albe.rb config/initializers/devise.rb
cp $filetarg.tmp $filetarg; rm $filetarg.tmp
++ cp config/initializers/devise.rb.tmp config/initializers/devise.rb
++ rm config/initializers/devise.rb.tmp


###  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


### ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

git add -A # Add all files and commit them
++ git add -A
git commit -m "ldap - 3. setup finished. check the ldap_manual-edits.txt file for more instructions"
++ git commit -m 'ldap - 3. setup finished. check the ldap_manual-edits.txt file for more instructions'
[master f8965ae] ldap - 3. setup finished. check the ldap_manual-edits.txt file for more instructions
 1 file changed, 5 insertions(+)


### ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

  source $sfil2/papertrail1.sh
+ source ../bashrail/papertrail1.sh
#!/usr/bin/env bash
echo ~----------~----------Startingd $HOSTNAME, pwd: `pwd`, dlr0: "$0", bashsource0: "${BASH_SOURCE[0]}", $(date +"%Y-%m-%d_%H.%M.%S")
pwd
+++ pwd
date +"%Y-%m-%d_%H.%M.%S"
+++ date +%Y-%m-%d_%H.%M.%S
++ echo '~----------~----------Startingd' vamp398, pwd: /srv/test/brails-01/brail542c17, dlr0: bashrail/1mk.sh, bashsource0: ../bashrail/papertrail1.sh, 2020-10-25_21.47.57
~----------~----------Startingd vamp398, pwd: /srv/test/brails-01/brail542c17, dlr0: bashrail/1mk.sh, bashsource0: ../bashrail/papertrail1.sh, 2020-10-25_21.47.57


###  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

# read settings..

read  appn  sfil  sfil2  mpwd  parm0</tmp/"_brvar1202_${USER}".txt
++ read appn sfil sfil2 mpwd parm0
echo $appn $sfil $sfil2 $mpwd $parm0
++ echo brail542c17 bashrail ../bashrail /srv/test/brails-01 bashrail/1mk.sh /home/albe
brail542c17 bashrail ../bashrail /srv/test/brails-01 bashrail/1mk.sh /home/albe

# timeout1=5 ; read -t "${timeout1}" -p "Press ENTER or wait $timeout1 seconds..." || true ;  echo ;


###  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


echo "gem 'paper_trail'" >> Gemfile
++ echo 'gem '\''paper_trail'\'''

bundle
++ bundle
The git source `git://github.com/cschiewek/devise_ldap_authenticatable.git` uses the `git` protocol, which transmits data without encryption. Disable this warning with `bundle config git.allow_insecure true`, or switch to the `https` protocol to keep your data secure.
Fetching gem metadata from https://rubygems.org/..........
Fetching gem metadata from https://rubygems.org/.
Resolving dependencies...
Using rake 13.0.1
Using concurrent-ruby 1.1.7
Using i18n 1.8.5
Using minitest 5.14.2
Using thread_safe 0.3.6
Using tzinfo 1.2.7
Using activesupport 5.2.4.4
Using builder 3.2.4
Using erubi 1.9.0
Using mini_portile2 2.4.0
Using nokogiri 1.10.10
Using rails-dom-testing 2.0.3
Using crass 1.0.6
Using loofah 2.7.0
Using rails-html-sanitizer 1.3.0
Using actionview 5.2.4.4
Using rack 2.2.3
Using rack-test 1.1.0
Using actionpack 5.2.4.4
Using nio4r 2.5.4
Using websocket-extensions 0.1.5
Using websocket-driver 0.7.3
Using actioncable 5.2.4.4
Using globalid 0.4.2
Using activejob 5.2.4.4
Using mini_mime 1.0.2
Using mail 2.7.1
Using actionmailer 5.2.4.4
Using activemodel 5.2.4.4
Using activemodel-serializers-xml 1.0.2
Using arel 9.0.0
Using activerecord 5.2.4.4
Using mimemagic 0.3.5
Using marcel 0.3.3
Using activestorage 5.2.4.4
Using public_suffix 4.0.6
Using addressable 2.7.0
Using io-like 0.3.1
Using archive-zip 0.12.0
Using execjs 2.7.0
Using autoprefixer-rails 10.0.1.0
Using bcrypt 3.1.16
Using bindex 0.8.1
Using ffi 1.13.1
Using sassc 2.4.0
Using bootstrap-sass 3.4.1
Using boostrap-sass 0.0.2
Using msgpack 1.3.3
Using bootsnap 1.4.8
Using kaminari-core 1.2.1
Using kaminari-actionview 1.2.1
Using kaminari-activerecord 1.2.1
Using kaminari 1.2.1
Using bundler 1.17.2
Using method_source 1.0.0
Using thor 1.0.1
Using railties 5.2.4.4
Using sprockets 3.7.2
Using sprockets-rails 3.2.2
Using rails 5.2.4.4
Using bootstrap-kaminari-views 0.0.5
Using byebug 11.1.3
Using cancancan 3.1.0
Using regexp_parser 1.8.2
Using xpath 3.2.0
Using capybara 3.33.0
Using childprocess 3.0.0
Using chromedriver-helper 2.1.1
Using coffee-script-source 1.12.2
Using coffee-script 2.4.1
Using coffee-rails 4.2.2
Using orm_adapter 0.5.0
Using responders 3.0.1
Using warden 1.2.9
Using devise 4.7.3
Using net-ldap 0.16.3
Using devise_ldap_authenticatable 0.8.7 from git://github.com/cschiewek/devise_ldap_authenticatable.git (at HEAD@6ef2131)
Using faker 2.14.0
Using temple 0.8.2
Using tilt 2.0.10
Using haml 5.2.0
Using jbuilder 2.10.1
Using jquery-rails 4.4.0
Using jquery-ui-rails 6.0.1
Using jwt 2.2.2
Using rb-fsevent 0.10.4
Using rb-inotify 0.10.1
Using ruby_dep 1.5.0
Using listen 3.1.5
Using nested_form 0.3.2
Using request_store 1.5.0
Using paper_trail 11.0.0
Using polyamorous 2.3.2
Using populator 1.0.0
Using puma 3.12.6
Using rack-cors 1.1.1
Using rack-pjax 1.1.0
Using remotipart 1.4.4
Using sassc-rails 2.1.2
Using rails_admin 2.0.2
Using rails_admin_material 0.2.1
Using rails_admin_mydash 0.1.8
Using ransack 2.3.2
Using rubyzip 2.3.0
Using sass-listen 4.0.0
Using sass 3.7.4
Using sass-rails 5.1.0
Using selenium-webdriver 3.142.7
Using simple_form 5.0.3
Using spring 2.1.1
Using spring-watcher-listen 2.0.1
Using sqlite3 1.4.2
Using uglifier 4.2.0
Using web-console 3.7.0
Bundle complete! 35 Gemfile dependencies, 114 gems now installed.
Use `bundle info [gemname]` to see where a bundled gem is installed.


git add -A # Add all files and commit them
++ git add -A
git commit -m "paper_trail - 1"
++ git commit -m 'paper_trail - 1'
[master 40ba259] paper_trail - 1
 2 files changed, 7 insertions(+)



###  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


bundle exec rails generate paper_trail:install --with-changes --with-associations
++ bundle exec rails generate paper_trail:install --with-changes --with-associations
      create  db/migrate/30170101010105_create_versions.rb
      create  db/migrate/30170101010106_add_object_changes_to_versions.rb
bundle exec rake db:migrate
++ bundle exec rake db:migrate
== 30170101010105 CreateVersions: migrating ===================================
-- create_table(:versions)
   -> 0.0009s
-- add_index(:versions, [:item_type, :item_id])
   -> 0.0005s
== 30170101010105 CreateVersions: migrated (0.0032s) ==========================

== 30170101010106 AddObjectChangesToVersions: migrating =======================
-- add_column(:versions, :object_changes, :text, {:limit=>1073741823})
   -> 0.0179s
== 30170101010106 AddObjectChangesToVersions: migrated (0.0180s) ==============



git add -A # Add all files and commit them
++ git add -A
git commit -m "paper_trail - 2. install and migrate"
++ git commit -m 'paper_trail - 2. install and migrate'
[master 72530a1] paper_trail - 2. install and migrate
 3 files changed, 60 insertions(+), 1 deletion(-)
 create mode 100644 db/migrate/30170101010105_create_versions.rb
 create mode 100644 db/migrate/30170101010106_add_object_changes_to_versions.rb


###  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
# add new lines of text after patrn...
#
filetarg='app/models/user.rb'
++ filetarg=app/models/user.rb
r1tmp="/tmp/_temprubyrunner_${USER}.rb"
++ r1tmp=/tmp/_temprubyrunner_albe.rb
cat << 'HEREDOC' > $r1tmp
  repl2 = %Q{
  has_paper_trail
  }
  ARGF.each do |line|
    puts line
    puts repl2 if line =~ /class /
  end
HEREDOC
++ cat
ruby $r1tmp $filetarg > $filetarg.tmp
++ ruby /tmp/_temprubyrunner_albe.rb app/models/user.rb
cp $filetarg.tmp $filetarg; rm $filetarg.tmp
++ cp app/models/user.rb.tmp app/models/user.rb
++ rm app/models/user.rb.tmp



# add new lines of text after patrn...
#
filetarg='app/controllers/application_controller.rb'
++ filetarg=app/controllers/application_controller.rb
r1tmp="/tmp/_temprubyrunner_${USER}.rb"
++ r1tmp=/tmp/_temprubyrunner_albe.rb
cat << 'HEREDOC' > $r1tmp
  repl2 = %Q{
  before_action :set_paper_trail_whodunnit
  }
  ARGF.each do |line|
    puts line
    puts repl2 if line =~ /class /
  end
HEREDOC
++ cat
ruby $r1tmp $filetarg > $filetarg.tmp
++ ruby /tmp/_temprubyrunner_albe.rb app/controllers/application_controller.rb
cp $filetarg.tmp $filetarg; rm $filetarg.tmp
++ cp app/controllers/application_controller.rb.tmp app/controllers/application_controller.rb
++ rm app/controllers/application_controller.rb.tmp



# uncomment line containing pattern...
#
filetarg='config/initializers/rails_admin.rb'
++ filetarg=config/initializers/rails_admin.rb
r1tmp="/tmp/_temprubyrunner_${USER}.rb"
++ r1tmp=/tmp/_temprubyrunner_albe.rb
cat << 'HEREDOC' > $r1tmp
  repl2 = %Q{
  notused
  }
  ARGF.each do |line|
    line.sub!('#','') if line =~ /config\.audit.*paper_trail/
    puts line
  end
HEREDOC
++ cat
ruby $r1tmp $filetarg > $filetarg.tmp
++ ruby /tmp/_temprubyrunner_albe.rb config/initializers/rails_admin.rb
cp $filetarg.tmp $filetarg; rm $filetarg.tmp
++ cp config/initializers/rails_admin.rb.tmp config/initializers/rails_admin.rb
++ rm config/initializers/rails_admin.rb.tmp




# uncomment line containing pattern...
#
filetarg='config/initializers/rails_admin.rb'
++ filetarg=config/initializers/rails_admin.rb
r1tmp="/tmp/_temprubyrunner_${USER}.rb"
++ r1tmp=/tmp/_temprubyrunner_albe.rb
cat << 'HEREDOC' > $r1tmp
  repl2 = %Q{
  notused
  }
  ARGF.each do |line|
    line.sub!('#','') if line =~ /history_show/
    puts line
  end
HEREDOC
++ cat
ruby $r1tmp $filetarg > $filetarg.tmp
++ ruby /tmp/_temprubyrunner_albe.rb config/initializers/rails_admin.rb
cp $filetarg.tmp $filetarg; rm $filetarg.tmp
++ cp config/initializers/rails_admin.rb.tmp config/initializers/rails_admin.rb
++ rm config/initializers/rails_admin.rb.tmp



# uncomment line containing pattern...
#
filetarg='config/initializers/rails_admin.rb'
++ filetarg=config/initializers/rails_admin.rb
r1tmp="/tmp/_temprubyrunner_${USER}.rb"
++ r1tmp=/tmp/_temprubyrunner_albe.rb
cat << 'HEREDOC' > $r1tmp
  repl2 = %Q{
  notused
  }
  ARGF.each do |line|
    line.sub!('#','') if line =~ /history_index/
    puts line
  end
HEREDOC
++ cat
ruby $r1tmp $filetarg > $filetarg.tmp
++ ruby /tmp/_temprubyrunner_albe.rb config/initializers/rails_admin.rb
cp $filetarg.tmp $filetarg; rm $filetarg.tmp
++ cp config/initializers/rails_admin.rb.tmp config/initializers/rails_admin.rb
++ rm config/initializers/rails_admin.rb.tmp




### ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


# add new lines of text after patrn...
#
filetarg='config/initializers/rails_admin.rb'
++ filetarg=config/initializers/rails_admin.rb
r1tmp="/tmp/_temprubyrunner_${USER}.rb"
++ r1tmp=/tmp/_temprubyrunner_albe.rb
cat << 'HEREDOC' > $r1tmp
  repl2 = %Q{
  # == Devise ==
  config.authenticate_with do
    warden.authenticate! scope: :user
  end
  config.current_user_method(&:current_user)

  # == Cancan ==
  config.authorize_with :cancan
  }
  ARGF.each do |line|
    puts line
    puts repl2 if line =~ /RailsAdmin.*config /
  end
HEREDOC
++ cat
ruby $r1tmp $filetarg > $filetarg.tmp
++ ruby /tmp/_temprubyrunner_albe.rb config/initializers/rails_admin.rb
cp $filetarg.tmp $filetarg; rm $filetarg.tmp
++ cp config/initializers/rails_admin.rb.tmp config/initializers/rails_admin.rb
++ rm config/initializers/rails_admin.rb.tmp


  

### ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
### ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

git add -A # Add all files and commit them
++ git add -A
git commit -m "paper_trail - 3. setup"
++ git commit -m 'paper_trail - 3. setup'
[master 374fad9] paper_trail - 3. setup
 3 files changed, 20 insertions(+), 4 deletions(-)


### ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

# To specify different table name..

# ftp://albe@pmdsdata3/srv/web/hrapp361/app/models/papertrail_table.rb
# #
# class PapertrailTable < PaperTrail::Version
  # self.table_name = :versions_dc
# end

# ftp://albe@pmdsdata3/srv/web/hrapp361/app/models/pp_parkingpass.rb
# #
# class PpParkingpass < ApplicationRecord
  # has_paper_trail class_name: 'PapertrailTable'
# end

# I have not figured out how to get rails_admin to play nice with that..
  # It said table versions was not present.


### ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


  source $sfil2/figaro.env.sh
+ source ../bashrail/figaro.env.sh
#!/usr/bin/env bash
echo ~----------~----------Startingd $HOSTNAME, pwd: `pwd`, dlr0: "$0", bashsource0: "${BASH_SOURCE[0]}", $(date +"%Y-%m-%d_%H.%M.%S")
pwd
+++ pwd
date +"%Y-%m-%d_%H.%M.%S"
+++ date +%Y-%m-%d_%H.%M.%S
++ echo '~----------~----------Startingd' vamp398, pwd: /srv/test/brails-01/brail542c17, dlr0: bashrail/1mk.sh, bashsource0: ../bashrail/figaro.env.sh, 2020-10-25_21.48.03
~----------~----------Startingd vamp398, pwd: /srv/test/brails-01/brail542c17, dlr0: bashrail/1mk.sh, bashsource0: ../bashrail/figaro.env.sh, 2020-10-25_21.48.03


###  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

# read settings..

read  appn  sfil  sfil2  mpwd  parm0</tmp/"_brvar1202_${USER}".txt
++ read appn sfil sfil2 mpwd parm0
echo $appn $sfil $sfil2 $mpwd $parm0
++ echo brail542c17 bashrail ../bashrail /srv/test/brails-01 bashrail/1mk.sh /home/albe
brail542c17 bashrail ../bashrail /srv/test/brails-01 bashrail/1mk.sh /home/albe

# timeout1=5 ; read -t "${timeout1}" -p "Press ENTER or wait $timeout1 seconds..." || true ;  echo ;


###  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


echo '#' >> Gemfile
++ echo '#'
echo 'gem "figaro"' >> Gemfile
++ echo 'gem "figaro"'

bundle
++ bundle
The git source `git://github.com/cschiewek/devise_ldap_authenticatable.git` uses the `git` protocol, which transmits data without encryption. Disable this warning with `bundle config git.allow_insecure true`, or switch to the `https` protocol to keep your data secure.
Fetching gem metadata from https://rubygems.org/..........
Fetching gem metadata from https://rubygems.org/.
Resolving dependencies...
Using rake 13.0.1
Using concurrent-ruby 1.1.7
Using i18n 1.8.5
Using minitest 5.14.2
Using thread_safe 0.3.6
Using tzinfo 1.2.7
Using activesupport 5.2.4.4
Using builder 3.2.4
Using erubi 1.9.0
Using mini_portile2 2.4.0
Using nokogiri 1.10.10
Using rails-dom-testing 2.0.3
Using crass 1.0.6
Using loofah 2.7.0
Using rails-html-sanitizer 1.3.0
Using actionview 5.2.4.4
Using rack 2.2.3
Using rack-test 1.1.0
Using actionpack 5.2.4.4
Using nio4r 2.5.4
Using websocket-extensions 0.1.5
Using websocket-driver 0.7.3
Using actioncable 5.2.4.4
Using globalid 0.4.2
Using activejob 5.2.4.4
Using mini_mime 1.0.2
Using mail 2.7.1
Using actionmailer 5.2.4.4
Using activemodel 5.2.4.4
Using activemodel-serializers-xml 1.0.2
Using arel 9.0.0
Using activerecord 5.2.4.4
Using mimemagic 0.3.5
Using marcel 0.3.3
Using activestorage 5.2.4.4
Using public_suffix 4.0.6
Using addressable 2.7.0
Using io-like 0.3.1
Using archive-zip 0.12.0
Using execjs 2.7.0
Using autoprefixer-rails 10.0.1.0
Using bcrypt 3.1.16
Using bindex 0.8.1
Using ffi 1.13.1
Using sassc 2.4.0
Using bootstrap-sass 3.4.1
Using boostrap-sass 0.0.2
Using msgpack 1.3.3
Using bootsnap 1.4.8
Using kaminari-core 1.2.1
Using kaminari-actionview 1.2.1
Using kaminari-activerecord 1.2.1
Using kaminari 1.2.1
Using bundler 1.17.2
Using method_source 1.0.0
Using thor 1.0.1
Using railties 5.2.4.4
Using sprockets 3.7.2
Using sprockets-rails 3.2.2
Using rails 5.2.4.4
Using bootstrap-kaminari-views 0.0.5
Using byebug 11.1.3
Using cancancan 3.1.0
Using regexp_parser 1.8.2
Using xpath 3.2.0
Using capybara 3.33.0
Using childprocess 3.0.0
Using chromedriver-helper 2.1.1
Using coffee-script-source 1.12.2
Using coffee-script 2.4.1
Using coffee-rails 4.2.2
Using orm_adapter 0.5.0
Using responders 3.0.1
Using warden 1.2.9
Using devise 4.7.3
Using net-ldap 0.16.3
Using devise_ldap_authenticatable 0.8.7 from git://github.com/cschiewek/devise_ldap_authenticatable.git (at HEAD@6ef2131)
Using faker 2.14.0
Using figaro 1.2.0
Using temple 0.8.2
Using tilt 2.0.10
Using haml 5.2.0
Using jbuilder 2.10.1
Using jquery-rails 4.4.0
Using jquery-ui-rails 6.0.1
Using jwt 2.2.2
Using rb-fsevent 0.10.4
Using rb-inotify 0.10.1
Using ruby_dep 1.5.0
Using listen 3.1.5
Using nested_form 0.3.2
Using request_store 1.5.0
Using paper_trail 11.0.0
Using polyamorous 2.3.2
Using populator 1.0.0
Using puma 3.12.6
Using rack-cors 1.1.1
Using rack-pjax 1.1.0
Using remotipart 1.4.4
Using sassc-rails 2.1.2
Using rails_admin 2.0.2
Using rails_admin_material 0.2.1
Using rails_admin_mydash 0.1.8
Using ransack 2.3.2
Using rubyzip 2.3.0
Using sass-listen 4.0.0
Using sass 3.7.4
Using sass-rails 5.1.0
Using selenium-webdriver 3.142.7
Using simple_form 5.0.3
Using spring 2.1.1
Using spring-watcher-listen 2.0.1
Using sqlite3 1.4.2
Using uglifier 4.2.0
Using web-console 3.7.0
Bundle complete! 36 Gemfile dependencies, 115 gems now installed.
Use `bundle info [gemname]` to see where a bundled gem is installed.


git add -A # Add all files and commit them
++ git add -A
git commit -m "figaro environment gem"
++ git commit -m 'figaro environment gem'
[master 5cc96af] figaro environment gem
 2 files changed, 5 insertions(+)



###  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

bundle exec figaro install
++ bundle exec figaro install
      create  config/application.yml
      append  .gitignore


echo 'SECRET_KEY_BASE: f55c9f3b84be053f8ea74b84d' >> config/application.yml
++ echo 'SECRET_KEY_BASE: f55c9f3b84be053f8ea74b84d'
echo 'DATABASE_USERNAME: username1' >> config/application.yml
++ echo 'DATABASE_USERNAME: username1'
echo 'DATABASE_PASSWORD: pass1' >> config/application.yml
++ echo 'DATABASE_PASSWORD: pass1'


git status
++ git status
On branch master
Changes not staged for commit:
  (use "git add <file>..." to update what will be committed)
  (use "git checkout -- <file>..." to discard changes in working directory)

	modified:   .gitignore

no changes added to commit (use "git add" and/or "git commit -a")
# git diff
git add -A
++ git add -A
git commit -m "after figaro install"
++ git commit -m 'after figaro install'
[master 71d6fce] after figaro install
 1 file changed, 3 insertions(+)




###  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

# change database gems..

# add text to end of line containing patrn...
#
filetarg='Gemfile'
++ filetarg=Gemfile
r1tmp="/tmp/_temprubyrunner_${USER}.rb"
++ r1tmp=/tmp/_temprubyrunner_albe.rb
cat << 'HEREDOC' > $r1tmp
  repl2 = 'not used here' 
  ARGF.each do |line|
    if line =~ /gem.*sqlite3/
      puts line.sub!(/sqlite3\'/, 'sqlite3\', group: :development')
    else
      puts line
    end  
  end
HEREDOC
++ cat
ruby $r1tmp $filetarg > $filetarg.tmp
++ ruby /tmp/_temprubyrunner_albe.rb Gemfile
cp $filetarg.tmp $filetarg; rm $filetarg.tmp
++ cp Gemfile.tmp Gemfile
++ rm Gemfile.tmp



# add new lines of text after patrn...
#
filetarg='Gemfile'
++ filetarg=Gemfile
r1tmp="/tmp/_temprubyrunner_${USER}.rb"
++ r1tmp=/tmp/_temprubyrunner_albe.rb
cat << 'HEREDOC' > $r1tmp
  repl2 = %q{
  gem 'mysql2', group: :development
  # gem 'pg', group: :production
  }
  ARGF.each do |line|
    puts line
    puts repl2 if line =~ /gem.*sqlite3/
  end
HEREDOC
++ cat
ruby $r1tmp $filetarg > $filetarg.tmp
++ ruby /tmp/_temprubyrunner_albe.rb Gemfile
cp $filetarg.tmp $filetarg; rm $filetarg.tmp
++ cp Gemfile.tmp Gemfile
++ rm Gemfile.tmp

bundle install
++ bundle install
The git source `git://github.com/cschiewek/devise_ldap_authenticatable.git` uses the `git` protocol, which transmits data without encryption. Disable this warning with `bundle config git.allow_insecure true`, or switch to the `https` protocol to keep your data secure.
Fetching gem metadata from https://rubygems.org/..........
Fetching gem metadata from https://rubygems.org/.
Resolving dependencies...
Using rake 13.0.1
Using concurrent-ruby 1.1.7
Using i18n 1.8.5
Using minitest 5.14.2
Using thread_safe 0.3.6
Using tzinfo 1.2.7
Using activesupport 5.2.4.4
Using builder 3.2.4
Using erubi 1.9.0
Using mini_portile2 2.4.0
Using nokogiri 1.10.10
Using rails-dom-testing 2.0.3
Using crass 1.0.6
Using loofah 2.7.0
Using rails-html-sanitizer 1.3.0
Using actionview 5.2.4.4
Using rack 2.2.3
Using rack-test 1.1.0
Using actionpack 5.2.4.4
Using nio4r 2.5.4
Using websocket-extensions 0.1.5
Using websocket-driver 0.7.3
Using actioncable 5.2.4.4
Using globalid 0.4.2
Using activejob 5.2.4.4
Using mini_mime 1.0.2
Using mail 2.7.1
Using actionmailer 5.2.4.4
Using activemodel 5.2.4.4
Using activemodel-serializers-xml 1.0.2
Using arel 9.0.0
Using activerecord 5.2.4.4
Using mimemagic 0.3.5
Using marcel 0.3.3
Using activestorage 5.2.4.4
Using public_suffix 4.0.6
Using addressable 2.7.0
Using io-like 0.3.1
Using archive-zip 0.12.0
Using execjs 2.7.0
Using autoprefixer-rails 10.0.1.0
Using bcrypt 3.1.16
Using bindex 0.8.1
Using ffi 1.13.1
Using sassc 2.4.0
Using bootstrap-sass 3.4.1
Using boostrap-sass 0.0.2
Using msgpack 1.3.3
Using bootsnap 1.4.8
Using kaminari-core 1.2.1
Using kaminari-actionview 1.2.1
Using kaminari-activerecord 1.2.1
Using kaminari 1.2.1
Using bundler 1.17.2
Using method_source 1.0.0
Using thor 1.0.1
Using railties 5.2.4.4
Using sprockets 3.7.2
Using sprockets-rails 3.2.2
Using rails 5.2.4.4
Using bootstrap-kaminari-views 0.0.5
Using byebug 11.1.3
Using cancancan 3.1.0
Using regexp_parser 1.8.2
Using xpath 3.2.0
Using capybara 3.33.0
Using childprocess 3.0.0
Using chromedriver-helper 2.1.1
Using coffee-script-source 1.12.2
Using coffee-script 2.4.1
Using coffee-rails 4.2.2
Using orm_adapter 0.5.0
Using responders 3.0.1
Using warden 1.2.9
Using devise 4.7.3
Using net-ldap 0.16.3
Using devise_ldap_authenticatable 0.8.7 from git://github.com/cschiewek/devise_ldap_authenticatable.git (at HEAD@6ef2131)
Using faker 2.14.0
Using figaro 1.2.0
Using temple 0.8.2
Using tilt 2.0.10
Using haml 5.2.0
Using jbuilder 2.10.1
Using jquery-rails 4.4.0
Using jquery-ui-rails 6.0.1
Using jwt 2.2.2
Using rb-fsevent 0.10.4
Using rb-inotify 0.10.1
Using ruby_dep 1.5.0
Using listen 3.1.5
Fetching mysql2 0.5.3
Installing mysql2 0.5.3 with native extensions
Using nested_form 0.3.2
Using request_store 1.5.0
Using paper_trail 11.0.0
Using polyamorous 2.3.2
Using populator 1.0.0
Using puma 3.12.6
Using rack-cors 1.1.1
Using rack-pjax 1.1.0
Using remotipart 1.4.4
Using sassc-rails 2.1.2
Using rails_admin 2.0.2
Using rails_admin_material 0.2.1
Using rails_admin_mydash 0.1.8
Using ransack 2.3.2
Using rubyzip 2.3.0
Using sass-listen 4.0.0
Using sass 3.7.4
Using sass-rails 5.1.0
Using selenium-webdriver 3.142.7
Using simple_form 5.0.3
Using spring 2.1.1
Using spring-watcher-listen 2.0.1
Using sqlite3 1.4.2
Using uglifier 4.2.0
Using web-console 3.7.0
Bundle complete! 37 Gemfile dependencies, 116 gems now installed.
Use `bundle info [gemname]` to see where a bundled gem is installed.

###  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~



function offline21() {
: <<'BLOCKCOMMENT'





BLOCKCOMMENT
}


### ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

# git add -A # Add all files and commit them
# git commit -m "figaro setup"


### ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  

  # See below for select2.sh and jqueryautocomplete.sh
  
  
### scaffold... ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


rails g scaffold CountryOfOrigin name ctype fdate:datetime active_status:integer sort_order:integer -f
+ rails g scaffold CountryOfOrigin name ctype fdate:datetime active_status:integer sort_order:integer -f
      invoke  active_record
      create    db/migrate/30170101010107_create_country_of_origins.rb
      create    app/models/country_of_origin.rb
      invoke    test_unit
      create      test/models/country_of_origin_test.rb
      create      test/fixtures/country_of_origins.yml
      invoke  resource_route
       route    resources :country_of_origins
      invoke  scaffold_controller
      create    app/controllers/country_of_origins_controller.rb
      invoke    erb
      create      app/views/country_of_origins
      create      app/views/country_of_origins/index.html.erb
      create      app/views/country_of_origins/edit.html.erb
      create      app/views/country_of_origins/show.html.erb
      create      app/views/country_of_origins/new.html.erb
      create      app/views/country_of_origins/_form.html.erb
      invoke    test_unit
      create      test/controllers/country_of_origins_controller_test.rb
      create      test/system/country_of_origins_test.rb
      invoke    helper
      create      app/helpers/country_of_origins_helper.rb
      invoke      test_unit
      invoke    jbuilder
      create      app/views/country_of_origins/index.json.jbuilder
      create      app/views/country_of_origins/show.json.jbuilder
      create      app/views/country_of_origins/_country_of_origin.json.jbuilder
      invoke  assets
      invoke    coffee
      create      app/assets/javascripts/country_of_origins.coffee
      invoke    scss
      create      app/assets/stylesheets/country_of_origins.scss
      invoke  scss
   identical    app/assets/stylesheets/scaffolds.scss

rails g scaffold Pfeature name fdate:datetime active_status:integer sort_order:integer -f
+ rails g scaffold Pfeature name fdate:datetime active_status:integer sort_order:integer -f
      invoke  active_record
      create    db/migrate/30170101010108_create_pfeatures.rb
      create    app/models/pfeature.rb
      invoke    test_unit
      create      test/models/pfeature_test.rb
      create      test/fixtures/pfeatures.yml
      invoke  resource_route
       route    resources :pfeatures
      invoke  scaffold_controller
      create    app/controllers/pfeatures_controller.rb
      invoke    erb
      create      app/views/pfeatures
      create      app/views/pfeatures/index.html.erb
      create      app/views/pfeatures/edit.html.erb
      create      app/views/pfeatures/show.html.erb
      create      app/views/pfeatures/new.html.erb
      create      app/views/pfeatures/_form.html.erb
      invoke    test_unit
      create      test/controllers/pfeatures_controller_test.rb
      create      test/system/pfeatures_test.rb
      invoke    helper
      create      app/helpers/pfeatures_helper.rb
      invoke      test_unit
      invoke    jbuilder
      create      app/views/pfeatures/index.json.jbuilder
      create      app/views/pfeatures/show.json.jbuilder
      create      app/views/pfeatures/_pfeature.json.jbuilder
      invoke  assets
      invoke    coffee
      create      app/assets/javascripts/pfeatures.coffee
      invoke    scss
      create      app/assets/stylesheets/pfeatures.scss
      invoke  scss
   identical    app/assets/stylesheets/scaffolds.scss

rails g scaffold Product name  pcolor country_of_origin:references pdate:datetime active_status:integer sort_order:integer -f
+ rails g scaffold Product name pcolor country_of_origin:references pdate:datetime active_status:integer sort_order:integer -f
      invoke  active_record
      create    db/migrate/30170101010109_create_products.rb
      create    app/models/product.rb
      invoke    test_unit
      create      test/models/product_test.rb
      create      test/fixtures/products.yml
      invoke  resource_route
       route    resources :products
      invoke  scaffold_controller
      create    app/controllers/products_controller.rb
      invoke    erb
      create      app/views/products
      create      app/views/products/index.html.erb
      create      app/views/products/edit.html.erb
      create      app/views/products/show.html.erb
      create      app/views/products/new.html.erb
      create      app/views/products/_form.html.erb
      invoke    test_unit
      create      test/controllers/products_controller_test.rb
      create      test/system/products_test.rb
      invoke    helper
      create      app/helpers/products_helper.rb
      invoke      test_unit
      invoke    jbuilder
      create      app/views/products/index.json.jbuilder
      create      app/views/products/show.json.jbuilder
      create      app/views/products/_product.json.jbuilder
      invoke  assets
      invoke    coffee
      create      app/assets/javascripts/products.coffee
      invoke    scss
      create      app/assets/stylesheets/products.scss
      invoke  scss
   identical    app/assets/stylesheets/scaffolds.scss

rails g scaffold ProductFeature name  product:references pfeature:references active_status:integer sort_order:integer -f
+ rails g scaffold ProductFeature name product:references pfeature:references active_status:integer sort_order:integer -f
      invoke  active_record
      create    db/migrate/30170101010110_create_product_features.rb
      create    app/models/product_feature.rb
      invoke    test_unit
      create      test/models/product_feature_test.rb
      create      test/fixtures/product_features.yml
      invoke  resource_route
       route    resources :product_features
      invoke  scaffold_controller
      create    app/controllers/product_features_controller.rb
      invoke    erb
      create      app/views/product_features
      create      app/views/product_features/index.html.erb
      create      app/views/product_features/edit.html.erb
      create      app/views/product_features/show.html.erb
      create      app/views/product_features/new.html.erb
      create      app/views/product_features/_form.html.erb
      invoke    test_unit
      create      test/controllers/product_features_controller_test.rb
      create      test/system/product_features_test.rb
      invoke    helper
      create      app/helpers/product_features_helper.rb
      invoke      test_unit
      invoke    jbuilder
      create      app/views/product_features/index.json.jbuilder
      create      app/views/product_features/show.json.jbuilder
      create      app/views/product_features/_product_feature.json.jbuilder
      invoke  assets
      invoke    coffee
      create      app/assets/javascripts/product_features.coffee
      invoke    scss
      create      app/assets/stylesheets/product_features.scss
      invoke  scss
   identical    app/assets/stylesheets/scaffolds.scss



### ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

# How to add a column..
# http://stackoverflow.com/questions/22815009/add-a-reference-column-migration-in-rails-4
# rails g migration AddUserToUploads user:references

# rails g migration AddCountryOfOriginToProducts country_of_origin:references

# See howtoaddacolumn.txt in docs/

### ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


sleep 1
+ sleep 1
git add -A # Add all files and commit them
+ git add -A
git commit -m "scaffold"
+ git commit -m scaffold
[master b349f70] scaffold
 75 files changed, 1554 insertions(+), 1 deletion(-)
 create mode 100644 app/assets/javascripts/country_of_origins.coffee
 create mode 100644 app/assets/javascripts/pfeatures.coffee
 create mode 100644 app/assets/javascripts/product_features.coffee
 create mode 100644 app/assets/javascripts/products.coffee
 create mode 100644 app/assets/stylesheets/country_of_origins.scss
 create mode 100644 app/assets/stylesheets/pfeatures.scss
 create mode 100644 app/assets/stylesheets/product_features.scss
 create mode 100644 app/assets/stylesheets/products.scss
 create mode 100644 app/controllers/country_of_origins_controller.rb
 create mode 100644 app/controllers/pfeatures_controller.rb
 create mode 100644 app/controllers/product_features_controller.rb
 create mode 100644 app/controllers/products_controller.rb
 create mode 100644 app/helpers/country_of_origins_helper.rb
 create mode 100644 app/helpers/pfeatures_helper.rb
 create mode 100644 app/helpers/product_features_helper.rb
 create mode 100644 app/helpers/products_helper.rb
 create mode 100644 app/models/country_of_origin.rb
 create mode 100644 app/models/pfeature.rb
 create mode 100644 app/models/product.rb
 create mode 100644 app/models/product_feature.rb
 create mode 100644 app/views/country_of_origins/_country_of_origin.json.jbuilder
 create mode 100644 app/views/country_of_origins/_form.html.erb
 create mode 100644 app/views/country_of_origins/edit.html.erb
 create mode 100644 app/views/country_of_origins/index.html.erb
 create mode 100644 app/views/country_of_origins/index.json.jbuilder
 create mode 100644 app/views/country_of_origins/new.html.erb
 create mode 100644 app/views/country_of_origins/show.html.erb
 create mode 100644 app/views/country_of_origins/show.json.jbuilder
 create mode 100644 app/views/pfeatures/_form.html.erb
 create mode 100644 app/views/pfeatures/_pfeature.json.jbuilder
 create mode 100644 app/views/pfeatures/edit.html.erb
 create mode 100644 app/views/pfeatures/index.html.erb
 create mode 100644 app/views/pfeatures/index.json.jbuilder
 create mode 100644 app/views/pfeatures/new.html.erb
 create mode 100644 app/views/pfeatures/show.html.erb
 create mode 100644 app/views/pfeatures/show.json.jbuilder
 create mode 100644 app/views/product_features/_form.html.erb
 create mode 100644 app/views/product_features/_product_feature.json.jbuilder
 create mode 100644 app/views/product_features/edit.html.erb
 create mode 100644 app/views/product_features/index.html.erb
 create mode 100644 app/views/product_features/index.json.jbuilder
 create mode 100644 app/views/product_features/new.html.erb
 create mode 100644 app/views/product_features/show.html.erb
 create mode 100644 app/views/product_features/show.json.jbuilder
 create mode 100644 app/views/products/_form.html.erb
 create mode 100644 app/views/products/_product.json.jbuilder
 create mode 100644 app/views/products/edit.html.erb
 create mode 100644 app/views/products/index.html.erb
 create mode 100644 app/views/products/index.json.jbuilder
 create mode 100644 app/views/products/new.html.erb
 create mode 100644 app/views/products/show.html.erb
 create mode 100644 app/views/products/show.json.jbuilder
 create mode 100644 db/migrate/30170101010107_create_country_of_origins.rb
 create mode 100644 db/migrate/30170101010108_create_pfeatures.rb
 create mode 100644 db/migrate/30170101010109_create_products.rb
 create mode 100644 db/migrate/30170101010110_create_product_features.rb
 create mode 100644 test/controllers/country_of_origins_controller_test.rb
 create mode 100644 test/controllers/pfeatures_controller_test.rb
 create mode 100644 test/controllers/product_features_controller_test.rb
 create mode 100644 test/controllers/products_controller_test.rb
 create mode 100644 test/fixtures/country_of_origins.yml
 create mode 100644 test/fixtures/pfeatures.yml
 create mode 100644 test/fixtures/product_features.yml
 create mode 100644 test/fixtures/products.yml
 create mode 100644 test/models/country_of_origin_test.rb
 create mode 100644 test/models/pfeature_test.rb
 create mode 100644 test/models/product_feature_test.rb
 create mode 100644 test/models/product_test.rb
 create mode 100644 test/system/country_of_origins_test.rb
 create mode 100644 test/system/pfeatures_test.rb
 create mode 100644 test/system/product_features_test.rb
 create mode 100644 test/system/products_test.rb


### select2 for product pfeature.... ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


  source $sfil2/select2.sh  # optional
+ source ../bashrail/select2.sh
#!/usr/bin/env bash
echo ~----------~----------Startingd $HOSTNAME, pwd: `pwd`, dlr0: "$0", bashsource0: "${BASH_SOURCE[0]}", $(date +"%Y-%m-%d_%H.%M.%S")
pwd
+++ pwd
date +"%Y-%m-%d_%H.%M.%S"
+++ date +%Y-%m-%d_%H.%M.%S
++ echo '~----------~----------Startingd' vamp398, pwd: /srv/test/brails-01/brail542c17, dlr0: bashrail/1mk.sh, bashsource0: ../bashrail/select2.sh, 2020-10-25_21.48.20
~----------~----------Startingd vamp398, pwd: /srv/test/brails-01/brail542c17, dlr0: bashrail/1mk.sh, bashsource0: ../bashrail/select2.sh, 2020-10-25_21.48.20

  
### enable select2 .. ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

gem1="gem 'select2-rails'"
++ gem1='gem '\''select2-rails'\'''
echo "$gem1" >> Gemfile
++ echo 'gem '\''select2-rails'\'''
bundle
++ bundle
The git source `git://github.com/cschiewek/devise_ldap_authenticatable.git` uses the `git` protocol, which transmits data without encryption. Disable this warning with `bundle config git.allow_insecure true`, or switch to the `https` protocol to keep your data secure.
Fetching gem metadata from https://rubygems.org/..........
Fetching gem metadata from https://rubygems.org/.
Resolving dependencies...
Using rake 13.0.1
Using concurrent-ruby 1.1.7
Using i18n 1.8.5
Using minitest 5.14.2
Using thread_safe 0.3.6
Using tzinfo 1.2.7
Using activesupport 5.2.4.4
Using builder 3.2.4
Using erubi 1.9.0
Using mini_portile2 2.4.0
Using nokogiri 1.10.10
Using rails-dom-testing 2.0.3
Using crass 1.0.6
Using loofah 2.7.0
Using rails-html-sanitizer 1.3.0
Using actionview 5.2.4.4
Using rack 2.2.3
Using rack-test 1.1.0
Using actionpack 5.2.4.4
Using nio4r 2.5.4
Using websocket-extensions 0.1.5
Using websocket-driver 0.7.3
Using actioncable 5.2.4.4
Using globalid 0.4.2
Using activejob 5.2.4.4
Using mini_mime 1.0.2
Using mail 2.7.1
Using actionmailer 5.2.4.4
Using activemodel 5.2.4.4
Using activemodel-serializers-xml 1.0.2
Using arel 9.0.0
Using activerecord 5.2.4.4
Using mimemagic 0.3.5
Using marcel 0.3.3
Using activestorage 5.2.4.4
Using public_suffix 4.0.6
Using addressable 2.7.0
Using io-like 0.3.1
Using archive-zip 0.12.0
Using execjs 2.7.0
Using autoprefixer-rails 10.0.1.0
Using bcrypt 3.1.16
Using bindex 0.8.1
Using ffi 1.13.1
Using sassc 2.4.0
Using bootstrap-sass 3.4.1
Using boostrap-sass 0.0.2
Using msgpack 1.3.3
Using bootsnap 1.4.8
Using kaminari-core 1.2.1
Using kaminari-actionview 1.2.1
Using kaminari-activerecord 1.2.1
Using kaminari 1.2.1
Using bundler 1.17.2
Using method_source 1.0.0
Using thor 1.0.1
Using railties 5.2.4.4
Using sprockets 3.7.2
Using sprockets-rails 3.2.2
Using rails 5.2.4.4
Using bootstrap-kaminari-views 0.0.5
Using byebug 11.1.3
Using cancancan 3.1.0
Using regexp_parser 1.8.2
Using xpath 3.2.0
Using capybara 3.33.0
Using childprocess 3.0.0
Using chromedriver-helper 2.1.1
Using coffee-script-source 1.12.2
Using coffee-script 2.4.1
Using coffee-rails 4.2.2
Using orm_adapter 0.5.0
Using responders 3.0.1
Using warden 1.2.9
Using devise 4.7.3
Using net-ldap 0.16.3
Using devise_ldap_authenticatable 0.8.7 from git://github.com/cschiewek/devise_ldap_authenticatable.git (at HEAD@6ef2131)
Using faker 2.14.0
Using figaro 1.2.0
Using temple 0.8.2
Using tilt 2.0.10
Using haml 5.2.0
Using jbuilder 2.10.1
Using jquery-rails 4.4.0
Using jquery-ui-rails 6.0.1
Using jwt 2.2.2
Using rb-fsevent 0.10.4
Using rb-inotify 0.10.1
Using ruby_dep 1.5.0
Using listen 3.1.5
Using mysql2 0.5.3
Using nested_form 0.3.2
Using request_store 1.5.0
Using paper_trail 11.0.0
Using polyamorous 2.3.2
Using populator 1.0.0
Using puma 3.12.6
Using rack-cors 1.1.1
Using rack-pjax 1.1.0
Using remotipart 1.4.4
Using sassc-rails 2.1.2
Using rails_admin 2.0.2
Using rails_admin_material 0.2.1
Using rails_admin_mydash 0.1.8
Using ransack 2.3.2
Using rubyzip 2.3.0
Using sass-listen 4.0.0
Using sass 3.7.4
Using sass-rails 5.1.0
Fetching select2-rails 4.0.13
Installing select2-rails 4.0.13
Using selenium-webdriver 3.142.7
Using simple_form 5.0.3
Using spring 2.1.1
Using spring-watcher-listen 2.0.1
Using sqlite3 1.4.2
Using uglifier 4.2.0
Using web-console 3.7.0
Bundle complete! 38 Gemfile dependencies, 117 gems now installed.
Use `bundle info [gemname]` to see where a bundled gem is installed.

#
# add line after match...  sed -i  '/CLIENTSCRIPT="foo"/a CLIENTSCRIPT2="hello"' file
# i think 0, means only do it for the first match..
#
pattern1='class'   # changed because this is common to rails4 and rails5
++ pattern1=class
line1='  has_many :product_feature\n  has_many :pfeature, through: :product_feature\n'
++ line1='  has_many :product_feature\n  has_many :pfeature, through: :product_feature\n'
file1='app/models/product.rb'
++ file1=app/models/product.rb
sed  -i "0,/$pattern1/a $line1" $file1
++ sed -i '0,/class/a   has_many :product_feature\n  has_many :pfeature, through: :product_feature\n' app/models/product.rb
#
# sleep 1

#
pattern1='class'   # changed because this is common to rails4 and rails5
++ pattern1=class
line1='   has_many :product_feature\n   has_many :product, through: :product_feature\n'
++ line1='   has_many :product_feature\n   has_many :product, through: :product_feature\n'
file1='app/models/pfeature.rb'
++ file1=app/models/pfeature.rb
sed  -i "0,/$pattern1/a $line1" $file1
++ sed -i '0,/class/a    has_many :product_feature\n   has_many :product, through: :product_feature\n' app/models/pfeature.rb



line1='<%= f.association :pfeature %>'
++ line1='<%= f.association :pfeature %>'
patrn='f.input :name'
++ patrn='f.input :name'
sed -i  "/.*$patrn.*/a $line1" app/views/products/_form.html.erb
++ sed -i '/.*f.input :name.*/a <%= f.association :pfeature %>' app/views/products/_form.html.erb

      
# sleep 1
      
# add this.. :ptype_ids => [] ... Edit line to look like this..  params.require(:product).permit(:name, :ptype_ids => [])
# http://unix.stackexchange.com/questions/155331/sed-replace-a-character-in-a-matched-line-in-place  /ipsum/{s/#//g;s/@/-at-/g;}
# add a space before the last character in the line...   sed 's/.$/ &/' file
#
# find lines with $patrn and replace last characater with $str1)
patrn='params.require'
++ patrn=params.require
patrn='require'
++ patrn=require
str1=', :pfeature_ids=> []'
++ str1=', :pfeature_ids=> []'
file1='app/controllers/products_controller.rb'
++ file1=app/controllers/products_controller.rb
echo $patrn,  $str1,  $file1
++ echo require, , ':pfeature_ids=>' '[],' app/controllers/products_controller.rb
require, , :pfeature_ids=> [], app/controllers/products_controller.rb
sed -i   "/$patrn/{s/.$/$str1\)/}" $file1 
++ sed -i '/require/{s/.$/, :pfeature_ids=> []\)/}' app/controllers/products_controller.rb

# rev $file1 | sed "s/)/ZaZ@Z/" | rev


sleep 1
++ sleep 1

# insert lines before line matching patrn...
ln1='<p>'
++ ln1='<p>'
ln2='<% @product.pfeature.each do |v1| %>'
++ ln2='<% @product.pfeature.each do |v1| %>'
ln3='    <%= link_to v1.name, v1 %>'
++ ln3='    <%= link_to v1.name, v1 %>'
ln4='<% end %>'
++ ln4='<% end %>'
ln5='</p>'
++ ln5='</p>'
patrn='edit_product_path'
++ patrn=edit_product_path
sed -i  "/.*$patrn.*/i $ln1\n$ln2\n$ln3\n$ln4\n$ln5\n" app/views/products/show.html.erb
++ sed -i '/.*edit_product_path.*/i <p>\n<% @product.pfeature.each do |v1| %>\n    <%= link_to v1.name, v1 %>\n<% end %>\n</p>\n' app/views/products/show.html.erb

sleep 1
++ sleep 1

mkdir -p app/inputs
++ mkdir -p app/inputs
cat << 'HEREDOC' > app/inputs/collection_select_input.rb
# app/inputs/collection_select_input.rb
class CollectionSelectInput < SimpleForm::Inputs::CollectionSelectInput
  def input_html_classes
    super.push('dgselect2')
  end
end
HEREDOC
++ cat


cat << 'HEREDOC' > app/assets/javascripts/dgselect2.js
//#app/assets/javascripts/dgselect2.js
$(function() {
  $(".dgselect2").select2({
   });	
});
HEREDOC
++ cat

echo '//= require select2' >> app/assets/javascripts/application.js
++ echo '//= require select2'
 
# this gave error.. echo  '*= require select2'>> app/assets/stylesheets/application.scss
# echo  '*= require select2-bootstrap'>> app/assets/stylesheets/application.scss
#
# insert lines after line matching patrn...
ln1='\ \ \*= require select2'
++ ln1='\ \ \*= require select2'
ln2='  \*= require select2-bootstrap'
++ ln2='  \*= require select2-bootstrap'
# got error.. patrn='self'
# sed -i  "/self/a "$ln1"\n"$ln2"\n" app/assets/stylesheets/application.scss
  sed -i  "/require_self/a $ln1\n$ln2" app/assets/stylesheets/application.scss
++ sed -i '/require_self/a \ \ \*= require select2\n  \*= require select2-bootstrap' app/assets/stylesheets/application.scss


sleep 1
++ sleep 1
git add -A # Add all files and commit them
++ git add -A
git commit -m "enable select2"
++ git commit -m 'enable select2'
[master a0796ad] enable select2
 10 files changed, 30 insertions(+), 1 deletion(-)
 create mode 100644 app/assets/javascripts/dgselect2.js
 create mode 100644 app/inputs/collection_select_input.rb
 

  # commit is in  select2.sh


  source $sfil2/jqueryautocomplete.sh
+ source ../bashrail/jqueryautocomplete.sh
#!/usr/bin/env bash
echo ~----------~----------Startingd $HOSTNAME, pwd: `pwd`, dlr0: "$0", bashsource0: "${BASH_SOURCE[0]}", $(date +"%Y-%m-%d_%H.%M.%S")
pwd
+++ pwd
date +"%Y-%m-%d_%H.%M.%S"
+++ date +%Y-%m-%d_%H.%M.%S
++ echo '~----------~----------Startingd' vamp398, pwd: /srv/test/brails-01/brail542c17, dlr0: bashrail/1mk.sh, bashsource0: ../bashrail/jqueryautocomplete.sh, 2020-10-25_21.48.26
~----------~----------Startingd vamp398, pwd: /srv/test/brails-01/brail542c17, dlr0: bashrail/1mk.sh, bashsource0: ../bashrail/jqueryautocomplete.sh, 2020-10-25_21.48.26

 
 
# purpose.. 
# autocomplete  countryoforigin - name with pfeature name...
 
# copied from..  C:\n\Dropbox\csd\dg2\knowledge-csd-dg\computer\rails-know\_rails-numbered-files,like-kdgrail274\rail281-yuiautocomplete\rail281j\rail281j-mk.sh 

# rails jquery autocomplete bigtunacan
 
 ###  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

# read settings..

read  appn  sfil  sfil2  mpwd  parm0</tmp/"_brvar1202_${USER}".txt
++ read appn sfil sfil2 mpwd parm0
echo settings..
++ echo settings..
settings..
echo $appn $sfil $sfil2 $mpwd $parm0
++ echo brail542c17 bashrail ../bashrail /srv/test/brails-01 bashrail/1mk.sh /home/albe
brail542c17 bashrail ../bashrail /srv/test/brails-01 bashrail/1mk.sh /home/albe

# timeout1=5 ; read -t "${timeout1}" -p "Press ENTER or wait $timeout1 seconds..." || true ;  echo ;


###  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


# set -e will exit on first error. so set -vxe..
date ; set +vx  ; set -vx ; # echo off, then echo on
++ date
Sun Oct 25 21:48:26 EDT 2020
++ set +vx

# this works.
# 
# jquery-autocomplete  autocomplete for rails 4

# usage: 
# copy ..../rail281file/* var/share203/rail281file
# input files will be in var/share203/rail281file folder.
# cd /home/albe/share203
#       rail281file/rail281j-mk.sh
# The output will be that it creates  var/share203/rail281e/*
#
#   rail281file/rail281b2-mk.sh



# gemfile.. ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


  
echo "# https://github.com/bigtunacan/rails-jquery-autocomplete" >> Gemfile
++ echo '# https://github.com/bigtunacan/rails-jquery-autocomplete'
echo "# https://github.com/yifeiwu/rails4-autocomplete-demo" >> Gemfile
++ echo '# https://github.com/yifeiwu/rails4-autocomplete-demo'
echo "gem 'rails-jquery-autocomplete'" >> Gemfile
++ echo 'gem '\''rails-jquery-autocomplete'\'''
echo "gem 'jquery-rails'" >> Gemfile
++ echo 'gem '\''jquery-rails'\'''
echo "gem 'jquery-ui-rails'" >> Gemfile
++ echo 'gem '\''jquery-ui-rails'\'''

bundle
++ bundle
The git source `git://github.com/cschiewek/devise_ldap_authenticatable.git` uses the `git` protocol, which transmits data without encryption. Disable this warning with `bundle config git.allow_insecure true`, or switch to the `https` protocol to keep your data secure.
Fetching gem metadata from https://rubygems.org/..........
Fetching gem metadata from https://rubygems.org/.
Resolving dependencies...
Using rake 13.0.1
Using concurrent-ruby 1.1.7
Using i18n 1.8.5
Using minitest 5.14.2
Using thread_safe 0.3.6
Using tzinfo 1.2.7
Using activesupport 5.2.4.4
Using builder 3.2.4
Using erubi 1.9.0
Using mini_portile2 2.4.0
Using nokogiri 1.10.10
Using rails-dom-testing 2.0.3
Using crass 1.0.6
Using loofah 2.7.0
Using rails-html-sanitizer 1.3.0
Using actionview 5.2.4.4
Using rack 2.2.3
Using rack-test 1.1.0
Using actionpack 5.2.4.4
Using nio4r 2.5.4
Using websocket-extensions 0.1.5
Using websocket-driver 0.7.3
Using actioncable 5.2.4.4
Using globalid 0.4.2
Using activejob 5.2.4.4
Using mini_mime 1.0.2
Using mail 2.7.1
Using actionmailer 5.2.4.4
Using activemodel 5.2.4.4
Using activemodel-serializers-xml 1.0.2
Using arel 9.0.0
Using activerecord 5.2.4.4
Using mimemagic 0.3.5
Using marcel 0.3.3
Using activestorage 5.2.4.4
Using public_suffix 4.0.6
Using addressable 2.7.0
Using io-like 0.3.1
Using archive-zip 0.12.0
Using execjs 2.7.0
Using autoprefixer-rails 10.0.1.0
Using bcrypt 3.1.16
Using bindex 0.8.1
Using ffi 1.13.1
Using sassc 2.4.0
Using bootstrap-sass 3.4.1
Using boostrap-sass 0.0.2
Using msgpack 1.3.3
Using bootsnap 1.4.8
Using kaminari-core 1.2.1
Using kaminari-actionview 1.2.1
Using kaminari-activerecord 1.2.1
Using kaminari 1.2.1
Using bundler 1.17.2
Using method_source 1.0.0
Using thor 1.0.1
Using railties 5.2.4.4
Using sprockets 3.7.2
Using sprockets-rails 3.2.2
Using rails 5.2.4.4
Using bootstrap-kaminari-views 0.0.5
Using byebug 11.1.3
Using cancancan 3.1.0
Using regexp_parser 1.8.2
Using xpath 3.2.0
Using capybara 3.33.0
Using childprocess 3.0.0
Using chromedriver-helper 2.1.1
Using coffee-script-source 1.12.2
Using coffee-script 2.4.1
Using coffee-rails 4.2.2
Using orm_adapter 0.5.0
Using responders 3.0.1
Using warden 1.2.9
Using devise 4.7.3
Using net-ldap 0.16.3
Using devise_ldap_authenticatable 0.8.7 from git://github.com/cschiewek/devise_ldap_authenticatable.git (at HEAD@6ef2131)
Using faker 2.14.0
Using figaro 1.2.0
Using temple 0.8.2
Using tilt 2.0.10
Using haml 5.2.0
Using jbuilder 2.10.1
Using jquery-rails 4.4.0
Using jquery-ui-rails 6.0.1
Using jwt 2.2.2
Using rb-fsevent 0.10.4
Using rb-inotify 0.10.1
Using ruby_dep 1.5.0
Using listen 3.1.5
Using mysql2 0.5.3
Using nested_form 0.3.2
Using request_store 1.5.0
Using paper_trail 11.0.0
Using polyamorous 2.3.2
Using populator 1.0.0
Using puma 3.12.6
Using rack-cors 1.1.1
Using rack-pjax 1.1.0
Fetching rails-jquery-autocomplete 1.0.5
Installing rails-jquery-autocomplete 1.0.5
Using remotipart 1.4.4
Using sassc-rails 2.1.2
Using rails_admin 2.0.2
Using rails_admin_material 0.2.1
Using rails_admin_mydash 0.1.8
Using ransack 2.3.2
Using rubyzip 2.3.0
Using sass-listen 4.0.0
Using sass 3.7.4
Using sass-rails 5.1.0
Using select2-rails 4.0.13
Using selenium-webdriver 3.142.7
Using simple_form 5.0.3
Using spring 2.1.1
Using spring-watcher-listen 2.0.1
Using sqlite3 1.4.2
Using uglifier 4.2.0
Using web-console 3.7.0
Bundle complete! 41 Gemfile dependencies, 118 gems now installed.
Use `bundle info [gemname]` to see where a bundled gem is installed.


pwd
++ pwd
/srv/test/brails-01/brail542c17

### install .. ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

rails generate autocomplete:install
++ rails generate autocomplete:install
      create  public/javascripts/autocomplete-rails.js

 
# git add -A # Add all files and commit them
# git commit -m "three"
 
# scaffold... ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 
 
# git add -A # Add all files and commit them
# git commit -m "scaffold"



# db ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~



rake db:migrate  
++ rake db:migrate
== 30170101010107 CreateCountryOfOrigins: migrating ===========================
-- create_table(:country_of_origins)
   -> 0.0011s
== 30170101010107 CreateCountryOfOrigins: migrated (0.0020s) ==================

== 30170101010108 CreatePfeatures: migrating ==================================
-- create_table(:pfeatures)
   -> 0.0017s
== 30170101010108 CreatePfeatures: migrated (0.0018s) =========================

== 30170101010109 CreateProducts: migrating ===================================
-- create_table(:products)
   -> 0.0029s
== 30170101010109 CreateProducts: migrated (0.0036s) ==========================

== 30170101010110 CreateProductFeatures: migrating ============================
-- create_table(:product_features)
   -> 0.0046s
== 30170101010110 CreateProductFeatures: migrated (0.0049s) ===================


# cp $sfil/populate.rake lib/tasks
# rake db:populate

###

# app...js  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

#eg:  sed -i '/CLIENTSCRIPT/i \ \ CLIENTSCRIPT2' file  # add line before pattern - include leading spaces like so - escape them.. '\ '  

# old..
 sed -i '/require_tree/i//= require jquery\n//= require jquery-ui/widgets/autocomplete\n//= require autocomplete-rails'  app/assets/javascripts/application.js
++ sed -i '/require_tree/i//= require jquery\n//= require jquery-ui/widgets/autocomplete\n//= require autocomplete-rails' app/assets/javascripts/application.js


# todo
# 2019-10-02 changes.
# //= require jquery
# //= require jquery_ujs
# //= require jquery-ui/widgets/autocomplete
# //= require autocomplete-rails



# git add -A # Add all files and commit them
  # git commit -m "four"

###
  


# Asset was not declared to be precompiled in production.
# Add `Rails.application.config.assets.precompile += %w( autocomplete-rails.js )` to `config/initializers/assets.rb` and restart your server
echo 'Rails.application.config.assets.precompile += %w( autocomplete-rails.js )'>> config/initializers/assets.rb
++ echo 'Rails.application.config.assets.precompile += %w( autocomplete-rails.js )'
  

# git add -A # Add all files and commit them
  # git commit -m "five"


###
# style the autocomplete.. ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  

cat $sfil2/rails-jquery-autocomplete/dgautocomplete.scss>>app/assets/stylesheets/application.scss
++ cat ../bashrail/rails-jquery-autocomplete/dgautocomplete.scss

# git add -A # Add all files and commit them
  # git commit -m "six"
  

  

# application.html.erb  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


#    just before /head. ...
#    add...  <%= javascript_include_tag "autocomplete-rails.js" %>



###  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
# add new lines of text before patrn...
#

# cat 'app/views/pets/_form.html.erb'
# grep end 'app/views/pets/_form.html.erb'

filetarg='app/views/layouts/application.html.erb'
++ filetarg=app/views/layouts/application.html.erb
cat $filetarg
++ cat app/views/layouts/application.html.erb
<!DOCTYPE html >
<html>
  <head>
    <meta charset="utf-8">
      <meta content="IE=edge" http-equiv="X-UA-Compatible">
        <meta content="width=device-width, initial-scale=1" name="viewport">
          <title><%= Rails.application.class.parent_name %></title>
          <%= stylesheet_link_tag    'application', media: 'all' %>
          <%= javascript_include_tag 'application' %>
          <%= csrf_meta_tags %>
        </meta>
      </meta>
    </meta>
  </head>
  <body class="<%= controller.controller_name %>">
    <nav class="navbar navbar-inverse navbar-static-top" role="navigation">
      <div class="container-fluid">
        <div class="navbar-header">
          <button aria-controls="navbar" aria-expanded="false" class="navbar-toggle collapsed" data-target="#navbar" data-toggle="collapse" type="button">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <%= link_to 'Home', root_path, class: 'navbar-brand' %>
        </div>

        <div class="collapse navbar-collapse" id="navbar">
          <ul class="nav navbar-nav">
            <li>
              <!-- <%#  = link_to 'Products', products_path %> -->
            </li>
          </ul>

          <ul class="nav navbar-nav navbar-right">
            <%# views/devise/menu/_login_items.html.erb %>
            <% if user_signed_in? %>
                <li>
                  <%= link_to "Administer", rails_admin.dashboard_path, :class => "btn btn-secondary " %>
                </li>
               <li>
                  <%= link_to('Logout', destroy_user_session_path, :method => :delete) %>
                </li>
                <li class="dropdown">
                  <a class="dropdown-toggle" data-toggle="dropdown" href="#"><%= current_user.email %>,<%= current_user.name %>
                  <span class="caret"></span></a>
                  <ul class="dropdown-menu">
                    <li><a href="#">This item to be used later</a></li>
                    <li> <%#= link_to 'Users', users_path %> </li>
                    <li> <%= link_to "Edit profile", edit_user_registration_path %> </li>
                    <li><%= link_to('Logout', destroy_user_session_path, :method => :delete) %></li>
                  </ul>
                </li>
            <% else %>
                <li>
                  <%= link_to('Login', new_user_session_path)  %>
                </li>
            <% end %>
          </ul>
        </div>
      </div>
    </nav>

    <div class="container-fluid">
      <% flash.each do |type, msg| %>
        <div class="alert alert-<%= type == 'alert' ? 'danger' : 'success' %> alert-dismissable" role="alert">
          <button class="close"> .. </button>
          <%= msg if msg.is_a?(String) %>
        </div>
      <% end %>
      <%= yield %>
    </div>

  </body>
</html>
r1tmp="/tmp/_temprubyrunner_${USER}.rb"
++ r1tmp=/tmp/_temprubyrunner_albe.rb
cat << 'HEREDOC' > $r1tmp
patrn='csrf_meta'
  repl2 = %Q{
          <%= javascript_include_tag "autocomplete-rails.js" %>
  }
  ARGF.each do |line|
    puts repl2 if line =~ /#{Regexp.escape(patrn)}/
    puts line
  end
HEREDOC
++ cat
ruby $r1tmp $filetarg > $filetarg.tmp
++ ruby /tmp/_temprubyrunner_albe.rb app/views/layouts/application.html.erb
cat $filetarg.tmp
++ cat app/views/layouts/application.html.erb.tmp
<!DOCTYPE html >
<html>
  <head>
    <meta charset="utf-8">
      <meta content="IE=edge" http-equiv="X-UA-Compatible">
        <meta content="width=device-width, initial-scale=1" name="viewport">
          <title><%= Rails.application.class.parent_name %></title>
          <%= stylesheet_link_tag    'application', media: 'all' %>
          <%= javascript_include_tag 'application' %>

          <%= javascript_include_tag "autocomplete-rails.js" %>
  
          <%= csrf_meta_tags %>
        </meta>
      </meta>
    </meta>
  </head>
  <body class="<%= controller.controller_name %>">
    <nav class="navbar navbar-inverse navbar-static-top" role="navigation">
      <div class="container-fluid">
        <div class="navbar-header">
          <button aria-controls="navbar" aria-expanded="false" class="navbar-toggle collapsed" data-target="#navbar" data-toggle="collapse" type="button">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <%= link_to 'Home', root_path, class: 'navbar-brand' %>
        </div>

        <div class="collapse navbar-collapse" id="navbar">
          <ul class="nav navbar-nav">
            <li>
              <!-- <%#  = link_to 'Products', products_path %> -->
            </li>
          </ul>

          <ul class="nav navbar-nav navbar-right">
            <%# views/devise/menu/_login_items.html.erb %>
            <% if user_signed_in? %>
                <li>
                  <%= link_to "Administer", rails_admin.dashboard_path, :class => "btn btn-secondary " %>
                </li>
               <li>
                  <%= link_to('Logout', destroy_user_session_path, :method => :delete) %>
                </li>
                <li class="dropdown">
                  <a class="dropdown-toggle" data-toggle="dropdown" href="#"><%= current_user.email %>,<%= current_user.name %>
                  <span class="caret"></span></a>
                  <ul class="dropdown-menu">
                    <li><a href="#">This item to be used later</a></li>
                    <li> <%#= link_to 'Users', users_path %> </li>
                    <li> <%= link_to "Edit profile", edit_user_registration_path %> </li>
                    <li><%= link_to('Logout', destroy_user_session_path, :method => :delete) %></li>
                  </ul>
                </li>
            <% else %>
                <li>
                  <%= link_to('Login', new_user_session_path)  %>
                </li>
            <% end %>
          </ul>
        </div>
      </div>
    </nav>

    <div class="container-fluid">
      <% flash.each do |type, msg| %>
        <div class="alert alert-<%= type == 'alert' ? 'danger' : 'success' %> alert-dismissable" role="alert">
          <button class="close"> .. </button>
          <%= msg if msg.is_a?(String) %>
        </div>
      <% end %>
      <%= yield %>
    </div>

  </body>
</html>
cp $filetarg.tmp $filetarg; rm $filetarg.tmp
++ cp app/views/layouts/application.html.erb.tmp app/views/layouts/application.html.erb
++ rm app/views/layouts/application.html.erb.tmp


###  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

# end  application.html.erb  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


  
  

  
  
  
#app specific .. ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
#app specific .. ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
#app specific .. ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~



  
cp $sfil2/rails-jquery-autocomplete/countryoforigin_jq_ac.js app/assets/javascripts
++ cp ../bashrail/rails-jquery-autocomplete/countryoforigin_jq_ac.js app/assets/javascripts

 
  
  
  
#controller.. ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~



# add this lines after match in controller....
  # class ProductsController < Admin::BaseController
    # ..this line..  autocomplete :type, :name
  # end  
#
  #eg:  sed -i '/CLIENTSCRIPT/i \ \ CLIENTSCRIPT2' file  # add line before pattern - include leading spaces like so - escape them.. '\ '  
  
line1='  autocomplete :pfeature, :name, :full => true'
++ line1='  autocomplete :pfeature, :name, :full => true'
sed -i "/before_action/a  \  #\n$line1\n"  app/controllers/country_of_origins_controller.rb 
++ sed -i '/before_action/a  \  #\n  autocomplete :pfeature, :name, :full => true\n' app/controllers/country_of_origins_controller.rb
  

  
#routes.. ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~



  # resources :products do
    # get :autocomplete_type_name, :on => :collection
  # end  

pattern1='resources :country_of_origins'
++ pattern1='resources :country_of_origins'
line1='  resources :country_of_origins do'
++ line1='  resources :country_of_origins do'
line2='    get :autocomplete_pfeature_name, :on => :collection'
++ line2='    get :autocomplete_pfeature_name, :on => :collection'
line3='  end'
++ line3='  end'
offline__line4='  root "country_of_origins#index"'
++ offline__line4='  root "country_of_origins#index"'
#  stackoverflow.com/questions/148451/how-to-use-sed-to-replace-only-the-first-occurrence-in-a-file
# replace the entire line matching pattern1...
  # sed  -i "0,/$pattern1/s/.*$pattern1.*/#\n$line1\n$line2\n$line3\n$line4\n/" config/routes.rb 
  sed  -i "0,/$pattern1/s/.*$pattern1.*/#\n$line1\n$line2\n$line3\n/" config/routes.rb 
++ sed -i '0,/resources :country_of_origins/s/.*resources :country_of_origins.*/#\n  resources :country_of_origins do\n    get :autocomplete_pfeature_name, :on => :collection\n  end\n/' config/routes.rb
 
 
# view.. ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~



  # f.autocomplete_field :type_name, autocomplete_type_name_products_path 
    # was.. <%= f.text_field :type1 %>
#
# multiple autocomplete... use this option... 'data-delimiter' => ','
#
pattern1='f.text_field :ctype'
++ pattern1='f.text_field :ctype'
# for multiple autocomplete..
# line1='   <%= f.autocomplete_field :ctype, autocomplete_country_of_origin_products_path, \"data-delimiter\" => \", \" %>'  
#
line1="   <%= f.autocomplete_field :ctype, autocomplete_pfeature_name_country_of_origins_path , \'min-length\' => 1 , \'data-auto-focus\' => true %>"
++ line1='   <%= f.autocomplete_field :ctype, autocomplete_pfeature_name_country_of_origins_path , \'\''min-length\'\'' => 1 , \'\''data-auto-focus\'\'' => true %>'
  sed  -i "0,/$pattern1/s/.*$pattern1.*/$line1\n/" app/views/country_of_origins/_form.html.erb
++ sed -i '0,/f.text_field :ctype/s/.*f.text_field :ctype.*/   <%= f.autocomplete_field :ctype, autocomplete_pfeature_name_country_of_origins_path , \'\''min-length\'\'' => 1 , \'\''data-auto-focus\'\'' => true %>\n/' app/views/country_of_origins/_form.html.erb




# finish up.. ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  
pwd   
++ pwd
/srv/test/brails-01/brail542c17
echo  '----------------------------------------> Successfully Reached end of file!!!'
++ echo '----------------------------------------> Successfully Reached end of file!!!'
----------------------------------------> Successfully Reached end of file!!!
echo  run rails s
++ echo run rails s
run rails s
echo  then visit localhost:3000/products
++ echo then visit localhost:3000/products
then visit localhost:3000/products
date
++ date
Sun Oct 25 21:48:33 EDT 2020
#

  source $sfil2/jqueryautocomplete_pcolor.sh
+ source ../bashrail/jqueryautocomplete_pcolor.sh
#!/usr/bin/env bash
echo ~----------~----------Startingd $HOSTNAME, pwd: `pwd`, dlr0: "$0", bashsource0: "${BASH_SOURCE[0]}", $(date +"%Y-%m-%d_%H.%M.%S")
pwd
+++ pwd
date +"%Y-%m-%d_%H.%M.%S"
+++ date +%Y-%m-%d_%H.%M.%S
++ echo '~----------~----------Startingd' vamp398, pwd: /srv/test/brails-01/brail542c17, dlr0: bashrail/1mk.sh, bashsource0: ../bashrail/jqueryautocomplete_pcolor.sh, 2020-10-25_21.48.33
~----------~----------Startingd vamp398, pwd: /srv/test/brails-01/brail542c17, dlr0: bashrail/1mk.sh, bashsource0: ../bashrail/jqueryautocomplete_pcolor.sh, 2020-10-25_21.48.33

 
 
# purpose.. 
# autocomplete  countryoforigin - name with pfeature name...
 
# copied from..  C:\n\Dropbox\csd\dg2\knowledge-csd-dg\computer\rails-know\_rails-numbered-files,like-kdgrail274\rail281-yuiautocomplete\rail281j\rail281j-mk.sh 

# rails jquery autocomplete bigtunacan
 
 ###  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

# read settings..

read  appn  sfil  sfil2  mpwd  parm0</tmp/"_brvar1202_${USER}".txt
++ read appn sfil sfil2 mpwd parm0
echo settings..
++ echo settings..
settings..
echo $appn $sfil $sfil2 $mpwd $parm0
++ echo brail542c17 bashrail ../bashrail /srv/test/brails-01 bashrail/1mk.sh /home/albe
brail542c17 bashrail ../bashrail /srv/test/brails-01 bashrail/1mk.sh /home/albe

# timeout1=5 ; read -t "${timeout1}" -p "Press ENTER or wait $timeout1 seconds..." || true ;  echo ;


###  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


# set -e will exit on first error. so set -vxe..
date ; set +vx  ; set -vx ; # echo off, then echo on
++ date
Sun Oct 25 21:48:33 EDT 2020
++ set +vx

# this works.
# 
# jquery-autocomplete  autocomplete for rails 4

# usage: 
# copy ..../rail281file/* var/share203/rail281file
# input files will be in var/share203/rail281file folder.
# cd /home/albe/share203
#       rail281file/rail281j-mk.sh
# The output will be that it creates  var/share203/rail281e/*
#
#   rail281file/rail281b2-mk.sh



# ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




#              this depends on the first jqueryautocomplete.sh




# ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~





  
  
#app specific .. ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
#app specific .. ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
#app specific .. ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




r1="app/assets/javascripts/products_ac.js"
++ r1=app/assets/javascripts/products_ac.js
cat << 'HEREDOC' > $r1
$(function() {
  
  // run when eventlistener is triggered
  // http://stackoverflow.com/questions/6431459/jquery-autocomplete-trigger-change-event
  //
  $("#product_pcolor").on( "autocompletechange", function(event,data) {
     // post value to console for validation
     console.log("Item is: ", $(this).val());

    // if item user typed in the input box is not in the list of suggestions, it will be cleared out. The user must select an item.
    if (!data.item) {
        this.value = '';
        console.log('> Item selected is:', data.item);
        }
        
    });   
    console.log ("msg.. 1012")  
});
HEREDOC
++ cat


  
  
  
#controller.. ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~



# add this lines after match in controller....
  # class ProductsController < Admin::BaseController
    # ..this line..  autocomplete :type, :name
  # end  
  #eg:  sed -i '/CLIENTSCRIPT/i \ \ CLIENTSCRIPT2' file  # add line before pattern - include leading spaces like so - escape them.. '\ '  
  

line1='  autocomplete :pfeature, :name, :full => true'
++ line1='  autocomplete :pfeature, :name, :full => true'
sed -i "/before_action/a  \  #\n$line1\n"  app/controllers/products_controller.rb 
++ sed -i '/before_action/a  \  #\n  autocomplete :pfeature, :name, :full => true\n' app/controllers/products_controller.rb
  


  
#routes.. ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 

  # resources :products do
    # get :autocomplete_type_name, :on => :collection
  # end  
pattern1='resources :products'
++ pattern1='resources :products'
line1='  resources :products do'
++ line1='  resources :products do'
line2='    get :autocomplete_pfeature_name, :on => :collection'
++ line2='    get :autocomplete_pfeature_name, :on => :collection'
line3='  end'
++ line3='  end'
line4='  root "products#index"'
++ line4='  root "products#index"'
# x x sed -i "/resources :products/a  \  #\n$line1\n$line2\n$line3\n"  config/routes.rb
# sed '0,/pattern/s/pattern/replacement/' filename  ##  stackoverflow.com/questions/148451/how-to-use-sed-to-replace-only-the-first-occurrence-in-a-file
# replace the entire line matching pattern1...
# sed  -i "0,/$pattern1/s/.*$pattern1.*/#\n$line1\n$line2\n$line3\n$line4\n/" config/routes.rb 
  sed  -i "0,/$pattern1/s/.*$pattern1.*/#\n$line1\n$line2\n$line3\n/" config/routes.rb 
++ sed -i '0,/resources :products/s/.*resources :products.*/#\n  resources :products do\n    get :autocomplete_pfeature_name, :on => :collection\n  end\n/' config/routes.rb
 



# view.. ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~



  # f.autocomplete_field :type_name, autocomplete_type_name_products_path 
    # was.. <%= f.text_field :type1 %>
#
# multiple autocomplete... use this option... 'data-delimiter' => ','
#
pattern1='f.text_field :pcolor'
++ pattern1='f.text_field :pcolor'
file21=app/views/products/_form.html.erb
++ file21=app/views/products/_form.html.erb
if ! grep -q "${pattern1}" $file21 ; then 
  echo nogrep ~164 ; sleep 9 ; exit 9 ; 
fi
++ grep -q 'f.text_field :pcolor' app/views/products/_form.html.erb
#line1='   <%= form.autocomplete_field :type_name, autocomplete_type_name_products_path , \'min-length\' => 1 , \'data-auto-focus\' => true %>'  
line1="   <%= f.autocomplete_field :pcolor, autocomplete_pfeature_name_products_path , \'min-length\' => 1 , \'data-auto-focus\' => true %>"
++ line1='   <%= f.autocomplete_field :pcolor, autocomplete_pfeature_name_products_path , \'\''min-length\'\'' => 1 , \'\''data-auto-focus\'\'' => true %>'
  sed  -i "0,/$pattern1/s/.*$pattern1.*/$line1\n/" $file21
++ sed -i '0,/f.text_field :pcolor/s/.*f.text_field :pcolor.*/   <%= f.autocomplete_field :pcolor, autocomplete_pfeature_name_products_path , \'\''min-length\'\'' => 1 , \'\''data-auto-focus\'\'' => true %>\n/' app/views/products/_form.html.erb








# finish up.. ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  
pwd   
++ pwd
/srv/test/brails-01/brail542c17
echo  '----------------------------------------> Successfully Reached end of file!!!'
++ echo '----------------------------------------> Successfully Reached end of file!!!'
----------------------------------------> Successfully Reached end of file!!!
echo  run rails s
++ echo run rails s
run rails s
echo  then visit localhost:3000/products
++ echo then visit localhost:3000/products
then visit localhost:3000/products
date
++ date
Sun Oct 25 21:48:33 EDT 2020
#


  
sleep 1
+ sleep 1
git add -A # Add all files and commit them
+ git add -A
  git commit -m "jquery-autocomplete-bigtunacan"
+ git commit -m jquery-autocomplete-bigtunacan
[master 048b7ef] jquery-autocomplete-bigtunacan
 15 files changed, 197 insertions(+), 5 deletions(-)
 create mode 100644 app/assets/javascripts/countryoforigin_jq_ac.js
 create mode 100644 app/assets/javascripts/products_ac.js
 create mode 100644 public/javascripts/autocomplete-rails.js
 


  source $sfil2/activestorage.sh
+ source ../bashrail/activestorage.sh
#!/usr/bin/env bash
echo ~----------~----------Startingd $HOSTNAME, pwd: `pwd`, dlr0: "$0", bashsource0: "${BASH_SOURCE[0]}", $(date +"%Y-%m-%d_%H.%M.%S")
pwd
+++ pwd
date +"%Y-%m-%d_%H.%M.%S"
+++ date +%Y-%m-%d_%H.%M.%S
++ echo '~----------~----------Startingd' vamp398, pwd: /srv/test/brails-01/brail542c17, dlr0: bashrail/1mk.sh, bashsource0: ../bashrail/activestorage.sh, 2020-10-25_21.48.34
~----------~----------Startingd vamp398, pwd: /srv/test/brails-01/brail542c17, dlr0: bashrail/1mk.sh, bashsource0: ../bashrail/activestorage.sh, 2020-10-25_21.48.34


###  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~



# Summary:


# This depends on jq autocomplete



###  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

# read settings..

read  appn  sfil  sfil2  mpwd  parm0</tmp/"_brvar1202_${USER}".txt
++ read appn sfil sfil2 mpwd parm0
echo $appn $sfil $sfil2 $mpwd $parm0
++ echo brail542c17 bashrail ../bashrail /srv/test/brails-01 bashrail/1mk.sh /home/albe
brail542c17 bashrail ../bashrail /srv/test/brails-01 bashrail/1mk.sh /home/albe

# timeout1=5 ; read -t "${timeout1}" -p "Press ENTER or wait $timeout1 seconds..." || true ;  echo ;


###  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

# If not installed, install imagemagick
#   sudo apt -y install imagemagick

bin/rails active_storage:install
++ bin/rails active_storage:install
Copied migration 30170101010111_create_active_storage_tables.active_storage.rb from active_storage
  

rails db:migrate RAILS_ENV=development
++ rails db:migrate RAILS_ENV=development
== 30170101010111 CreateActiveStorageTables: migrating ========================
-- create_table(:active_storage_blobs)
   -> 0.0019s
-- create_table(:active_storage_attachments)
   -> 0.0024s
== 30170101010111 CreateActiveStorageTables: migrated (0.0047s) ===============



sleep 1
++ sleep 1
git add -A # Add all files and commit them
++ git add -A
git commit -m "activestorage1"
++ git commit -m activestorage1
[master e8bccc0] activestorage1
 2 files changed, 49 insertions(+), 1 deletion(-)
 create mode 100644 db/migrate/30170101010111_create_active_storage_tables.active_storage.rb



###  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


echo "# " >> Gemfile
++ echo '# '
echo "gem 'mini_magick'">> Gemfile
++ echo 'gem '\''mini_magick'\'''

bundle update
++ bundle update
The git source `git://github.com/cschiewek/devise_ldap_authenticatable.git` uses the `git` protocol, which transmits data without encryption. Disable this warning with `bundle config git.allow_insecure true`, or switch to the `https` protocol to keep your data secure.
Fetching git://github.com/cschiewek/devise_ldap_authenticatable.git
Fetching gem metadata from https://rubygems.org/..........
Fetching gem metadata from https://rubygems.org/.
Resolving dependencies........
Using rake 13.0.1
Using concurrent-ruby 1.1.7
Using i18n 1.8.5
Using minitest 5.14.2
Using thread_safe 0.3.6
Using tzinfo 1.2.7
Using activesupport 5.2.4.4
Using builder 3.2.4
Using erubi 1.9.0
Using mini_portile2 2.4.0
Using nokogiri 1.10.10
Using rails-dom-testing 2.0.3
Using crass 1.0.6
Using loofah 2.7.0
Using rails-html-sanitizer 1.3.0
Using actionview 5.2.4.4
Using rack 2.2.3
Using rack-test 1.1.0
Using actionpack 5.2.4.4
Using nio4r 2.5.4
Using websocket-extensions 0.1.5
Using websocket-driver 0.7.3
Using actioncable 5.2.4.4
Using globalid 0.4.2
Using activejob 5.2.4.4
Using mini_mime 1.0.2
Using mail 2.7.1
Using actionmailer 5.2.4.4
Using activemodel 5.2.4.4
Using activemodel-serializers-xml 1.0.2
Using arel 9.0.0
Using activerecord 5.2.4.4
Using mimemagic 0.3.5
Using marcel 0.3.3
Using activestorage 5.2.4.4
Using public_suffix 4.0.6
Using addressable 2.7.0
Using io-like 0.3.1
Using archive-zip 0.12.0
Using execjs 2.7.0
Using autoprefixer-rails 10.0.1.0
Using bcrypt 3.1.16
Using bindex 0.8.1
Using ffi 1.13.1
Using sassc 2.4.0
Using bootstrap-sass 3.4.1
Using boostrap-sass 0.0.2
Using msgpack 1.3.3
Using bootsnap 1.4.8
Using kaminari-core 1.2.1
Using kaminari-actionview 1.2.1
Using kaminari-activerecord 1.2.1
Using kaminari 1.2.1
Using bundler 1.17.2
Using method_source 1.0.0
Using thor 1.0.1
Using railties 5.2.4.4
Using sprockets 3.7.2
Using sprockets-rails 3.2.2
Using rails 5.2.4.4
Using bootstrap-kaminari-views 0.0.5
Using byebug 11.1.3
Using cancancan 3.1.0
Using regexp_parser 1.8.2
Using xpath 3.2.0
Using capybara 3.33.0
Using childprocess 3.0.0
Using chromedriver-helper 2.1.1
Using coffee-script-source 1.12.2
Using coffee-script 2.4.1
Using coffee-rails 4.2.2
Using orm_adapter 0.5.0
Using responders 3.0.1
Using warden 1.2.9
Using devise 4.7.3
Using net-ldap 0.16.3
Using devise_ldap_authenticatable 0.8.7 from git://github.com/cschiewek/devise_ldap_authenticatable.git (at HEAD@6ef2131)
Using faker 2.14.0
Using figaro 1.2.0
Using temple 0.8.2
Using tilt 2.0.10
Using haml 5.2.0
Using jbuilder 2.10.1
Using jquery-rails 4.4.0
Using jquery-ui-rails 6.0.1
Using jwt 2.2.2
Using rb-fsevent 0.10.4
Using rb-inotify 0.10.1
Using ruby_dep 1.5.0
Using listen 3.1.5
Fetching mini_magick 4.10.1
Installing mini_magick 4.10.1
Using mysql2 0.5.3
Using nested_form 0.3.2
Using request_store 1.5.0
Using paper_trail 11.0.0
Using polyamorous 2.3.2
Using populator 1.0.0
Using puma 3.12.6
Using rack-cors 1.1.1
Using rack-pjax 1.1.0
Using rails-jquery-autocomplete 1.0.5
Using remotipart 1.4.4
Using sassc-rails 2.1.2
Using rails_admin 2.0.2
Using rails_admin_material 0.2.1
Using rails_admin_mydash 0.1.8
Using ransack 2.3.2
Using rubyzip 2.3.0
Using sass-listen 4.0.0
Using sass 3.7.4
Using sass-rails 5.1.0
Using select2-rails 4.0.13
Using selenium-webdriver 3.142.7
Using simple_form 5.0.3
Using spring 2.1.1
Using spring-watcher-listen 2.0.1
Using sqlite3 1.4.2
Using uglifier 4.2.0
Using web-console 3.7.0
Bundle updated!

sleep 1
++ sleep 1
git add -A # Add all files and commit them
++ git add -A
git commit -m "activestorage gemfile"
++ git commit -m 'activestorage gemfile'
[master 46a6056] activestorage gemfile
 2 files changed, 4 insertions(+)


###  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

# model..


###  ~~
# add new lines of text after patrn...
#
filetarg='app/models/country_of_origin.rb'
++ filetarg=app/models/country_of_origin.rb
cat $filetarg
++ cat app/models/country_of_origin.rb
class CountryOfOrigin < ApplicationRecord
end
r1tmp="/tmp/_temprubyrunner_${USER}.rb"
++ r1tmp=/tmp/_temprubyrunner_albe.rb
cat << 'HEREDOC' > $r1tmp
patrn='class'
  repl2 = %Q{
    has_one_attached :avatar
    has_many_attached :documents
  }
  ARGF.each do |line|
    puts line
    puts repl2 if line =~ /#{Regexp.escape(patrn)}/
  end
HEREDOC
++ cat
ruby $r1tmp $filetarg > $filetarg.tmp ; cat $filetarg.tmp ; cp $filetarg.tmp $filetarg; rm $filetarg.tmp
++ ruby /tmp/_temprubyrunner_albe.rb app/models/country_of_origin.rb
++ cat app/models/country_of_origin.rb.tmp
class CountryOfOrigin < ApplicationRecord

    has_one_attached :avatar
    has_many_attached :documents
  
end
++ cp app/models/country_of_origin.rb.tmp app/models/country_of_origin.rb
++ rm app/models/country_of_origin.rb.tmp




###  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


# _form

# 7. Add input fields to app/views/country_of_origins/_form.html.erb:

   # class="actions"


###  ~~~~
# add new lines of text n lines after patrn...
#
filetarg='app/views/country_of_origins/_form.html.erb'
++ filetarg=app/views/country_of_origins/_form.html.erb
cat $filetarg
++ cat app/views/country_of_origins/_form.html.erb

<%= form_for(@country_of_origin, html: { class: "form-horizontal", role: "form" }) do |f| %>
  <% if @country_of_origin.errors.any? %>
    <div class="alert alert-danger alert-dismissable" role="alert">
      <button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
      <h4><%= pluralize(@country_of_origin.errors.count, "error") %> prohibited this country_of_origin from being saved:</h4>
      <ul>
      <% @country_of_origin.errors.full_messages.each do |msg| %>
        <li><%= msg %></li>
      <% end %>
      </ul>
    </div>
  <% end %>
  
  <div class="form-group">
            <%= f.label :name, class: "col-sm-2 control-label" %>
        <div class="col-sm-10">
        <%= f.text_field :name, class: "form-control" %>
      </div>
        </div>
  <div class="form-group">
            <%= f.label :ctype, class: "col-sm-2 control-label" %>
        <div class="col-sm-10">
   <%= f.autocomplete_field :ctype, autocomplete_pfeature_name_country_of_origins_path , 'min-length' => 1 , 'data-auto-focus' => true %>

      </div>
        </div>
  <div class="form-group">
            <%= f.label :fdate, class: "col-sm-2 control-label" %>
        <div class="col-sm-10">
        <%= f.datetime_select :fdate, class: "form-control" %>
      </div>
        </div>
  <div class="form-group">
            <%= f.label :active_status, class: "col-sm-2 control-label" %>
        <div class="col-sm-10">
        <%= f.number_field :active_status, class: "form-control" %>
      </div>
        </div>
  <div class="form-group">
            <%= f.label :sort_order, class: "col-sm-2 control-label" %>
        <div class="col-sm-10">
        <%= f.number_field :sort_order, class: "form-control" %>
      </div>
        </div>

  <div class="form-group">
    <div class="col-sm-offset-2 col-sm-10">
      <%= f.submit class: "btn btn-primary" %>
    </div>
  </div>
<% end %>
r1tmp="/tmp/_temprubyrunner_${USER}.rb"
++ r1tmp=/tmp/_temprubyrunner_albe.rb
cat << 'HEREDOC' > $r1tmp
patrn='f.number_field :sort_order' 
  repl2 = %Q{
  <hr>
  <div class="field">
    <%= f.label :avatar %>
    <p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (A new choice will replace previous one.)</p>
    <%= f.file_field :avatar %>
  </div>
  <br>
  <div class="field">
  <%= f.label :documents %>
    <p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (Choosing files will add to previous ones..)</p>
    <%= f.file_field :documents, multiple: true %>
  </div>
  <hr>
  }
  i=-2
  ARGF.each_with_index do |line, ndx| 
    puts line
    if line =~ /#{Regexp.escape(patrn)}/
      i = ndx + 2
    end
    if ndx == i
        puts repl2 
    end 
  end
HEREDOC
++ cat
ruby $r1tmp $filetarg > $filetarg.tmp ; cat $filetarg.tmp ; cp $filetarg.tmp $filetarg; rm $filetarg.tmp
++ ruby /tmp/_temprubyrunner_albe.rb app/views/country_of_origins/_form.html.erb
++ cat app/views/country_of_origins/_form.html.erb.tmp

<%= form_for(@country_of_origin, html: { class: "form-horizontal", role: "form" }) do |f| %>
  <% if @country_of_origin.errors.any? %>
    <div class="alert alert-danger alert-dismissable" role="alert">
      <button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
      <h4><%= pluralize(@country_of_origin.errors.count, "error") %> prohibited this country_of_origin from being saved:</h4>
      <ul>
      <% @country_of_origin.errors.full_messages.each do |msg| %>
        <li><%= msg %></li>
      <% end %>
      </ul>
    </div>
  <% end %>
  
  <div class="form-group">
            <%= f.label :name, class: "col-sm-2 control-label" %>
        <div class="col-sm-10">
        <%= f.text_field :name, class: "form-control" %>
      </div>
        </div>
  <div class="form-group">
            <%= f.label :ctype, class: "col-sm-2 control-label" %>
        <div class="col-sm-10">
   <%= f.autocomplete_field :ctype, autocomplete_pfeature_name_country_of_origins_path , 'min-length' => 1 , 'data-auto-focus' => true %>

      </div>
        </div>
  <div class="form-group">
            <%= f.label :fdate, class: "col-sm-2 control-label" %>
        <div class="col-sm-10">
        <%= f.datetime_select :fdate, class: "form-control" %>
      </div>
        </div>
  <div class="form-group">
            <%= f.label :active_status, class: "col-sm-2 control-label" %>
        <div class="col-sm-10">
        <%= f.number_field :active_status, class: "form-control" %>
      </div>
        </div>
  <div class="form-group">
            <%= f.label :sort_order, class: "col-sm-2 control-label" %>
        <div class="col-sm-10">
        <%= f.number_field :sort_order, class: "form-control" %>
      </div>
        </div>

  <hr>
  <div class="field">
    <%= f.label :avatar %>
    <p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (A new choice will replace previous one.)</p>
    <%= f.file_field :avatar %>
  </div>
  <br>
  <div class="field">
  <%= f.label :documents %>
    <p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (Choosing files will add to previous ones..)</p>
    <%= f.file_field :documents, multiple: true %>
  </div>
  <hr>
  

  <div class="form-group">
    <div class="col-sm-offset-2 col-sm-10">
      <%= f.submit class: "btn btn-primary" %>
    </div>
  </div>
<% end %>
++ cp app/views/country_of_origins/_form.html.erb.tmp app/views/country_of_origins/_form.html.erb
++ rm app/views/country_of_origins/_form.html.erb.tmp


###  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


###  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

# controllers


# this one isn't needed
#
# add new lines of text after patrn...
#
# filetarg='app/controllers/country_of_origins_controller.rb'
# cat $filetarg
# r1tmp="/tmp/_temprubyrunner_${USER}.rb"
# cat << 'HEREDOC' > $r1tmp
# patrn='if @country_of_origin.save'
#   repl2 = %Q{
    
#         avatar = params[:country_of_origin][:avatar]
#         documents = params[:country_of_origin][:documents]

#         if avatar
#           @country_of_origin.avatar.attach(avatar)
#         end
#         if documents
#           @country_of_origin.documents.attach(documents)
#         end
#         }
#   ARGF.each do |line|
#     puts line
#     puts repl2 if line =~ /#{Regexp.escape(patrn)}/
#   end
# HEREDOC
# ruby $r1tmp $filetarg > $filetarg.tmp ; cat $filetarg.tmp ; cp $filetarg.tmp $filetarg; rm $filetarg.tmp



# edit whitelist..
# original..      params.require(:country_of_origin).permit(:name, :pdate, :active_status, :sort)
filetarg='app/controllers/country_of_origins_controller.rb'
++ filetarg=app/controllers/country_of_origins_controller.rb
sed -i '/params.require/s/)$/, :avatar)/' $filetarg
++ sed -i '/params.require/s/)$/, :avatar)/' app/controllers/country_of_origins_controller.rb
sed -i '/params.require/s/)$/, documents: [])/' $filetarg
++ sed -i '/params.require/s/)$/, documents: [])/' app/controllers/country_of_origins_controller.rb



# add new lines of text before patrn...
#
filetarg='app/controllers/country_of_origins_controller.rb'
++ filetarg=app/controllers/country_of_origins_controller.rb
cat $filetarg
++ cat app/controllers/country_of_origins_controller.rb
class CountryOfOriginsController < ApplicationController
before_action :authenticate_user!
  #
  autocomplete :pfeature, :name, :full => true


  #cancancan
  load_and_authorize_resource
  # before_action :set_country_of_origin, only: [:show, :edit, :update, :destroy]
  #
  autocomplete :pfeature, :name, :full => true


  #cancancan
  load_and_authorize_resource

  #cancancan
  load_and_authorize_resource


  # cancancan..
  #load_and_authorize_resource :country_of_origin

  # GET /country_of_origins
  def index
    @q = @country_of_origins.search params[:q]
    @country_of_origins = @q.result.page(params[:page])
  end

  # GET /country_of_origins/1
  def show
  end

  # GET /country_of_origins/new
  def new
  end

  # GET /country_of_origins/1/edit
  def edit
  end

  # POST /country_of_origins
  def create
    respond_to do |format|
      if @country_of_origin.save
        format.html { redirect_to @country_of_origin, notice: t('success_create') }
        format.json { render :show, status: :created, location: @country_of_origin }
      else
        format.html { render :new }
        format.json { render json: @country_of_origin.errors, status: :unprocessable_entity }
      end
    end
  end

  # PATCH/PUT /country_of_origins/1
  def update
    respond_to do |format|
      if @country_of_origin.update(country_of_origin_params)
        format.html { redirect_to @country_of_origin, notice: t('success_update') }
        format.json { render :show, status: :ok, location: @country_of_origin }
      else
        format.html { render :edit }
        format.json { render json: @country_of_origin.errors, status: :unprocessable_entity }
      end
    end
  end

  # DELETE /country_of_origins/1
  def destroy
    @country_of_origin.destroy
    respond_to do |format|
      format.html { redirect_to country_of_origins_url, notice: t('success_destroy') }
      format.json { head :no_content }
    end
  end

  private

  # Only allow a trusted parameter "white list" through.
  def country_of_origin_params
    params.require(:country_of_origin).permit(:name, :ctype, :fdate, :active_status, :sort_order, :avatar, documents: [])
  end
end
r1tmp="/tmp/_temprubyrunner_${USER}.rb"
++ r1tmp=/tmp/_temprubyrunner_albe.rb
cat << 'HEREDOC' > $r1tmp
patrn='private'
  repl2 = %Q{
    
    def delete_document_attachment
        @document = ActiveStorage::Attachment.find(params[:id])
        @document.purge
        # redirect_to @current_page
        redirect_back(fallback_location: root_path)     
    end

    }
  ARGF.each do |line|
    puts repl2 if line =~ /#{Regexp.escape(patrn)}/
    puts line
  end
HEREDOC
++ cat
ruby $r1tmp $filetarg > $filetarg.tmp ; cat $filetarg.tmp ; cp $filetarg.tmp $filetarg; rm $filetarg.tmp
++ ruby /tmp/_temprubyrunner_albe.rb app/controllers/country_of_origins_controller.rb
++ cat app/controllers/country_of_origins_controller.rb.tmp
class CountryOfOriginsController < ApplicationController
before_action :authenticate_user!
  #
  autocomplete :pfeature, :name, :full => true


  #cancancan
  load_and_authorize_resource
  # before_action :set_country_of_origin, only: [:show, :edit, :update, :destroy]
  #
  autocomplete :pfeature, :name, :full => true


  #cancancan
  load_and_authorize_resource

  #cancancan
  load_and_authorize_resource


  # cancancan..
  #load_and_authorize_resource :country_of_origin

  # GET /country_of_origins
  def index
    @q = @country_of_origins.search params[:q]
    @country_of_origins = @q.result.page(params[:page])
  end

  # GET /country_of_origins/1
  def show
  end

  # GET /country_of_origins/new
  def new
  end

  # GET /country_of_origins/1/edit
  def edit
  end

  # POST /country_of_origins
  def create
    respond_to do |format|
      if @country_of_origin.save
        format.html { redirect_to @country_of_origin, notice: t('success_create') }
        format.json { render :show, status: :created, location: @country_of_origin }
      else
        format.html { render :new }
        format.json { render json: @country_of_origin.errors, status: :unprocessable_entity }
      end
    end
  end

  # PATCH/PUT /country_of_origins/1
  def update
    respond_to do |format|
      if @country_of_origin.update(country_of_origin_params)
        format.html { redirect_to @country_of_origin, notice: t('success_update') }
        format.json { render :show, status: :ok, location: @country_of_origin }
      else
        format.html { render :edit }
        format.json { render json: @country_of_origin.errors, status: :unprocessable_entity }
      end
    end
  end

  # DELETE /country_of_origins/1
  def destroy
    @country_of_origin.destroy
    respond_to do |format|
      format.html { redirect_to country_of_origins_url, notice: t('success_destroy') }
      format.json { head :no_content }
    end
  end


    
    def delete_document_attachment
        @document = ActiveStorage::Attachment.find(params[:id])
        @document.purge
        # redirect_to @current_page
        redirect_back(fallback_location: root_path)     
    end

    
  private

  # Only allow a trusted parameter "white list" through.
  def country_of_origin_params
    params.require(:country_of_origin).permit(:name, :ctype, :fdate, :active_status, :sort_order, :avatar, documents: [])
  end
end
++ cp app/controllers/country_of_origins_controller.rb.tmp app/controllers/country_of_origins_controller.rb
++ rm app/controllers/country_of_origins_controller.rb.tmp



###  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


# edit routes


# if  `resources :country_of_origins do` found, then - add - to the stanza.
# if  `resources :country_of_origins` found, then  - replace -   the stanza.



pattern1='resources :country_of_origins do'
++ pattern1='resources :country_of_origins do'
filetarg='config/routes.rb'
++ filetarg=config/routes.rb
if ! grep -q "${pattern1}" $filetarg ; then 
  echo 'nogrep ~216. routes stanza not found check script interation between jq and activestorage. '
  sleep 9 ; 
  exit 9 ; 
fi
++ grep -q 'resources :country_of_origins do' config/routes.rb

# make the edit to add 
#
# add new lines of text after patrn...
#
filetarg='config/routes.rb'
++ filetarg=config/routes.rb
cat $filetarg
++ cat config/routes.rb
Rails.application.routes.draw do
 

  resources :product_features
#
  resources :products do
    get :autocomplete_pfeature_name, :on => :collection
  end

  resources :pfeatures
#
  resources :country_of_origins do
    get :autocomplete_pfeature_name, :on => :collection
  end

  mount RailsAdmin::Engine => '/radmin', as: 'rails_admin'
  resources :roles
  devise_for :users, controllers: { sessions: 'users/sessions' }
  
  root "home#index"


  get 'home/index'
  get 'home/about'
  # For details on the DSL available within this file, see http://guides.rubyonrails.org/routing.html
end
r1tmp="/tmp/_temprubyrunner_${USER}.rb"
++ r1tmp=/tmp/_temprubyrunner_albe.rb
cat <<'HEREDOC' > $r1tmp
  patrn=':country_of_origins do'
  repl2 = %Q{
    member do
      delete :delete_document_attachment
    end
  }
  ARGF.each do |line|
    puts line
    puts repl2 if line =~ /#{Regexp.escape(patrn)}/
  end
HEREDOC
++ cat
  ruby $r1tmp $filetarg > $filetarg.tmp ; cat $filetarg.tmp ; cp $filetarg.tmp $filetarg; rm $filetarg.tmp
++ ruby /tmp/_temprubyrunner_albe.rb config/routes.rb
++ cat config/routes.rb.tmp
Rails.application.routes.draw do
 

  resources :product_features
#
  resources :products do
    get :autocomplete_pfeature_name, :on => :collection
  end

  resources :pfeatures
#
  resources :country_of_origins do

    member do
      delete :delete_document_attachment
    end
  
    get :autocomplete_pfeature_name, :on => :collection
  end

  mount RailsAdmin::Engine => '/radmin', as: 'rails_admin'
  resources :roles
  devise_for :users, controllers: { sessions: 'users/sessions' }
  
  root "home#index"


  get 'home/index'
  get 'home/about'
  # For details on the DSL available within this file, see http://guides.rubyonrails.org/routing.html
end
++ cp config/routes.rb.tmp config/routes.rb
++ rm config/routes.rb.tmp




###  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


sleep 1
++ sleep 1
git add -A # Add all files and commit them
++ git add -A
  git commit -m "activestorage app edits"
++ git commit -m 'activestorage app edits'
[master 4209e8b] activestorage app edits
 4 files changed, 35 insertions(+), 1 deletion(-)



###  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

###  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

# Add line to config..

filetarg='config/environments/development.rb'
++ filetarg=config/environments/development.rb
sed -i '/Rails.application.configure/a   \ \ config.active_storage.service = :local' $filetarg
++ sed -i '/Rails.application.configure/a   \ \ config.active_storage.service = :local' config/environments/development.rb


###  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


###  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


# edit show...

filetarg='app/views/country_of_origins/show.html.erb'
++ filetarg=app/views/country_of_origins/show.html.erb
cat $filetarg
++ cat app/views/country_of_origins/show.html.erb

<p>
  <strong>Name:</strong>
  <%= @country_of_origin.name %>
</p>

<p>
  <strong>Ctype:</strong>
  <%= @country_of_origin.ctype %>
</p>

<p>
  <strong>Fdate:</strong>
  <%= @country_of_origin.fdate %>
</p>

<p>
  <strong>Active status:</strong>
  <%= @country_of_origin.active_status %>
</p>

<p>
  <strong>Sort order:</strong>
  <%= @country_of_origin.sort_order %>
</p>

<br>
<%= link_to 'Edit', edit_country_of_origin_path(@country_of_origin), class: "btn btn-primary", :style=>'color:#FFFFFF;' %> &nbsp &nbsp
<%= link_to 'Back', country_of_origins_path, class: "btn btn-default" %>
r1tmp="/tmp/_temprubyrunner_${USER}.rb"
++ r1tmp=/tmp/_temprubyrunner_albe.rb
cat <<'HEREDOC' > $r1tmp
patrn='@country_of_origin.sort'
repl2 = %Q{
<hr> 
<p>
<strong>Avatar:</strong> <br><br>
      Syntax type 1:  
      <%= if  @country_of_origin.avatar.attached? then  
            link_to @country_of_origin.avatar.blob.filename, url_for(@country_of_origin.avatar)  
          end %> <br>
      <%= if  @country_of_origin.avatar.attached? then 
            if @country_of_origin.avatar.image?  then ( image_tag @country_of_origin.avatar.variant(resize: "180x180") )  end
          end %> <br>        
      Syntax type 2:  
      <%= if  @country_of_origin.avatar.attached? then link_to @country_of_origin.avatar.filename, rails_blob_path(@country_of_origin.avatar, disposition: 'preview') end %>
</p>
<br>
<p>
  <strong>Documents:</strong>
  <ul>
   <% @country_of_origin.documents.each do |document| %>
      <li><%= link_to document.blob.filename, url_for(document) %></li>
      <%# show thumbnail if it is an image.. %> 
      <%= if document.image?  then ( image_tag document.variant(resize: "180x180") )  end %> 
          <%= link_to 'Remove', delete_document_attachment_country_of_origin_url(document),
                    method: :delete,
                    data: { confirm: 'Are you sure you want to delete?' } %>
   <% end %>
  </ul>
</p> 
<hr>
}
  i=-2
  ARGF.each_with_index do |line, ndx| 
    puts line
    if line =~ /#{Regexp.escape(patrn)}/
      i = ndx + 1
    end
    if ndx == i
        puts repl2 
    end 
  end
HEREDOC
++ cat
ruby $r1tmp $filetarg > $filetarg.tmp ; cat $filetarg.tmp ; cp $filetarg.tmp $filetarg; rm $filetarg.tmp
++ ruby /tmp/_temprubyrunner_albe.rb app/views/country_of_origins/show.html.erb
++ cat app/views/country_of_origins/show.html.erb.tmp

<p>
  <strong>Name:</strong>
  <%= @country_of_origin.name %>
</p>

<p>
  <strong>Ctype:</strong>
  <%= @country_of_origin.ctype %>
</p>

<p>
  <strong>Fdate:</strong>
  <%= @country_of_origin.fdate %>
</p>

<p>
  <strong>Active status:</strong>
  <%= @country_of_origin.active_status %>
</p>

<p>
  <strong>Sort order:</strong>
  <%= @country_of_origin.sort_order %>
</p>

<hr> 
<p>
<strong>Avatar:</strong> <br><br>
      Syntax type 1:  
      <%= if  @country_of_origin.avatar.attached? then  
            link_to @country_of_origin.avatar.blob.filename, url_for(@country_of_origin.avatar)  
          end %> <br>
      <%= if  @country_of_origin.avatar.attached? then 
            if @country_of_origin.avatar.image?  then ( image_tag @country_of_origin.avatar.variant(resize: "180x180") )  end
          end %> <br>        
      Syntax type 2:  
      <%= if  @country_of_origin.avatar.attached? then link_to @country_of_origin.avatar.filename, rails_blob_path(@country_of_origin.avatar, disposition: 'preview') end %>
</p>
<br>
<p>
  <strong>Documents:</strong>
  <ul>
   <% @country_of_origin.documents.each do |document| %>
      <li><%= link_to document.blob.filename, url_for(document) %></li>
      <%# show thumbnail if it is an image.. %> 
      <%= if document.image?  then ( image_tag document.variant(resize: "180x180") )  end %> 
          <%= link_to 'Remove', delete_document_attachment_country_of_origin_url(document),
                    method: :delete,
                    data: { confirm: 'Are you sure you want to delete?' } %>
   <% end %>
  </ul>
</p> 
<hr>

<br>
<%= link_to 'Edit', edit_country_of_origin_path(@country_of_origin), class: "btn btn-primary", :style=>'color:#FFFFFF;' %> &nbsp &nbsp
<%= link_to 'Back', country_of_origins_path, class: "btn btn-default" %>
++ cp app/views/country_of_origins/show.html.erb.tmp app/views/country_of_origins/show.html.erb
++ rm app/views/country_of_origins/show.html.erb.tmp




git add -A # Add all files and commit them
++ git add -A
  git commit -m "activestorage app edits2"
++ git commit -m 'activestorage app edits2'
[master a8759c7] activestorage app edits2
 2 files changed, 30 insertions(+)



###  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

###  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




###  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


# Copy migration files over..

path1='db/migrate'
+ path1=db/migrate
mkdir -p $path1/
+ mkdir -p db/migrate/
# rm -r $path1/
# rsync.. -a - rltpgoD  preserve almost all. -u update don't copy older source files.
rsync -av --ignore-times  $sfil2/$path1/ $path1/
+ rsync -av --ignore-times ../bashrail/db/migrate/ db/migrate/
sending incremental file list
./
30170101010101_add_devise2_to_users.rb
40170101010105_add_trackable_to_devise.rb
50161230223301_change_users_role_id_default.rb

sent 1,998 bytes  received 76 bytes  4,148.00 bytes/sec
total size is 1,641  speedup is 0.79




###  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


### db seed .. ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

# if you want to seed specific pre-planned data...

# echo 'Product.create({name: "furniture"}) '>> db/seeds.rb

# rake db:reset
# rake db:drop
rake db:migrate
+ rake db:migrate
== 40170101010105 AddTrackableToDevise: migrating =============================
-- add_column(:users, :sign_in_count, :integer, {:default=>0, :null=>false})
   -> 0.0008s
-- add_column(:users, :current_sign_in_at, :datetime, {})
   -> 0.0004s
-- add_column(:users, :last_sign_in_at, :datetime, {})
   -> 0.0004s
-- add_column(:users, :current_sign_in_ip, :inet, {})
   -> 0.0005s
-- add_column(:users, :last_sign_in_ip, :inet, {})
   -> 0.0005s
== 40170101010105 AddTrackableToDevise: migrated (0.0029s) ====================

== 50161230223301 ChangeUsersRoleIdDefault: migrating =========================
-- change_column(:users, :role_id, :integer, {:default=>3})
   -> 0.0535s
== 50161230223301 ChangeUsersRoleIdDefault: migrated (0.0537s) ================

rake db:seed
+ rake db:seed


sleep 1
+ sleep 1
git add -A # Add all files and commit them
+ git add -A
  git commit -m "seed"
+ git commit -m seed
[master 1082772] seed
 3 files changed, 26 insertions(+), 24 deletions(-)
 create mode 100644 db/migrate/40170101010105_add_trackable_to_devise.rb
 create mode 100644 db/migrate/50161230223301_change_users_role_id_default.rb


### populate .. ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


# populator gem seems to be too old to work now. Switch to seeder.rake task. See below.


# cat << HEREDOC > lib/tasks/populate.rake
# namespace :db do
#   desc "fill database"
#   task :populate => :environment do
#     require 'populator'
#     require 'faker'
#     Product.populate 11 do |a12|
#       a12.name     = Faker::Commerce.product_name
#     end
#     CountryOfOrigin.populate 99 do |a12|
#       a12.name     = Faker::Address.country
#     end
#     Pfeature.populate 9 do |a12|
#       a12.name     = Faker::Commerce.color
#     end
#   end
# end
# HEREDOC
# rake db:populate



cat << HEREDOC > lib/tasks/seader.rake
# lib/tasks/seeder.rake
# https://stackoverflow.com/questions/19872271/adding-a-custom-seed-file
# usage: rake db:seeder
#   seeds all files in db/seeds/*

desc "Run all files in db/seeds directory"
namespace :db do
  task seeder: :environment do
    Dir[File.join(Rails.root, 'db', 'seeds', '*.rb')].each do |filename|
      puts "seeding - #{filename}. (see lib/tasks/seeder.rake)"
      load(filename)
    end
  end
end
HEREDOC
+ cat

mkdir -p db/seeds
+ mkdir -p db/seeds
cat << HEREDOC > db/seeds/seed3.rb
10.times do
  CountryOfOrigin.create(
    name: Faker::Address.country
  )
end
10.times do
  Pfeature.create(
    name: Faker::Commerce.color
  )
end
7.times do
  Product.create(
    name: Faker::Commerce.product_name,
    country_of_origin_id: Faker::Number.within(range: 1..5)
  )
end
HEREDOC
+ cat

rake db:seeder
+ rake db:seeder
seeding - /srv/test/brails-01/brail542c17/db/seeds/seed3.rb. (see lib/tasks/seeder.rake)

sleep 1
+ sleep 1
git add -A # Add all files and commit them
+ git add -A
  git commit -m "populate"
+ git commit -m populate
[master 5d431e1] populate
 2 files changed, 30 insertions(+)
 create mode 100644 db/seeds/seed3.rb
 create mode 100644 lib/tasks/seader.rake


###  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

# Copy files over..

path1='empty'
+ path1=empty
pathtmp='/tmp/bashrail'
+ pathtmp=/tmp/bashrail
rm -rf $pathtmp; mkdir -p $pathtmp/
+ rm -rf /tmp/bashrail
+ mkdir -p /tmp/bashrail/
pathtarget='docs/generatedby' ;mkdir -p $pathtarget/
+ pathtarget=docs/generatedby
+ mkdir -p docs/generatedby/
rsync -av --ignore-times  $sfil2/ $pathtmp/
+ rsync -av --ignore-times ../bashrail/ /tmp/bashrail/
sending incremental file list
./
.gitignore
.mtimes
1mk.sh
LICENSE.txt
Makefile
README-history-summary.md
README.md
activestorage.sh
admin-ra-materialtheme.sh
admin1.sh
applayout1.sh
bootstrap1.sh
cancan1.sh
carrierwave1.sh
cocoon1.sh
curldump
devise1.sh
devise2thor.rb
devisejwt.sh
devisetokenauth1.sh
docker-compose.prod.yml
docker-compose.yml
figaro.env.sh
gemfile1.sh
heroku1.sh
home1.sh
jqueryautocomplete.sh
jqueryautocomplete_pcolor.sh
ldap1.sh
ldap_manual-edits.txt
mtimeh.txt
mtimehs.txt
new1.sh
notes.txt
paginate1.sh
papertrail1.sh
readme,runone,script,howto.txt
seeds1.sh
seeds2.sh
select2.sh
tableprefix1.sh
timezone1.sh
todo.txt
version-last10.txt
version-log.txt
version.txt
.git/
.git/HEAD
.git/config
.git/description
.git/index
.git/packed-refs
.git/branches/
.git/hooks/
.git/hooks/applypatch-msg.sample
.git/hooks/commit-msg.sample
.git/hooks/post-update.sample
.git/hooks/pre-applypatch.sample
.git/hooks/pre-commit.sample
.git/hooks/pre-push.sample
.git/hooks/pre-rebase.sample
.git/hooks/prepare-commit-msg.sample
.git/hooks/update.sample
.git/info/
.git/info/exclude
.git/logs/
.git/logs/HEAD
.git/logs/refs/
.git/logs/refs/heads/
.git/logs/refs/heads/master
.git/logs/refs/remotes/
.git/logs/refs/remotes/origin/
.git/logs/refs/remotes/origin/HEAD
.git/objects/
.git/objects/info/
.git/objects/pack/
.git/objects/pack/pack-a96475918ce50002f5dd4edab958df14d9f28ff2.idx
.git/objects/pack/pack-a96475918ce50002f5dd4edab958df14d9f28ff2.pack
.git/refs/
.git/refs/heads/
.git/refs/heads/master
.git/refs/remotes/
.git/refs/remotes/origin/
.git/refs/remotes/origin/HEAD
.git/refs/tags/
app/
app/assets/
app/assets/javascripts/
app/assets/javascripts/rails_admin/
app/assets/javascripts/rails_admin/custom/
app/assets/javascripts/rails_admin/custom/ui.js
app/controllers/
app/controllers/application_controller.rb
app/controllers/users/
app/controllers/users/registrations_controller.rb
app/controllers/users/sessions_controller.rb
app/helpers/
app/helpers/application_helper.rb
app/helpers/jwt_wrapper.rb
app/models/
app/models/ability.rb
app/models/role.rb
app/models/user.rb
app/views/
app/views/devise/
app/views/devise/confirmations/
app/views/devise/confirmations/new.html.erb
app/views/devise/mailer/
app/views/devise/mailer/confirmation_instructions.html.erb
app/views/devise/mailer/email_changed.html.erb
app/views/devise/mailer/password_change.html.erb
app/views/devise/mailer/reset_password_instructions.html.erb
app/views/devise/mailer/unlock_instructions.html.erb
app/views/devise/passwords/
app/views/devise/passwords/edit.html.erb
app/views/devise/passwords/new.html.erb
app/views/devise/registrations/
app/views/devise/registrations/edit.html.erb
app/views/devise/registrations/new.html.erb
app/views/devise/sessions/
app/views/devise/sessions/new.html.erb
app/views/devise/shared/
app/views/devise/shared/_links.html.erb
app/views/devise/unlocks/
app/views/devise/unlocks/new.html.erb
backup/
backup/app/
backup/app/models/
backup/app/models/ability.rb
backup/app/models/role.rb
backup/app/models/user.rb
config/
config/database-example.yml
config/database-heroku.yml
config/database-sqlite.yml
config/ldap-example.yml
config/secrets.yml
config/environments/
config/environments/development.rb
config/initializers/
config/initializers/devise.rb
config/initializers/core/
config/initializers/core/extensions/
config/initializers/core/extensions/devise/
config/initializers/core/extensions/devise/strategies/
config/initializers/core/extensions/devise/strategies/json_web_token.rb
config/locales/
config/locales/en.yml
db/
db/migrate/
db/migrate/30170101010101_add_devise2_to_users.rb
db/migrate/40170101010105_add_trackable_to_devise.rb
db/migrate/50161230223301_change_users_role_id_default.rb
db/seeds/
db/seeds/seed3.rb
db/seeds/seedtest1.rb
deploy/
deploy/deploy-drail-howto-notes.txt
deploy/deploy.sh
deploy/puma-manager.conf
deploy/puma.conf
deploy/puma.rb
deploy/puma_production.rb
deploy/deployfiles/
deploy/deployfiles/application.yml
deploy/deployfiles/devise-withproductionsecretkey.rb
deploy/reference/
deploy/reference/production.rb
deploy/reference/puma-rails5-developmnt.rb
deploy/reference/puma1.rb
docker/
docker/app.Dockerfile
docker/nginx.conf
docs/
docs/50161230223303_add_country_of_origin_to_products.rb
docs/Gemfile-example
docs/devise,install,info.txt
docs/features-list-bashrails-know.txt
docs/howtoaddacolumn-railsknow.txt
docs/jwt.rails.notes.txt
docs/ldap_howto_readme.sh.txt
docs/mac,osx,differences.txt
docs/rails,form_for add required field indicator,mark,form_builder_know.txt
docs/rails,ransack,4box-search,mostcolumns,textcolumns,know.txt
docs/remove-scaffolds_prepare,to,use,as,starter-app_know.txt
docs/seeder.txt
docs/sigpad-howto-install,know,2017a.txt
docs/switchfrom,simpleform,to,railsform.txt
docs/will_filter1.sh
docs/docker.dkr.notes/
docs/docker.dkr.notes/README,notes,prod469,brails-anonoz,docker.txt
docs/docker.dkr.notes/README.notes.nuxtrl.railnuxt490.vue.autheg.brail.docker.dkr_master.txt
docs/docker.dkr.notes/notes.brail-docker-dkr.txt.md
docs/docker.dkr.notes/notes.brail347a22-docker-satendra02-dkr380.txt - Copy.md
docs/dotenv-rails-howto-know/
docs/dotenv-rails-howto-know/.env
docs/dotenv-rails-howto-know/application.rb
docs/dotenv-rails-howto-know/database.yml
docs/dotenv-rails-howto-know/dotenv-rails-howto-know,dot.env.txt
docs/images/
docs/images/datepicker.png
docs/images/home.png
docs/images/list-main.png
docs/images/list-support-table.png
docs/images/login.png
docs/images/select2-multiple-manytomany.png
docs/ldap/
docs/ldap/devise.rb
docs/ldap/ldap-example.yml
docs/ldap/ldap265.sh
docs/ldap/ldap265h-v206c.local_home_albe_share203__2016.10.19_11.54.42.tgz
docs/ldap/ldap265mk-copy.sh
docs/ldap/ldap_howto_readme.sh.txt
docs/ldap/user_4ldap.rb
docs/scaffold/
docs/scaffold/hrapp361-scaffold.txt
docs/scaffold/lpa346-scaffold.txt
docsbr/
docsbr/2019-11-03_Sun_10.22-AM.copy.meeting.search.curl.json.api.brail347a22.brail484b46.testingtheapi.txt
docsbr/api-docs.txt
docsbr/api-reference_articles-I-used-for-jwt.txt
docsbr/api-requests,curl,signin,etc.txt
docsbr/api-requests-examples-insomnia-2016-12-27.json
docsbr/api-responses.txt
docsbr/create.curl.txt
docsbr/delete-notfound.curl.txt
docsbr/delete.curl.txt
docsbr/example,rails,routes.html
docsbr/get.curl.txt
docsbr/log 2017-01-04_Wed_11.08-AM (2).txt
docsbr/log 2017-01-04_Wed_11.08-AM.txt
docsbr/log-2017-03-18_Sat_20.41-PM.txt
docsbr/search.curl.json.api.brail347a22.brail484b46.testingtheapi.txt
docsbr/signin.curl.txt
docsbr/signup.curl.txt
docsbr/update.curl.txt
errors/
errors/application_controller__2016-12-29_21.05.31.rb
errors/err.txt
errors/error,dta1.txt
errors/qtag486__rails.api.unresponsive.txt
errors/put/
errors/put/controller, 204nocontent-on-put, 2017-01-04_09.23.05.rb
errors/put/products_controller example 2017-01-04_11.08.50.rb
errors/put/products_controller__2017-01-04_09.24.50.rb
errors/put/put.txt
examples/
examples/2commandlineparameters.sh
examples/3commandlineparameters.sh
examples/New Text Document.txt
examples/absolutepathfromrelative.txt
examples/bashruby-textsubreplace,know,file,edit,sed.txt.sh
examples/cparse.sh
examples/examples,not,working
examples/paginate1-notes
examples/paginate1_with,add,heredoc,after,pattern.sh
examples/settings.sh
examples/version-v1.sh
examples/version__2016-11-29_17.33.11.sh
indev/
indev/shrine1a.sh
indev/shrine2.sh
lib/
lib/tasks/
lib/tasks/seeder.rake
lib/templates/
lib/templates/erb/
lib/templates/erb/scaffold/
lib/templates/erb/scaffold/_form.html,bootstrap_form_for-1.erb
lib/templates/erb/scaffold/_form.html,railsform_for-1.erb
lib/templates/erb/scaffold/_form.html,railsform_for-2.erb
lib/templates/erb/scaffold/_form.html,simpleform-1.erb
lib/templates/erb/scaffold/_form.html.erb
lib/templates/erb/scaffold/edit.html.erb
lib/templates/erb/scaffold/index.html-with-separate-buttons.erb
lib/templates/erb/scaffold/index.html-with-separate-buttons_nodestroy.erb
lib/templates/erb/scaffold/index.html.erb
lib/templates/erb/scaffold/new.html.erb
lib/templates/erb/scaffold/show.html.erb
lib/templates/rails/
lib/templates/rails/scaffold_controller/
lib/templates/rails/scaffold_controller/controller.rb
lib/templates/rails/scaffold_controller/controller__beforerail263controller.rb
lib/templates/rails/scaffold_controller/origbak/
lib/templates/rails/scaffold_controller/origbak/controller.rb
libs/
libs/railsform/
libs/railsform/lib/
libs/railsform/lib/templates/
libs/railsform/lib/templates/erb/
libs/railsform/lib/templates/erb/scaffold/
libs/railsform/lib/templates/erb/scaffold/_form.html.erb
rails-jquery-autocomplete/
rails-jquery-autocomplete/countryoforigin_jq_ac.js
rails-jquery-autocomplete/dgautocomplete.scss
rails-jquery-autocomplete/diff-jqui-autocomplete_rail281k-mk.sh.txt
root/
root/.gitattributes
root/.gitignore
thor/
thor/thor1.rb
thor/thor2.rb
util/
util/hook.sh
util/mtimeh.rb
util/version.sh
util/hooks/
util/hooks/post-checkout
util/hooks/pre-commit
util/hooks/pre-push
utilbr/
utilbr/adduser1.rb
utilbr/passw.rb
utilbr/scafrff.sh
utilbr/scafsf.sh

sent 1,956,908 bytes  received 4,804 bytes  3,923,424.00 bytes/sec
total size is 1,936,374  speedup is 0.99
# rsync.. -a - rltpgoD  preserve almost all. -u update don't copy older source files.
rm -rf $pathtmp/.git
+ rm -rf /tmp/bashrail/.git
zip -r  /tmp/bashrail_copy.zip $pathtmp/*
+ zip -r /tmp/bashrail_copy.zip /tmp/bashrail/1mk.sh /tmp/bashrail/activestorage.sh /tmp/bashrail/admin1.sh /tmp/bashrail/admin-ra-materialtheme.sh /tmp/bashrail/app /tmp/bashrail/applayout1.sh /tmp/bashrail/backup /tmp/bashrail/bootstrap1.sh /tmp/bashrail/cancan1.sh /tmp/bashrail/carrierwave1.sh /tmp/bashrail/cocoon1.sh /tmp/bashrail/config /tmp/bashrail/curldump /tmp/bashrail/db /tmp/bashrail/deploy /tmp/bashrail/devise1.sh /tmp/bashrail/devise2thor.rb /tmp/bashrail/devisejwt.sh /tmp/bashrail/devisetokenauth1.sh /tmp/bashrail/docker /tmp/bashrail/docker-compose.prod.yml /tmp/bashrail/docker-compose.yml /tmp/bashrail/docs /tmp/bashrail/docsbr /tmp/bashrail/errors /tmp/bashrail/examples /tmp/bashrail/figaro.env.sh /tmp/bashrail/gemfile1.sh /tmp/bashrail/heroku1.sh /tmp/bashrail/home1.sh /tmp/bashrail/indev /tmp/bashrail/jqueryautocomplete_pcolor.sh /tmp/bashrail/jqueryautocomplete.sh /tmp/bashrail/ldap1.sh /tmp/bashrail/ldap_manual-edits.txt /tmp/bashrail/lib /tmp/bashrail/libs /tmp/bashrail/LICENSE.txt /tmp/bashrail/Makefile /tmp/bashrail/mtimehs.txt /tmp/bashrail/mtimeh.txt /tmp/bashrail/new1.sh /tmp/bashrail/notes.txt /tmp/bashrail/paginate1.sh /tmp/bashrail/papertrail1.sh /tmp/bashrail/rails-jquery-autocomplete /tmp/bashrail/README-history-summary.md /tmp/bashrail/README.md /tmp/bashrail/readme,runone,script,howto.txt /tmp/bashrail/root /tmp/bashrail/seeds1.sh /tmp/bashrail/seeds2.sh /tmp/bashrail/select2.sh /tmp/bashrail/tableprefix1.sh /tmp/bashrail/thor /tmp/bashrail/timezone1.sh /tmp/bashrail/todo.txt /tmp/bashrail/util /tmp/bashrail/utilbr /tmp/bashrail/version-last10.txt /tmp/bashrail/version-log.txt /tmp/bashrail/version.txt
  adding: tmp/bashrail/1mk.sh (deflated 65%)
  adding: tmp/bashrail/activestorage.sh (deflated 73%)
  adding: tmp/bashrail/admin1.sh (deflated 59%)
  adding: tmp/bashrail/admin-ra-materialtheme.sh (deflated 61%)
  adding: tmp/bashrail/app/ (stored 0%)
  adding: tmp/bashrail/app/views/ (stored 0%)
  adding: tmp/bashrail/app/views/devise/ (stored 0%)
  adding: tmp/bashrail/app/views/devise/mailer/ (stored 0%)
  adding: tmp/bashrail/app/views/devise/mailer/unlock_instructions.html.erb (deflated 35%)
  adding: tmp/bashrail/app/views/devise/mailer/reset_password_instructions.html.erb (deflated 40%)
  adding: tmp/bashrail/app/views/devise/mailer/confirmation_instructions.html.erb (deflated 30%)
  adding: tmp/bashrail/app/views/devise/mailer/password_change.html.erb (deflated 11%)
  adding: tmp/bashrail/app/views/devise/mailer/email_changed.html.erb (deflated 51%)
  adding: tmp/bashrail/app/views/devise/unlocks/ (stored 0%)
  adding: tmp/bashrail/app/views/devise/unlocks/new.html.erb (deflated 45%)
  adding: tmp/bashrail/app/views/devise/confirmations/ (stored 0%)
  adding: tmp/bashrail/app/views/devise/confirmations/new.html.erb (deflated 47%)
  adding: tmp/bashrail/app/views/devise/passwords/ (stored 0%)
  adding: tmp/bashrail/app/views/devise/passwords/new.html.erb (deflated 42%)
  adding: tmp/bashrail/app/views/devise/passwords/edit.html.erb (deflated 52%)
  adding: tmp/bashrail/app/views/devise/shared/ (stored 0%)
  adding: tmp/bashrail/app/views/devise/shared/_links.html.erb (deflated 70%)
  adding: tmp/bashrail/app/views/devise/registrations/ (stored 0%)
  adding: tmp/bashrail/app/views/devise/registrations/new.html.erb (deflated 49%)
  adding: tmp/bashrail/app/views/devise/registrations/edit.html.erb (deflated 53%)
  adding: tmp/bashrail/app/views/devise/sessions/ (stored 0%)
  adding: tmp/bashrail/app/views/devise/sessions/new.html.erb (deflated 47%)
  adding: tmp/bashrail/app/controllers/ (stored 0%)
  adding: tmp/bashrail/app/controllers/application_controller.rb (stored 0%)
  adding: tmp/bashrail/app/controllers/users/ (stored 0%)
  adding: tmp/bashrail/app/controllers/users/sessions_controller.rb (deflated 56%)
  adding: tmp/bashrail/app/controllers/users/registrations_controller.rb (deflated 64%)
  adding: tmp/bashrail/app/helpers/ (stored 0%)
  adding: tmp/bashrail/app/helpers/jwt_wrapper.rb (deflated 51%)
  adding: tmp/bashrail/app/helpers/application_helper.rb (deflated 34%)
  adding: tmp/bashrail/app/models/ (stored 0%)
  adding: tmp/bashrail/app/models/user.rb (deflated 58%)
  adding: tmp/bashrail/app/models/ability.rb (deflated 52%)
  adding: tmp/bashrail/app/models/role.rb (deflated 30%)
  adding: tmp/bashrail/app/assets/ (stored 0%)
  adding: tmp/bashrail/app/assets/javascripts/ (stored 0%)
  adding: tmp/bashrail/app/assets/javascripts/rails_admin/ (stored 0%)
  adding: tmp/bashrail/app/assets/javascripts/rails_admin/custom/ (stored 0%)
  adding: tmp/bashrail/app/assets/javascripts/rails_admin/custom/ui.js (deflated 58%)
  adding: tmp/bashrail/applayout1.sh (deflated 64%)
  adding: tmp/bashrail/backup/ (stored 0%)
  adding: tmp/bashrail/backup/app/ (stored 0%)
  adding: tmp/bashrail/backup/app/models/ (stored 0%)
  adding: tmp/bashrail/backup/app/models/user.rb (deflated 58%)
  adding: tmp/bashrail/backup/app/models/ability.rb (deflated 52%)
  adding: tmp/bashrail/backup/app/models/role.rb (deflated 30%)
  adding: tmp/bashrail/bootstrap1.sh (deflated 62%)
  adding: tmp/bashrail/cancan1.sh (deflated 69%)
  adding: tmp/bashrail/carrierwave1.sh (deflated 68%)
  adding: tmp/bashrail/cocoon1.sh (deflated 64%)
  adding: tmp/bashrail/config/ (stored 0%)
  adding: tmp/bashrail/config/database-example.yml (deflated 56%)
  adding: tmp/bashrail/config/secrets.yml (deflated 48%)
  adding: tmp/bashrail/config/ldap-example.yml (deflated 59%)
  adding: tmp/bashrail/config/locales/ (stored 0%)
  adding: tmp/bashrail/config/locales/en.yml (deflated 54%)
  adding: tmp/bashrail/config/database-sqlite.yml (deflated 50%)
  adding: tmp/bashrail/config/environments/ (stored 0%)
  adding: tmp/bashrail/config/environments/development.rb (deflated 55%)
  adding: tmp/bashrail/config/database-heroku.yml (deflated 62%)
  adding: tmp/bashrail/config/initializers/ (stored 0%)
  adding: tmp/bashrail/config/initializers/core/ (stored 0%)
  adding: tmp/bashrail/config/initializers/core/extensions/ (stored 0%)
  adding: tmp/bashrail/config/initializers/core/extensions/devise/ (stored 0%)
  adding: tmp/bashrail/config/initializers/core/extensions/devise/strategies/ (stored 0%)
  adding: tmp/bashrail/config/initializers/core/extensions/devise/strategies/json_web_token.rb (deflated 50%)
  adding: tmp/bashrail/config/initializers/devise.rb (stored 0%)
  adding: tmp/bashrail/curldump (deflated 25%)
  adding: tmp/bashrail/db/ (stored 0%)
  adding: tmp/bashrail/db/migrate/ (stored 0%)
  adding: tmp/bashrail/db/migrate/40170101010105_add_trackable_to_devise.rb (deflated 60%)
  adding: tmp/bashrail/db/migrate/50161230223301_change_users_role_id_default.rb (deflated 34%)
  adding: tmp/bashrail/db/migrate/30170101010101_add_devise2_to_users.rb (deflated 53%)
  adding: tmp/bashrail/db/seeds/ (stored 0%)
  adding: tmp/bashrail/db/seeds/seed3.rb (deflated 46%)
  adding: tmp/bashrail/db/seeds/seedtest1.rb (deflated 36%)
  adding: tmp/bashrail/deploy/ (stored 0%)
  adding: tmp/bashrail/deploy/puma-manager.conf (deflated 48%)
  adding: tmp/bashrail/deploy/deploy-drail-howto-notes.txt (deflated 75%)
  adding: tmp/bashrail/deploy/deployfiles/ (stored 0%)
  adding: tmp/bashrail/deploy/deployfiles/devise-withproductionsecretkey.rb (deflated 63%)
  adding: tmp/bashrail/deploy/deployfiles/application.yml (deflated 31%)
  adding: tmp/bashrail/deploy/reference/ (stored 0%)
  adding: tmp/bashrail/deploy/reference/production.rb (deflated 46%)
  adding: tmp/bashrail/deploy/reference/puma-rails5-developmnt.rb (deflated 53%)
  adding: tmp/bashrail/deploy/reference/puma1.rb (deflated 46%)
  adding: tmp/bashrail/deploy/deploy.sh (deflated 55%)
  adding: tmp/bashrail/deploy/puma_production.rb (deflated 46%)
  adding: tmp/bashrail/deploy/puma.conf (deflated 56%)
  adding: tmp/bashrail/deploy/puma.rb (deflated 46%)
  adding: tmp/bashrail/devise1.sh (deflated 64%)
  adding: tmp/bashrail/devise2thor.rb (deflated 55%)
  adding: tmp/bashrail/devisejwt.sh (deflated 72%)
  adding: tmp/bashrail/devisetokenauth1.sh (deflated 56%)
  adding: tmp/bashrail/docker/ (stored 0%)
  adding: tmp/bashrail/docker/nginx.conf (deflated 50%)
  adding: tmp/bashrail/docker/app.Dockerfile (deflated 41%)
  adding: tmp/bashrail/docker-compose.prod.yml (deflated 54%)
  adding: tmp/bashrail/docker-compose.yml (deflated 54%)
  adding: tmp/bashrail/docs/ (stored 0%)
  adding: tmp/bashrail/docs/scaffold/ (stored 0%)
  adding: tmp/bashrail/docs/scaffold/hrapp361-scaffold.txt (deflated 75%)
  adding: tmp/bashrail/docs/scaffold/lpa346-scaffold.txt (deflated 82%)
  adding: tmp/bashrail/docs/ldap_howto_readme.sh.txt (deflated 55%)
  adding: tmp/bashrail/docs/rails,ransack,4box-search,mostcolumns,textcolumns,know.txt (deflated 82%)
  adding: tmp/bashrail/docs/howtoaddacolumn-railsknow.txt (deflated 73%)
  adding: tmp/bashrail/docs/50161230223303_add_country_of_origin_to_products.rb (deflated 23%)
  adding: tmp/bashrail/docs/sigpad-howto-install,know,2017a.txt (deflated 59%)
  adding: tmp/bashrail/docs/docker.dkr.notes/ (stored 0%)
  adding: tmp/bashrail/docs/docker.dkr.notes/notes.brail347a22-docker-satendra02-dkr380.txt - Copy.md (deflated 64%)
  adding: tmp/bashrail/docs/docker.dkr.notes/notes.brail-docker-dkr.txt.md (deflated 89%)
  adding: tmp/bashrail/docs/docker.dkr.notes/README.notes.nuxtrl.railnuxt490.vue.autheg.brail.docker.dkr_master.txt (deflated 64%)
  adding: tmp/bashrail/docs/docker.dkr.notes/README,notes,prod469,brails-anonoz,docker.txt (deflated 76%)
  adding: tmp/bashrail/docs/devise,install,info.txt (deflated 57%)
  adding: tmp/bashrail/docs/ldap/ (stored 0%)
  adding: tmp/bashrail/docs/ldap/ldap_howto_readme.sh.txt (deflated 54%)
  adding: tmp/bashrail/docs/ldap/ldap-example.yml (deflated 59%)
  adding: tmp/bashrail/docs/ldap/devise.rb (deflated 63%)
  adding: tmp/bashrail/docs/ldap/ldap265mk-copy.sh (deflated 53%)
  adding: tmp/bashrail/docs/ldap/user_4ldap.rb (deflated 62%)
  adding: tmp/bashrail/docs/ldap/ldap265h-v206c.local_home_albe_share203__2016.10.19_11.54.42.tgz (deflated 0%)
  adding: tmp/bashrail/docs/ldap/ldap265.sh (deflated 53%)
  adding: tmp/bashrail/docs/mac,osx,differences.txt (deflated 57%)
  adding: tmp/bashrail/docs/images/ (stored 0%)
  adding: tmp/bashrail/docs/images/login.png (deflated 14%)
  adding: tmp/bashrail/docs/images/datepicker.png (deflated 16%)
  adding: tmp/bashrail/docs/images/select2-multiple-manytomany.png (deflated 27%)
  adding: tmp/bashrail/docs/images/home.png (deflated 15%)
  adding: tmp/bashrail/docs/images/list-main.png (deflated 15%)
  adding: tmp/bashrail/docs/images/list-support-table.png (deflated 19%)
  adding: tmp/bashrail/docs/will_filter1.sh (deflated 70%)
  adding: tmp/bashrail/docs/seeder.txt (deflated 27%)
  adding: tmp/bashrail/docs/jwt.rails.notes.txt (deflated 63%)
  adding: tmp/bashrail/docs/features-list-bashrails-know.txt (deflated 66%)
  adding: tmp/bashrail/docs/switchfrom,simpleform,to,railsform.txt (deflated 72%)
  adding: tmp/bashrail/docs/Gemfile-example (deflated 55%)
  adding: tmp/bashrail/docs/dotenv-rails-howto-know/ (stored 0%)
  adding: tmp/bashrail/docs/dotenv-rails-howto-know/.env (deflated 35%)
  adding: tmp/bashrail/docs/dotenv-rails-howto-know/application.rb (deflated 45%)
  adding: tmp/bashrail/docs/dotenv-rails-howto-know/dotenv-rails-howto-know,dot.env.txt (deflated 51%)
  adding: tmp/bashrail/docs/dotenv-rails-howto-know/database.yml (deflated 53%)
  adding: tmp/bashrail/docs/rails,form_for add required field indicator,mark,form_builder_know.txt (deflated 70%)
  adding: tmp/bashrail/docs/remove-scaffolds_prepare,to,use,as,starter-app_know.txt (deflated 82%)
  adding: tmp/bashrail/docsbr/ (stored 0%)
  adding: tmp/bashrail/docsbr/example,rails,routes.html (deflated 93%)
  adding: tmp/bashrail/docsbr/signin.curl.txt (deflated 45%)
  adding: tmp/bashrail/docsbr/update.curl.txt (deflated 64%)
  adding: tmp/bashrail/docsbr/2019-11-03_Sun_10.22-AM.copy.meeting.search.curl.json.api.brail347a22.brail484b46.testingtheapi.txt (deflated 75%)
  adding: tmp/bashrail/docsbr/api-requests,curl,signin,etc.txt (deflated 70%)
  adding: tmp/bashrail/docsbr/api-requests-examples-insomnia-2016-12-27.json (deflated 83%)
  adding: tmp/bashrail/docsbr/log-2017-03-18_Sat_20.41-PM.txt (deflated 52%)
  adding: tmp/bashrail/docsbr/create.curl.txt (deflated 51%)
  adding: tmp/bashrail/docsbr/log 2017-01-04_Wed_11.08-AM (2).txt (deflated 20%)
  adding: tmp/bashrail/docsbr/delete-notfound.curl.txt (deflated 90%)
  adding: tmp/bashrail/docsbr/search.curl.json.api.brail347a22.brail484b46.testingtheapi.txt (deflated 74%)
  adding: tmp/bashrail/docsbr/signup.curl.txt (deflated 57%)
  adding: tmp/bashrail/docsbr/delete.curl.txt (deflated 65%)
  adding: tmp/bashrail/docsbr/get.curl.txt (deflated 46%)
  adding: tmp/bashrail/docsbr/api-reference_articles-I-used-for-jwt.txt (deflated 60%)
  adding: tmp/bashrail/docsbr/log 2017-01-04_Wed_11.08-AM.txt (deflated 74%)
  adding: tmp/bashrail/docsbr/api-docs.txt (deflated 17%)
  adding: tmp/bashrail/docsbr/api-responses.txt (deflated 69%)
  adding: tmp/bashrail/errors/ (stored 0%)
  adding: tmp/bashrail/errors/qtag486__rails.api.unresponsive.txt (deflated 46%)
  adding: tmp/bashrail/errors/error,dta1.txt (deflated 66%)
  adding: tmp/bashrail/errors/err.txt (deflated 70%)
  adding: tmp/bashrail/errors/application_controller__2016-12-29_21.05.31.rb (deflated 58%)
  adding: tmp/bashrail/errors/put/ (stored 0%)
  adding: tmp/bashrail/errors/put/controller, 204nocontent-on-put, 2017-01-04_09.23.05.rb (deflated 64%)
  adding: tmp/bashrail/errors/put/put.txt (deflated 43%)
  adding: tmp/bashrail/errors/put/products_controller__2017-01-04_09.24.50.rb (deflated 59%)
  adding: tmp/bashrail/errors/put/products_controller example 2017-01-04_11.08.50.rb (deflated 64%)
  adding: tmp/bashrail/examples/ (stored 0%)
  adding: tmp/bashrail/examples/bashruby-textsubreplace,know,file,edit,sed.txt.sh (deflated 73%)
  adding: tmp/bashrail/examples/cparse.sh (deflated 49%)
  adding: tmp/bashrail/examples/version__2016-11-29_17.33.11.sh (deflated 55%)
  adding: tmp/bashrail/examples/paginate1_with,add,heredoc,after,pattern.sh (deflated 64%)
  adding: tmp/bashrail/examples/3commandlineparameters.sh (deflated 51%)
  adding: tmp/bashrail/examples/version-v1.sh (deflated 58%)
  adding: tmp/bashrail/examples/paginate1-notes (deflated 69%)
  adding: tmp/bashrail/examples/New Text Document.txt (deflated 47%)
  adding: tmp/bashrail/examples/examples,not,working (deflated 53%)
  adding: tmp/bashrail/examples/settings.sh (deflated 48%)
  adding: tmp/bashrail/examples/absolutepathfromrelative.txt (deflated 54%)
  adding: tmp/bashrail/examples/2commandlineparameters.sh (deflated 45%)
  adding: tmp/bashrail/figaro.env.sh (deflated 61%)
  adding: tmp/bashrail/gemfile1.sh (deflated 49%)
  adding: tmp/bashrail/heroku1.sh (deflated 69%)
  adding: tmp/bashrail/home1.sh (deflated 52%)
  adding: tmp/bashrail/indev/ (stored 0%)
  adding: tmp/bashrail/indev/shrine2.sh (deflated 63%)
  adding: tmp/bashrail/indev/shrine1a.sh (deflated 70%)
  adding: tmp/bashrail/jqueryautocomplete_pcolor.sh (deflated 60%)
  adding: tmp/bashrail/jqueryautocomplete.sh (deflated 66%)
  adding: tmp/bashrail/ldap1.sh (deflated 64%)
  adding: tmp/bashrail/ldap_manual-edits.txt (deflated 40%)
  adding: tmp/bashrail/lib/ (stored 0%)
  adding: tmp/bashrail/lib/templates/ (stored 0%)
  adding: tmp/bashrail/lib/templates/erb/ (stored 0%)
  adding: tmp/bashrail/lib/templates/erb/scaffold/ (stored 0%)
  adding: tmp/bashrail/lib/templates/erb/scaffold/_form.html,simpleform-1.erb (deflated 45%)
  adding: tmp/bashrail/lib/templates/erb/scaffold/_form.html,railsform_for-2.erb (deflated 63%)
  adding: tmp/bashrail/lib/templates/erb/scaffold/_form.html,railsform_for-1.erb (deflated 61%)
  adding: tmp/bashrail/lib/templates/erb/scaffold/_form.html.erb (deflated 63%)
  adding: tmp/bashrail/lib/templates/erb/scaffold/show.html.erb (deflated 44%)
  adding: tmp/bashrail/lib/templates/erb/scaffold/new.html.erb (deflated 15%)
  adding: tmp/bashrail/lib/templates/erb/scaffold/index.html-with-separate-buttons_nodestroy.erb (deflated 65%)
  adding: tmp/bashrail/lib/templates/erb/scaffold/index.html-with-separate-buttons.erb (deflated 65%)
  adding: tmp/bashrail/lib/templates/erb/scaffold/_form.html,bootstrap_form_for-1.erb (deflated 55%)
  adding: tmp/bashrail/lib/templates/erb/scaffold/edit.html.erb (deflated 34%)
  adding: tmp/bashrail/lib/templates/erb/scaffold/index.html.erb (deflated 65%)
  adding: tmp/bashrail/lib/templates/rails/ (stored 0%)
  adding: tmp/bashrail/lib/templates/rails/scaffold_controller/ (stored 0%)
  adding: tmp/bashrail/lib/templates/rails/scaffold_controller/controller__beforerail263controller.rb (deflated 66%)
  adding: tmp/bashrail/lib/templates/rails/scaffold_controller/origbak/ (stored 0%)
  adding: tmp/bashrail/lib/templates/rails/scaffold_controller/origbak/controller.rb (deflated 65%)
  adding: tmp/bashrail/lib/templates/rails/scaffold_controller/controller.rb (deflated 67%)
  adding: tmp/bashrail/lib/tasks/ (stored 0%)
  adding: tmp/bashrail/lib/tasks/seeder.rake (deflated 38%)
  adding: tmp/bashrail/libs/ (stored 0%)
  adding: tmp/bashrail/libs/railsform/ (stored 0%)
  adding: tmp/bashrail/libs/railsform/lib/ (stored 0%)
  adding: tmp/bashrail/libs/railsform/lib/templates/ (stored 0%)
  adding: tmp/bashrail/libs/railsform/lib/templates/erb/ (stored 0%)
  adding: tmp/bashrail/libs/railsform/lib/templates/erb/scaffold/ (stored 0%)
  adding: tmp/bashrail/libs/railsform/lib/templates/erb/scaffold/_form.html.erb (deflated 64%)
  adding: tmp/bashrail/LICENSE.txt (deflated 66%)
  adding: tmp/bashrail/Makefile (deflated 65%)
  adding: tmp/bashrail/mtimehs.txt (deflated 64%)
  adding: tmp/bashrail/mtimeh.txt (deflated 64%)
  adding: tmp/bashrail/new1.sh (deflated 53%)
  adding: tmp/bashrail/notes.txt (deflated 67%)
  adding: tmp/bashrail/paginate1.sh (deflated 58%)
  adding: tmp/bashrail/papertrail1.sh (deflated 73%)
  adding: tmp/bashrail/rails-jquery-autocomplete/ (stored 0%)
  adding: tmp/bashrail/rails-jquery-autocomplete/dgautocomplete.scss (deflated 63%)
  adding: tmp/bashrail/rails-jquery-autocomplete/diff-jqui-autocomplete_rail281k-mk.sh.txt (deflated 67%)
  adding: tmp/bashrail/rails-jquery-autocomplete/countryoforigin_jq_ac.js (deflated 44%)
  adding: tmp/bashrail/README-history-summary.md (deflated 26%)
  adding: tmp/bashrail/README.md (deflated 47%)
  adding: tmp/bashrail/readme,runone,script,howto.txt (deflated 56%)
  adding: tmp/bashrail/root/ (stored 0%)
  adding: tmp/bashrail/root/.gitattributes (deflated 55%)
  adding: tmp/bashrail/root/.gitignore (deflated 63%)
  adding: tmp/bashrail/seeds1.sh (deflated 69%)
  adding: tmp/bashrail/seeds2.sh (deflated 72%)
  adding: tmp/bashrail/select2.sh (deflated 57%)
  adding: tmp/bashrail/tableprefix1.sh (deflated 45%)
  adding: tmp/bashrail/thor/ (stored 0%)
  adding: tmp/bashrail/thor/thor1.rb (deflated 23%)
  adding: tmp/bashrail/thor/thor2.rb (deflated 47%)
  adding: tmp/bashrail/timezone1.sh (deflated 45%)
  adding: tmp/bashrail/todo.txt (deflated 54%)
  adding: tmp/bashrail/util/ (stored 0%)
  adding: tmp/bashrail/util/hook.sh (deflated 43%)
  adding: tmp/bashrail/util/mtimeh.rb (deflated 36%)
  adding: tmp/bashrail/util/version.sh (deflated 51%)
  adding: tmp/bashrail/util/hooks/ (stored 0%)
  adding: tmp/bashrail/util/hooks/post-checkout (deflated 28%)
  adding: tmp/bashrail/util/hooks/pre-push (deflated 21%)
  adding: tmp/bashrail/util/hooks/pre-commit (deflated 49%)
  adding: tmp/bashrail/utilbr/ (stored 0%)
  adding: tmp/bashrail/utilbr/passw.rb (deflated 43%)
  adding: tmp/bashrail/utilbr/scafrff.sh (deflated 45%)
  adding: tmp/bashrail/utilbr/adduser1.rb (deflated 51%)
  adding: tmp/bashrail/utilbr/scafsf.sh (deflated 45%)
  adding: tmp/bashrail/version-last10.txt (deflated 61%)
  adding: tmp/bashrail/version-log.txt (deflated 88%)
  adding: tmp/bashrail/version.txt (stored 0%)
# cp /tmp/bashrail_copy.zip $pathtarget
cp -av $sfil2/version* $pathtarget
+ cp -av ../bashrail/version-last10.txt ../bashrail/version-log.txt ../bashrail/version.txt docs/generatedby
'../bashrail/version-last10.txt' -> 'docs/generatedby/version-last10.txt'
'../bashrail/version-log.txt' -> 'docs/generatedby/version-log.txt'
'../bashrail/version.txt' -> 'docs/generatedby/version.txt'

cp -av $sfil2/root/.gitignore .
+ cp -av ../bashrail/root/.gitignore .
'../bashrail/root/.gitignore' -> './.gitignore'

cp -av $sfil2/docker .
+ cp -av ../bashrail/docker .
'../bashrail/docker' -> './docker'
'../bashrail/docker/app.Dockerfile' -> './docker/app.Dockerfile'
'../bashrail/docker/nginx.conf' -> './docker/nginx.conf'
cp -av $sfil2/docker-com*.* .
+ cp -av ../bashrail/docker-compose.prod.yml ../bashrail/docker-compose.yml .
'../bashrail/docker-compose.prod.yml' -> './docker-compose.prod.yml'
'../bashrail/docker-compose.yml' -> './docker-compose.yml'
cp -av $sfil2/Makefil* .
+ cp -av ../bashrail/Makefile .
'../bashrail/Makefile' -> './Makefile'

# cleanup
rm -rf $pathtmp
+ rm -rf /tmp/bashrail
rm /tmp/bashrail_copy.zip
+ rm /tmp/bashrail_copy.zip


cat << HEREDOC > README.md

## $appn

This project was generated by bashrail. See the files in docs/generatedby for more info.

Also see https://github.com/dgleba/bashrail/tree/master/docsbr



If you clone this repo, You may need to:  

```
cp  config/database-example.yml    config/database.yml   
cp  config/application-example.yml config/application.yml
cp  config/secrets-example.yml     config/secrets.yml    
```

Check db/../..seeds*.rb for username and password.


HEREDOC
+ cat

cp  config/database-example.yml    config/database.yml   
++ cp config/database-example.yml config/database.yml
cp: cannot stat 'config/database-example.yml': No such file or directory
cp  config/application-example.yml config/application.yml
++ cp config/application-example.yml config/application.yml
cp: cannot stat 'config/application-example.yml': No such file or directory
cp  config/secrets-example.yml     config/secrets.yml    
++ cp config/secrets-example.yml config/secrets.yml
cp: cannot stat 'config/secrets-example.yml': No such file or directory


cp config/database.yml config/database-example.yml
+ cp config/database.yml config/database-example.yml
cp config/application.yml config/application-example.yml
+ cp config/application.yml config/application-example.yml
cp config/secrets.yml config/secrets-example.yml
+ cp config/secrets.yml config/secrets-example.yml


sleep 1
+ sleep 1
git add -A # Add all files and commit them
+ git add -A
  git commit -m "add sqlite db and docs. Bashrail Finished."
+ git commit -m 'add sqlite db and docs. Bashrail Finished.'
[master 4b5be53] add sqlite db and docs. Bashrail Finished.
 16 files changed, 1144 insertions(+), 36 deletions(-)
 mode change 100644 => 100755 .gitignore
 create mode 100644 Makefile
 create mode 100644 config/application-example.yml
 create mode 100644 config/application.yml
 create mode 100644 config/database-example.yml
 create mode 100644 config/master.key
 create mode 100644 config/secrets-example.yml
 create mode 100644 db/development.sqlite3
 create mode 100644 docker-compose.prod.yml
 create mode 100644 docker-compose.yml
 create mode 100644 docker/app.Dockerfile
 create mode 100644 docker/nginx.conf
 create mode 100644 docs/generatedby/version-last10.txt
 create mode 100644 docs/generatedby/version-log.txt
 create mode 100644 docs/generatedby/version.txt


### finish up.. ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

set +vx
+ set +vx
/srv/test/brails-01/brail542c17
run rails s
then visit localhost:3000/
then visit localhost:3000/products
Sun Oct 25 21:48:56 EDT 2020

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!   DONE    !!!**
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

